2025-11-23T14:56:33.973-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 6648 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T14:56:33.989-05:00 DEBUG 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T14:56:33.995-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T14:56:35.913-05:00  INFO 6648 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T14:56:35.931-05:00  INFO 6648 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T14:56:35.931-05:00  INFO 6648 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T14:56:36.029-05:00  INFO 6648 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T14:56:36.029-05:00  INFO 6648 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1955 ms
2025-11-23T14:56:36.205-05:00  INFO 6648 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T14:56:36.721-05:00  INFO 6648 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@47f04e4d
2025-11-23T14:56:36.729-05:00  INFO 6648 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T14:56:36.859-05:00 DEBUG 6648 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T14:56:36.959-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T14:56:37.071-05:00  INFO 6648 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T14:56:37.553-05:00  INFO 6648 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T14:56:37.561-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.345 seconds (process running for 4.801)
2025-11-23T14:56:37.569-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T14:56:37.569-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T14:56:37.582-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T14:56:37.674-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T14:56:38.107-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T14:56:38.107-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T14:56:38.107-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T14:56:38.107-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T14:56:38.110-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T14:56:38.110-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T14:56:38.123-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T14:56:38.123-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T14:56:38.132-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T14:56:57.966-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53635
2025-11-23T14:56:57.974-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53635
2025-11-23T14:57:00.199-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53635
2025-11-23T14:57:00.199-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53635
2025-11-23T14:57:00.199-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53635
2025-11-23T14:57:00.225-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53635 conectado y saludado.
2025-11-23T14:57:00.233-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T14:57:00.241-05:00  WARN 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:53635
2025-11-23T14:57:00.241-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:53635
2025-11-23T14:57:07.731-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T14:57:07.739-05:00  WARN 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:53635
2025-11-23T14:57:07.741-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:53635
2025-11-23T14:57:24.625-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T14:57:24.630-05:00  WARN 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:53635
2025-11-23T14:57:24.630-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:53635
2025-11-23T14:58:35.477-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:52927
2025-11-23T14:58:35.477-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:52927
2025-11-23T14:58:39.623-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:52927
2025-11-23T14:58:39.623-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:52927
2025-11-23T14:58:39.623-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:52927
2025-11-23T14:58:39.628-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:52927 conectado y saludado.
2025-11-23T14:58:39.630-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T14:58:39.633-05:00  WARN 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:52927
2025-11-23T14:58:39.635-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:52927
2025-11-23T14:58:50.092-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T14:58:50.100-05:00  WARN 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='laura' desde /192.168.40.12:52927
2025-11-23T14:58:50.100-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: laura desde /192.168.40.12:52927
2025-11-23T15:06:09.003-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 15960 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:06:09.012-05:00 DEBUG 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:06:09.014-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:06:11.384-05:00  INFO 15960 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:06:11.408-05:00  INFO 15960 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:06:11.408-05:00  INFO 15960 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:06:11.504-05:00  INFO 15960 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:06:11.504-05:00  INFO 15960 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2427 ms
2025-11-23T15:06:11.701-05:00  INFO 15960 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:06:12.381-05:00  INFO 15960 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4d157493
2025-11-23T15:06:12.389-05:00  INFO 15960 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:06:12.567-05:00 DEBUG 15960 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:06:12.656-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:06:12.772-05:00  INFO 15960 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:06:13.346-05:00  INFO 15960 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:06:13.354-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.073 seconds (process running for 5.551)
2025-11-23T15:06:13.354-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:06:13.362-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:06:13.372-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:06:13.468-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:06:13.840-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:06:13.842-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:06:13.844-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:06:13.846-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:06:13.846-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:06:13.854-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:06:13.862-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:06:13.862-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:06:13.868-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:06:20.444-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54344
2025-11-23T15:06:20.457-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54344
2025-11-23T15:06:22.941-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54344
2025-11-23T15:06:22.943-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54344
2025-11-23T15:06:22.943-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54344
2025-11-23T15:06:22.981-05:00  INFO 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54344 conectado y saludado.
2025-11-23T15:06:22.983-05:00  INFO 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:06:23.006-05:00  WARN 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: manuel
2025-11-23T15:06:23.006-05:00  WARN 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:54344
2025-11-23T15:06:23.010-05:00  INFO 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:54344
2025-11-23T15:06:32.782-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63995
2025-11-23T15:06:32.794-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63995
2025-11-23T15:06:34.141-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63995
2025-11-23T15:06:34.141-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63995
2025-11-23T15:06:34.141-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63995
2025-11-23T15:06:34.152-05:00  INFO 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63995 conectado y saludado.
2025-11-23T15:06:34.152-05:00  INFO 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:06:34.165-05:00  WARN 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: laura
2025-11-23T15:06:34.165-05:00  WARN 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='laura' desde /192.168.40.12:63995
2025-11-23T15:06:34.165-05:00  INFO 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: laura desde /192.168.40.12:63995
2025-11-23T15:08:45.758-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 2020 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:08:45.763-05:00 DEBUG 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:08:45.765-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:08:48.157-05:00  INFO 2020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:08:48.187-05:00  INFO 2020 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:08:48.187-05:00  INFO 2020 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:08:48.324-05:00  INFO 2020 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:08:48.324-05:00  INFO 2020 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2476 ms
2025-11-23T15:08:48.562-05:00  INFO 2020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:08:49.099-05:00  INFO 2020 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@37348491
2025-11-23T15:08:49.108-05:00  INFO 2020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:08:49.296-05:00 DEBUG 2020 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:08:49.453-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:08:49.606-05:00  INFO 2020 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:08:50.267-05:00  INFO 2020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:08:50.282-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.269 seconds (process running for 5.795)
2025-11-23T15:08:50.285-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:08:50.285-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:08:50.304-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:08:50.385-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:08:50.693-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:08:50.704-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:08:50.704-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:08:50.713-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:08:54.898-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61636
2025-11-23T15:08:54.906-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61636
2025-11-23T15:08:56.739-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61636
2025-11-23T15:08:56.742-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61636
2025-11-23T15:08:56.742-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61636
2025-11-23T15:08:56.760-05:00  INFO 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61636 conectado y saludado.
2025-11-23T15:08:56.764-05:00  INFO 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:08:56.773-05:00 DEBUG 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel'
2025-11-23T15:08:56.785-05:00  WARN 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='manuel' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:08:56.785-05:00  WARN 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: manuel
2025-11-23T15:08:56.785-05:00  WARN 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:61636
2025-11-23T15:08:56.785-05:00  INFO 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:61636
2025-11-23T15:09:01.735-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61491
2025-11-23T15:09:01.739-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61491
2025-11-23T15:09:03.151-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61491
2025-11-23T15:09:03.151-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61491
2025-11-23T15:09:03.151-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61491
2025-11-23T15:09:03.151-05:00  INFO 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61491 conectado y saludado.
2025-11-23T15:09:03.157-05:00  INFO 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:09:03.159-05:00 DEBUG 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura'
2025-11-23T15:09:03.166-05:00  WARN 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='laura' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:09:03.168-05:00  WARN 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: laura
2025-11-23T15:09:03.168-05:00  WARN 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='laura' desde /192.168.40.12:61491
2025-11-23T15:09:03.169-05:00  INFO 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: laura desde /192.168.40.12:61491
2025-11-23T15:10:27.746-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 24.0.2 with PID 18272 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo)
2025-11-23T15:10:27.750-05:00 DEBUG 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:10:27.751-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:10:29.378-05:00  INFO 18272 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:10:29.409-05:00  INFO 18272 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:10:29.411-05:00  INFO 18272 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:10:29.513-05:00  INFO 18272 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:10:29.514-05:00  INFO 18272 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1693 ms
2025-11-23T15:10:29.707-05:00  INFO 18272 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:10:30.333-05:00  INFO 18272 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@56e9a474
2025-11-23T15:10:30.335-05:00  INFO 18272 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:10:30.424-05:00 DEBUG 18272 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:10:30.499-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:10:30.576-05:00  INFO 18272 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:10:30.923-05:00  INFO 18272 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:10:30.929-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.773 seconds (process running for 4.123)
2025-11-23T15:10:30.933-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:10:30.934-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:10:30.949-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:10:31.063-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:10:31.501-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:10:31.501-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:10:31.501-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:10:31.502-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:10:31.503-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:10:31.503-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:10:31.513-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:10:31.518-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:10:31.521-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:10:41.344-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53111
2025-11-23T15:10:41.356-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53111
2025-11-23T15:10:43.341-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53111
2025-11-23T15:10:43.343-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53111
2025-11-23T15:10:43.345-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53111
2025-11-23T15:10:43.387-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53111 conectado y saludado.
2025-11-23T15:10:43.389-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:10:43.394-05:00 DEBUG 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura'
2025-11-23T15:10:43.408-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='laura' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:10:43.408-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: laura
2025-11-23T15:10:43.409-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='laura' desde /192.168.40.12:53111
2025-11-23T15:10:43.411-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: laura desde /192.168.40.12:53111
2025-11-23T15:10:49.593-05:00 ERROR 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:53111: java.net.SocketException: Connection reset
2025-11-23T15:10:49.593-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53111 desconectado sin autenticarse.
2025-11-23T15:11:25.113-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53434
2025-11-23T15:11:25.119-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53434
2025-11-23T15:11:29.096-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53434
2025-11-23T15:11:29.097-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53434
2025-11-23T15:11:29.098-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53434
2025-11-23T15:11:29.102-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53434 conectado y saludado.
2025-11-23T15:11:29.109-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:11:29.115-05:00 DEBUG 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel'
2025-11-23T15:11:29.123-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='manuel' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:11:29.129-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: manuel
2025-11-23T15:11:29.138-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:53434
2025-11-23T15:11:29.139-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:53434
2025-11-23T15:12:29.509-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 24.0.2 with PID 17004 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo)
2025-11-23T15:12:29.512-05:00 DEBUG 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:12:29.513-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:12:30.865-05:00  INFO 17004 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:12:30.879-05:00  INFO 17004 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:12:30.880-05:00  INFO 17004 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:12:30.935-05:00  INFO 17004 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:12:30.936-05:00  INFO 17004 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1350 ms
2025-11-23T15:12:31.050-05:00  INFO 17004 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:12:31.449-05:00  INFO 17004 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@506aabf6
2025-11-23T15:12:31.452-05:00  INFO 17004 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:12:31.565-05:00 DEBUG 17004 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:12:31.663-05:00  INFO 17004 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:12:31.740-05:00  INFO 17004 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:12:32.034-05:00  INFO 17004 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:12:32.041-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.209 seconds (process running for 3.617)
2025-11-23T15:12:32.044-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:12:32.045-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:12:32.053-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:12:32.108-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:12:32.401-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:12:32.402-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:12:32.403-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:12:32.404-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:12:32.405-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:12:32.406-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:12:32.415-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:12:32.415-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:12:32.419-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:12:57.888-05:00  INFO 17004 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59607
2025-11-23T15:12:57.895-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59607
2025-11-23T15:13:08.120-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59607
2025-11-23T15:13:08.122-05:00  INFO 17004 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59607
2025-11-23T15:13:08.126-05:00  INFO 17004 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59607
2025-11-23T15:13:08.144-05:00  INFO 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59607 conectado y saludado.
2025-11-23T15:13:08.145-05:00  INFO 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:13:08.152-05:00 DEBUG 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel'
2025-11-23T15:13:08.177-05:00  WARN 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='manuel' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:13:08.178-05:00  WARN 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: manuel
2025-11-23T15:13:08.179-05:00  WARN 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:59607
2025-11-23T15:13:08.181-05:00  INFO 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:59607
2025-11-23T15:15:24.462-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 11420 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:15:24.470-05:00 DEBUG 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:15:24.470-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:15:26.273-05:00  INFO 11420 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:15:26.281-05:00  INFO 11420 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:15:26.281-05:00  INFO 11420 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:15:26.371-05:00  INFO 11420 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:15:26.372-05:00  INFO 11420 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1831 ms
2025-11-23T15:15:26.545-05:00  INFO 11420 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:15:26.992-05:00  INFO 11420 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5be052ca
2025-11-23T15:15:27.001-05:00  INFO 11420 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:15:27.141-05:00 DEBUG 11420 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:15:27.221-05:00  INFO 11420 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:15:27.323-05:00  INFO 11420 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:15:27.759-05:00  INFO 11420 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:15:27.767-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.916 seconds (process running for 4.384)
2025-11-23T15:15:27.772-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:15:27.775-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:15:27.783-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:15:27.841-05:00  INFO 11420 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:15:28.112-05:00  INFO 11420 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:15:28.112-05:00  INFO 11420 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:15:28.120-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:15:28.120-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:15:28.120-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:15:28.120-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:15:28.128-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:15:28.128-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:15:28.136-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:15:31.185-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 8020 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:15:31.185-05:00 DEBUG 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:15:31.185-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:15:33.022-05:00  INFO 8020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:15:33.030-05:00  INFO 8020 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:15:33.030-05:00  INFO 8020 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:15:33.104-05:00  INFO 8020 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:15:33.104-05:00  INFO 8020 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1843 ms
2025-11-23T15:15:33.284-05:00  INFO 8020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:15:33.695-05:00  INFO 8020 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1da4b3f9
2025-11-23T15:15:33.701-05:00  INFO 8020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:15:33.837-05:00 DEBUG 8020 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:15:33.908-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:15:34.024-05:00  INFO 8020 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:15:34.524-05:00  INFO 8020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:15:34.550-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.128 seconds (process running for 4.667)
2025-11-23T15:15:34.557-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:15:34.559-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:15:34.587-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:15:34.671-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:15:35.082-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:15:35.086-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:15:35.086-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:15:35.086-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:15:35.089-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:15:35.089-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:15:35.102-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:15:35.102-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:15:35.115-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:15:44.920-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:56651
2025-11-23T15:15:44.924-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:56651
2025-11-23T15:15:47.258-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:56651
2025-11-23T15:15:47.260-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:56651
2025-11-23T15:15:47.260-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:56651
2025-11-23T15:15:47.275-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:56651 conectado y saludado.
2025-11-23T15:15:47.275-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:15:47.302-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:15:47.306-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:15:47.314-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:56651
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:56651
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:15:47.314-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:15:47.324-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:15:47.338-05:00  WARN 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:16:09.264-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:60550
2025-11-23T15:16:09.273-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:60550
2025-11-23T15:16:12.653-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:60550
2025-11-23T15:16:12.655-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:60550
2025-11-23T15:16:12.656-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:60550
2025-11-23T15:16:12.659-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:60550 conectado y saludado.
2025-11-23T15:16:12.662-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:16:12.678-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:16:12.683-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:16:12.685-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:16:12.687-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:16:12.688-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:60550
2025-11-23T15:16:12.689-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:60550
2025-11-23T15:16:12.690-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:16:12.690-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:16:12.692-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:16:12.698-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:16:12.706-05:00  WARN 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:16:24.707-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|manuel, le voy a enviar un archivo'
2025-11-23T15:16:24.709-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 15:16:24] Mensaje enviado por: laura Para manuel Contenido: manuel, le voy a enviar un archivo
2025-11-23T15:16:24.722-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 15:16:24 Mensaje enviado por: laura Para manuel Contenido: manuel, le voy a enviar un archivo (desde /192.168.40.12:60550)
2025-11-23T15:16:24.733-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:16:24.739-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:16:24.740-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:16:24.744-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:16:24.747-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='manuel, le voy a enviar un archivo'
2025-11-23T15:16:24.754-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T15:16:24.766-05:00 ERROR 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Error inserting message into DB (emisorId=2, receptorId=1, sesionId=null)

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:103) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcMessageDao.insertMessage(JdbcMessageDao.java:129) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleMessage(ClientWorker.java:658) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:82) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'tipo' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:121) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1061) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1009) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1320) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:994) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-23T15:16:39.072-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR manuel|1020-1030.txt|2876'
2025-11-23T15:16:39.074-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='manuel' filename='1020-1030.txt' size='2876'
2025-11-23T15:16:39.077-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: 1020-1030.txt size=2876 desde /192.168.40.12:60550
2025-11-23T15:16:39.107-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA manuel|1020-1030.txt|RW1wcmVzYXMgaW50ZWxpZ2VudGVzOiBldm9sdWNpw7NuIHkgY3JlY2ltaWVudG8gZW4gdGllbXBvcyBkZSBsYSBJQQ0KTGFzIGVtcHJlc2FzIG5vIGRlYmVuIHRlbmVybGUgbWllZG8gYSB1c2FyIGxhIGlhLCBkZWJlbiBpbnRlZ3JhcmxhIHJlc3BvbnNhYmxlbWVudGUgYSBzdXMgb3BlcmFjaW9uZXMgeSBjYXBhY2l0YXIgYSBzdXMgZW1wbGVhZG9zIGFjZXJjYSBkZSByaWVzZ29zIHkgYmVuZWZpY2lvcw0KDQpDdWx0dXJhIEFuYWzDrXRpY2E6IMK/Q8OzbW8gbm8gZGVtb2NyYXRpemFyIGVsIHVzbyBkZSBsb3MgZGF0b3MgZW4gb3JnYW5pemFjaW9uZXMgcMO6YmxpY2FzIHkgcHJpdmFkYXM/DQpUZW5lciBjdWlkYWRvIGNvbiBsb3MgZGF0b3Mgc2Vuc2libGVzIHF1ZSB0aWVuZW4gbG9zIGFnZW50ZXMsIGxhcyBlbXByZXNhcyBwdWVkZW4gdGVuZXIgYWdlbnRlcyBjZW50cmFsaXphZG9zIHByaXZhZG9zDQpDSU8gZXMgbMOtZGVyIGRlIGFuYWzDrXRpY2EsIG11Y2hhcyByZXNwb25zYWJpbGlkYWRlcw0KTWVkaWNpw7NuIGRlIGRhdG9zLCBnb2Jlcm5hbnphIGRlIGRhdG9zDQpBbmFsaXRpY2EgZGUgSUEgZW4gb3JncmFuaXphY2lvbmVzDQpTYW50aWFnbyBSZXN0cmVwbyBEaXJlY3RvciBEYXRhIHkgZXN0cmF0ZWdpYSBkZSBwdW50b3MgQ29sb21iaWENCkFuZHJlcyBDYXN0ZWxsYW5vcyBIZWFkIG9mIERhdGEgJiBBcnRpZmljaWFsIEludGVsbGlnZW5jZSBkZSBWbGFtZXJpY2FzIENvcnANCk5vcm1hIEVzcGlub3NhIERpcmVjdG9yIERhdG9zICYgQW5hbGl0aWNhIGRlIEdlbnRlcmENCkFuZHJlcyBCYXJyYW50ZXMgVlAgR2xvYmFsIEFXUyBQcmFjdGljZSBIZWFkIG9mIEJsZW5kDQoNCjExOjMwLTEyOjIwDQpBeXVkYXJzZSBkZSBsYSBJQSBwYXJhIHRlbmVyIHZlbnRhamEgY29tcGV0aXRpdmEsIG5vIGVzIGRlbWFzaWFkbyBjb21wbGVqbyBkZSB1c2FyIHkgcmVudGEgbXVjaG8gYXByZW5lciBhIG1hbmVqYXJsYSBwb3IgbGFzIGdhbmFuY2lhcyBxdWUgcHVlZGUgYnJpbmRhcg0KQmFzZXMgZGUgZGF0b3Mgb2x0cCBNaWNyb3NvZnQgeSBhenVyZSBvZnJlY2VuIGNhZGEgdW5vIHVuIG1vdG9yIGRiIGNvbiB0b2RvIHVuIHByb2R1Y3RvIGRlICwgQ29zbW9zIG9mcmVjZSB1bm8gTm8gT3NxbCwgbm90IG9ubHkNClNlIHF1aWVyZSB2ZXIgaW5mbyBlbiB0aWVtcG8gcmVhbCwgbm8gZXNwZXJhciBhIGxhIEVUTA0KT3BlcmFjaW9uZXMgdHJhbnNhY2Npb25hbGVzIHkgYW5hbGl0aWNhcyBlbiB1bmEgc29sYSBwZXRpY2lvbg0KDQpSdXRhIHBhcmEgZGVzYXJyb2xsbyBkZSBhcHAgZGUgaWEgYWxpbWVudGFkYSBjb24gZGF0YSBkZSBsYSBlbXByZXNhDQoxLiBlc3RhYmxlY2VyIHJlcG9zaXRvcmlvIGNlbnRyYXINCjIuIHByZXBhcmFyIGRhdGEgcGFyYSBpbm5vdmFjaW9uIGRlIGlhDQozLiBDcmVhciBwbGF0YWZvcm1hIHVuaWZpY2FkYSBkZSBpYQ0KNC4gY29uc3RydWlyIGV4cGVyaWVuY2lhcyBkZSBpYSBjb24gbGEgcHJvcGlhIGRhdGEgZGUgbGEgZW1wcmVzYQ0KDQpMYSBhY3R1YWxpZGFkIHNvbiBsb3MgYWdlbnRlcywgZWwgZnV0dXJvIGFnZW50ZXMgcXVlIGNvbnN1bHRhbiBhIGFnZW50ZXMgY29tbyBvcnF1ZXN0YSBtdXNpY2FsLiBTZSBkZWJlIHRlbmVyIGVuIGN1ZW50YSBjdWFuZG8geSBjb21vIHVuIGFnZW50ZSBlcyBtZWpvciBxdWUgb3RybywgcGFyYSBwb2RlciBlbGVnaXIgYmllbi4gTWljcm9zb2Z0IHBlcm1pdGUgdW5hIGdyYW4gdmFyaWVkYWQgZGUgb3BjaW9uZXMgcGFyYSB0ZW5lciBlbCBtZWpvciBkZXNlbXBlw7FvDQpNaWNyb3NvZnQgZmFicmljIHkgQXp1cmUgQUkgRm91bmRyeSBwZXJtaXRlbiBjcmVhciBhZ2VudGVzDQpFc3RvcyBhZ2VudGVzIHNlIHB1ZWRlbiBjb25zdW1pciBwb3Igb3Ryb3MgdXN1YXJpb3MsIGludGVybm9zIG8gZXh0ZXJub3MgYSBsYSBlbXByZXNhDQoNCg0KQ29uc3RydXllbmRvIEVxdWlwb3MgZGUgRGF0b3MgZW4gTEFUQU06IEF0cmFjY2nDs24sIFJldGVuY2nDs24geSBVcHNraWxsaW5nIHluIElBDQoNCkVtcHJlc2FzIG9mcmVjZW4gZmxleGliaWxpYWRlcyBsYWJvcmFsZXMgZW4gZXN0b3MgY2FtcG9zLCBsYXMgcGVyc29uYXMgc2UgdmFuIHBvciBjcmVjaW1pZW50byBwZXJzb25hbCB5IG1lam9yZXMgb2ZlcnRhcywgaGF5IHF1ZSBoYWNlciBjcmVjZXIgYSBsYXMgcGVyc29uYXMgZGVzZGUgbGFzIGVtcHJlc2FzDQpsYXMgcGVyc29uYXMgZGViZW4gc2VudGlyc2UgcGFydGUgZGUgbG9zIHByb3llY3RvcyBwYXJhIGV2aXRhciByb3RhY2lvbiBkZSBwZXJzb25hbCwgbGEgYWRhcHRhY2lvbiBhbnRlIGxvcyBjYW1iaW9zIGVzIGRpZmljaWwNCg0KU2UgbmVjZXNpdGFuIHByb2Zlc2lvbmFsZXMgZGUgZGF0b3MgZGFkbyBlbCBjcmVjaW1pZW50byBkZWwgbWVyY2FkbywgaGF5IG11Y2hvcyBlY29ub21pc3RhcywgZXN0YWRpc3RpY29zIG8gaW5nIGRlIHNpc3RlbWFzLCBwZXJvIG5vIHByb2Zlc2lvbmFsZXMgZGUgZGF0b3MNCg0KU2UgbWlkZSBtdWNobyBsYSBwcm9kdWN0aXZpZGFkIGRlIGxvcyByZXN1bHRhZG9zLCBwb2NvIGVsIGNyZWNpbWllbnRvIGRlIHBlcnNvbmFzDQpTZSBkZWJlIGNvbnN0cnVpciBlbCB0YWxlbnRvIGRlc2RlIG9yZ2FuaXphY2lvbmVzLCBsYSBpYSBwdWVkZSBzZXIgaGVycmFtaWVudGEgcGVybyBubyByZWVtcGxhem8sIGVsIHRhbGVudG8gaHVtYW5vIGRlYmUgc2VndWlyIHNpZW5kbyBsYSBhcHVlc3RhIGRlIGxhcyBlbXByZXNhcywgZGUgbGEgbWFubyBjb24gaWENCk5vIHRvZGFzIGxhcyBwbGF0YWZvcm1hcyBkZWJlbiBzZXIgdGFuIGdyYW5kZXMgbyBwZXF1ZcOxYXMgY29tbyBsYXMgbWFzIGZhbW9zYXMsIHNlIGRlYmUgYnVzY2FyIGZ1bmNpb25hbGlkYWQgbm8gaW1hZ2VuIGRlIHBvZGVyDQo='
2025-11-23T15:16:39.123-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: laura -> manuel : 1020-1030.txt (2876 bytes)
2025-11-23T15:16:39.165-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763928999157_laura_1020-1030.txt
2025-11-23T15:16:39.167-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:16:39.173-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:16:39.201-05:00 ERROR 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo persistir archivo/mensaje en BD

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:103) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcArchivoDao.insertArchivo(JdbcArchivoDao.java:42) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleFileData(ClientWorker.java:433) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:97) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'nombre' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:121) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1061) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1009) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1320) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:994) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-23T15:17:39.380-05:00 ERROR 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:56651: java.net.SocketException: Connection reset
2025-11-23T15:17:39.380-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T15:17:39.380-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:17:39.380-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T15:17:55.434-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:57973
2025-11-23T15:17:55.440-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:57973
2025-11-23T15:17:58.175-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:57973
2025-11-23T15:17:58.175-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:57973
2025-11-23T15:17:58.184-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:57973
2025-11-23T15:17:58.218-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:57973 conectado y saludado.
2025-11-23T15:17:58.219-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:17:58.227-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:17:58.245-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:17:58.249-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:17:58.253-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:17:58.255-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:57973
2025-11-23T15:17:58.257-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:57973
2025-11-23T15:17:58.263-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:17:58.271-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:17:58.281-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:17:58.285-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:17:58.299-05:00  WARN 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:25:27.484-05:00 ERROR 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:60550: java.net.SocketException: Connection reset
2025-11-23T15:25:27.485-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T15:25:27.486-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:25:27.486-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:25:32.456-05:00 ERROR 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:57973: java.net.SocketException: Connection reset
2025-11-23T15:25:32.456-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T15:25:32.457-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:25:32.458-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T15:25:47.986-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:65519
2025-11-23T15:25:47.994-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:65519
2025-11-23T15:25:50.434-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:65519
2025-11-23T15:25:50.434-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:65519
2025-11-23T15:25:50.444-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:65519
2025-11-23T15:25:50.458-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:65519 conectado y saludado.
2025-11-23T15:25:50.505-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:25:50.507-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:25:50.512-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:25:50.517-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:25:50.519-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:25:50.521-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:65519
2025-11-23T15:25:50.521-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:65519
2025-11-23T15:25:50.555-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:25:50.562-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:25:50.577-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:25:50.584-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:25:50.590-05:00  WARN 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:25:59.038-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:60290
2025-11-23T15:25:59.045-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:60290
2025-11-23T15:26:01.784-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:60290
2025-11-23T15:26:01.788-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:60290
2025-11-23T15:26:01.838-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:60290
2025-11-23T15:26:01.842-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:60290 conectado y saludado.
2025-11-23T15:26:01.844-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:26:01.846-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:26:01.853-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:26:01.859-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:26:01.863-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:26:01.865-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:60290
2025-11-23T15:26:01.867-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:60290
2025-11-23T15:26:01.869-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:26:01.869-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:26:01.869-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:26:01.889-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:26:01.906-05:00  WARN 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:38:28.545-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 1084 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:38:28.548-05:00 DEBUG 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:38:28.550-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:38:30.577-05:00  INFO 1084 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:38:30.599-05:00  INFO 1084 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:38:30.599-05:00  INFO 1084 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:38:30.707-05:00  INFO 1084 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:38:30.707-05:00  INFO 1084 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2073 ms
2025-11-23T15:38:30.929-05:00  INFO 1084 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:38:31.572-05:00  INFO 1084 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@46e190ed
2025-11-23T15:38:31.572-05:00  INFO 1084 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:38:31.737-05:00 DEBUG 1084 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:38:31.852-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:38:31.993-05:00  INFO 1084 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:38:32.606-05:00  INFO 1084 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:38:32.606-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.11 seconds (process running for 5.777)
2025-11-23T15:38:32.625-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:38:32.626-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:38:32.650-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:38:32.729-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:38:33.422-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:38:33.422-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:38:33.424-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:38:33.426-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:38:33.426-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:38:33.428-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:38:33.444-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:38:33.446-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:38:33.450-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:38:47.174-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53847
2025-11-23T15:38:47.181-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53847
2025-11-23T15:38:49.138-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53847
2025-11-23T15:38:49.138-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53847
2025-11-23T15:38:49.138-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53847
2025-11-23T15:38:49.164-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53847 conectado y saludado.
2025-11-23T15:38:49.166-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:38:49.178-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:38:49.190-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:38:49.196-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:53847
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:53847
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:38:49.196-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:38:49.205-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:38:49.214-05:00  WARN 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:38:55.358-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:51356
2025-11-23T15:38:55.368-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:51356
2025-11-23T15:38:59.672-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:51356
2025-11-23T15:38:59.672-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:51356
2025-11-23T15:38:59.674-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:51356
2025-11-23T15:38:59.685-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:51356 conectado y saludado.
2025-11-23T15:38:59.711-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:38:59.713-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:38:59.720-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:38:59.721-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:38:59.724-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:38:59.726-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:51356
2025-11-23T15:38:59.728-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:51356
2025-11-23T15:38:59.732-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:38:59.734-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:38:59.736-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:38:59.748-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:38:59.754-05:00  WARN 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:39:48.450-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T15:39:48.452-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:39:48.454-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:39:50.148-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64263
2025-11-23T15:39:50.172-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64263
2025-11-23T15:39:53.499-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64263
2025-11-23T15:39:53.504-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64263
2025-11-23T15:39:53.506-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64263
2025-11-23T15:39:53.508-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64263 conectado y saludado.
2025-11-23T15:39:53.523-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:39:53.523-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:39:53.535-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:39:53.537-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:39:53.541-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:39:53.545-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:64263
2025-11-23T15:39:53.546-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:64263
2025-11-23T15:39:53.549-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:39:53.555-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:39:53.562-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:39:53.568-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:39:53.585-05:00  WARN 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:51:53.217-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 8248 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:51:53.220-05:00 DEBUG 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:51:53.221-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:51:55.037-05:00  INFO 8248 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:51:55.051-05:00  INFO 8248 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:51:55.052-05:00  INFO 8248 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:51:55.126-05:00  INFO 8248 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:51:55.127-05:00  INFO 8248 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1833 ms
2025-11-23T15:51:55.308-05:00  INFO 8248 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:51:55.864-05:00  INFO 8248 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@dab1f89
2025-11-23T15:51:55.868-05:00  INFO 8248 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:51:56.032-05:00 DEBUG 8248 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:51:56.149-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:51:56.269-05:00  INFO 8248 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:51:56.922-05:00  INFO 8248 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:51:56.933-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.426 seconds (process running for 4.864)
2025-11-23T15:51:56.937-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:51:56.938-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:51:56.953-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:51:57.085-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:51:57.432-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:51:57.434-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:51:57.436-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:51:57.436-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:51:57.437-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:51:57.438-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:51:57.452-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:51:57.453-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:51:57.455-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:52:20.292-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49288
2025-11-23T15:52:20.322-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49288
2025-11-23T15:52:22.140-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49288
2025-11-23T15:52:22.146-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49288
2025-11-23T15:52:22.149-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49288
2025-11-23T15:52:22.184-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49288 conectado y saludado.
2025-11-23T15:52:22.187-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:52:22.196-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:52:22.209-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:52:22.213-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:52:22.217-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:52:22.217-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:49288
2025-11-23T15:52:22.221-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:49288
2025-11-23T15:52:22.221-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:52:22.223-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:52:22.225-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:52:22.229-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:52:22.241-05:00  WARN 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:52:22.245-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:52:22.254-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:52:22.270-05:00  WARN 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo enviar historial de mensajes desde BD tras login para user manuel: PreparedStatementCallback; uncategorized SQLException for SQL [SELECT m.* FROM mensajes m WHERE m.emisor_id = ? OR m.receptor_id = ? ORDER BY m.creado_en ASC LIMIT ?]; SQL state [S0022]; error code [0]; Column 'tipo' not found.
2025-11-23T15:52:31.532-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:65337
2025-11-23T15:52:31.545-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:65337
2025-11-23T15:52:33.909-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:65337
2025-11-23T15:52:33.909-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:65337
2025-11-23T15:52:33.909-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:65337
2025-11-23T15:52:33.918-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:65337 conectado y saludado.
2025-11-23T15:52:33.918-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:52:33.918-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:52:33.926-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:52:33.928-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:52:33.928-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:52:33.928-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:65337
2025-11-23T15:52:33.931-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:65337
2025-11-23T15:52:33.934-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:52:33.936-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:52:33.936-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:52:33.941-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:52:33.947-05:00  WARN 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:52:33.947-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:52:33.954-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:52:33.958-05:00  WARN 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo enviar historial de mensajes desde BD tras login para user laura: PreparedStatementCallback; uncategorized SQLException for SQL [SELECT m.* FROM mensajes m WHERE m.emisor_id = ? OR m.receptor_id = ? ORDER BY m.creado_en ASC LIMIT ?]; SQL state [S0022]; error code [0]; Column 'tipo' not found.
2025-11-23T15:56:28.779-05:00 ERROR 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:49288: java.net.SocketException: Connection reset
2025-11-23T15:56:28.779-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T15:56:28.784-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:56:28.784-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T15:56:33.310-05:00 ERROR 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:65337: java.net.SocketException: Connection reset
2025-11-23T15:56:33.310-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T15:56:33.310-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:56:33.310-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T15:56:39.078-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 15872 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:56:39.082-05:00 DEBUG 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:56:39.082-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:56:41.178-05:00  INFO 15872 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:56:41.202-05:00  INFO 15872 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:56:41.213-05:00  INFO 15872 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:56:41.295-05:00  INFO 15872 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:56:41.295-05:00  INFO 15872 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2135 ms
2025-11-23T15:56:41.509-05:00  INFO 15872 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:56:41.995-05:00  INFO 15872 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1727e03a
2025-11-23T15:56:42.005-05:00  INFO 15872 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:56:42.154-05:00 DEBUG 15872 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:56:42.268-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:56:42.380-05:00  INFO 15872 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:56:42.845-05:00  INFO 15872 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:56:42.848-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.545 seconds (process running for 4.998)
2025-11-23T15:56:42.860-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:56:42.860-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:56:42.876-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:56:42.945-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:56:43.248-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:56:43.253-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:56:43.256-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:56:47.348-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59402
2025-11-23T15:56:47.354-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59402
2025-11-23T15:56:49.906-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59402
2025-11-23T15:56:49.906-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59402
2025-11-23T15:56:49.908-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59402
2025-11-23T15:56:49.917-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59402 conectado y saludado.
2025-11-23T15:56:49.917-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:56:49.939-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:56:49.944-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:56:49.948-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:56:49.948-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:56:49.948-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:59402
2025-11-23T15:56:49.952-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:59402
2025-11-23T15:56:49.952-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:56:49.952-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:56:49.953-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:56:49.956-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:56:49.963-05:00  WARN 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:56:49.968-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:56:49.974-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:56:49.980-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 3 mensajes históricos desde BD a manuel
2025-11-23T15:57:00.258-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54686
2025-11-23T15:57:00.275-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54686
2025-11-23T15:57:02.785-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54686
2025-11-23T15:57:02.785-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54686
2025-11-23T15:57:02.785-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54686
2025-11-23T15:57:02.790-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54686 conectado y saludado.
2025-11-23T15:57:02.792-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:57:02.793-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:02.807-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:02.809-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:57:02.809-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:57:02.809-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:54686
2025-11-23T15:57:02.812-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:54686
2025-11-23T15:57:02.812-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:57:02.812-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:57:02.814-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:02.817-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:02.826-05:00  WARN 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:57:02.832-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:02.838-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:02.840-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 3 mensajes históricos desde BD a laura
2025-11-23T15:57:13.294-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola manuel'
2025-11-23T15:57:13.302-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 15:57:13] Mensaje enviado por: laura Para manuel Contenido: hola manuel
2025-11-23T15:57:13.310-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 15:57:13 Mensaje enviado por: laura Para manuel Contenido: hola manuel (desde /192.168.40.12:54686)
2025-11-23T15:57:13.316-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:13.322-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:13.322-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:57:13.326-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:57:13.331-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='hola manuel'
2025-11-23T15:57:13.336-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T15:57:28.262-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|hola laura'
2025-11-23T15:57:28.262-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 15:57:28] Mensaje enviado por: manuel Para laura Contenido: hola laura
2025-11-23T15:57:28.275-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 15:57:28 Mensaje enviado por: manuel Para laura Contenido: hola laura (desde /192.168.40.12:59402)
2025-11-23T15:57:28.288-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:57:28.294-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:57:28.301-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:28.304-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:28.304-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=null contenido='hola laura'
2025-11-23T15:57:28.304-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=null
2025-11-23T15:58:05.874-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T15:58:05.874-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:58:05.875-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T15:58:07.547-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54126
2025-11-23T15:58:07.554-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54126
2025-11-23T15:58:12.452-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54126
2025-11-23T15:58:12.457-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54126
2025-11-23T15:58:12.459-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54126
2025-11-23T15:58:12.459-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54126 conectado y saludado.
2025-11-23T15:58:12.459-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:58:12.464-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:58:12.486-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:58:12.497-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:58:12.498-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:58:12.502-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:54126
2025-11-23T15:58:12.507-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:54126
2025-11-23T15:58:12.509-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:58:12.509-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:58:12.511-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:58:12.519-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:58:12.528-05:00  WARN 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:58:12.540-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:58:12.544-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:58:12.551-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T16:01:37.543-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 15820 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:01:37.549-05:00 DEBUG 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:01:37.549-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:01:39.583-05:00  INFO 15820 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:01:39.611-05:00  INFO 15820 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:01:39.613-05:00  INFO 15820 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:01:39.710-05:00  INFO 15820 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:01:39.710-05:00  INFO 15820 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2091 ms
2025-11-23T16:01:39.903-05:00  INFO 15820 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:01:40.427-05:00  INFO 15820 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5792c08c
2025-11-23T16:01:40.427-05:00  INFO 15820 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:01:40.627-05:00 DEBUG 15820 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:01:40.766-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:01:40.900-05:00  INFO 15820 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:01:41.447-05:00  INFO 15820 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:01:41.461-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.596 seconds (process running for 4.987)
2025-11-23T16:01:41.470-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:01:41.472-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:01:41.488-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:01:41.544-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:01:41.918-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:01:41.920-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:01:41.922-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:01:41.922-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:01:41.924-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:01:41.930-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:01:41.958-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:01:41.966-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:01:41.977-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:01:53.906-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:50811
2025-11-23T16:01:53.913-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:50811
2025-11-23T16:01:57.300-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:50811
2025-11-23T16:01:57.305-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:50811
2025-11-23T16:01:57.309-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:50811
2025-11-23T16:01:57.361-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:50811 conectado y saludado.
2025-11-23T16:01:57.365-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:01:57.381-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:01:57.393-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:01:57.401-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:01:57.403-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:01:57.405-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:50811
2025-11-23T16:01:57.405-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:50811
2025-11-23T16:01:57.409-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:01:57.420-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:01:57.422-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:01:57.426-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:01:57.444-05:00  WARN 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:01:57.448-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:01:57.452-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:01:57.461-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T16:02:06.687-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63540
2025-11-23T16:02:06.692-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63540
2025-11-23T16:02:11.863-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63540
2025-11-23T16:02:11.863-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63540
2025-11-23T16:02:11.865-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63540
2025-11-23T16:02:11.868-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63540 conectado y saludado.
2025-11-23T16:02:11.870-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:02:11.888-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:02:11.896-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:02:11.898-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:02:11.900-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:02:11.902-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:63540
2025-11-23T16:02:11.902-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:63540
2025-11-23T16:02:11.910-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:02:11.919-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:02:11.924-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:02:11.928-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:02:11.933-05:00  WARN 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:02:11.935-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:02:11.942-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:02:11.947-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a laura
2025-11-23T16:09:11.145-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 16456 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:09:11.145-05:00 DEBUG 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:09:11.151-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:09:12.782-05:00  INFO 16456 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:09:12.801-05:00  INFO 16456 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:09:12.803-05:00  INFO 16456 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:09:12.855-05:00  INFO 16456 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:09:12.871-05:00  INFO 16456 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1654 ms
2025-11-23T16:09:13.044-05:00  INFO 16456 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:09:13.621-05:00  INFO 16456 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2007435e
2025-11-23T16:09:13.628-05:00  INFO 16456 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:09:13.829-05:00 DEBUG 16456 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:09:14.077-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:09:14.219-05:00  INFO 16456 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:09:14.788-05:00  INFO 16456 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:09:14.788-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.346 seconds (process running for 4.818)
2025-11-23T16:09:14.806-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:09:14.806-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:09:14.820-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:09:14.877-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:09:15.304-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:09:15.306-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:09:15.308-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:09:15.308-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:09:15.308-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:09:15.308-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:09:15.329-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:09:15.329-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:09:15.337-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:09:26.027-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:52845
2025-11-23T16:09:26.040-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:52845
2025-11-23T16:09:27.714-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:52845
2025-11-23T16:09:27.716-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:52845
2025-11-23T16:09:27.716-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:52845
2025-11-23T16:09:27.726-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:52845 conectado y saludado.
2025-11-23T16:09:27.726-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:09:27.737-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:09:27.745-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:09:27.754-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:52845
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:52845
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:09:27.754-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:09:27.762-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:09:27.771-05:00  WARN 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:09:27.771-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:09:27.776-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:09:27.780-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T16:09:37.187-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:58619
2025-11-23T16:09:37.195-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:58619
2025-11-23T16:09:38.703-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:58619
2025-11-23T16:09:38.706-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:58619
2025-11-23T16:09:38.706-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:58619
2025-11-23T16:09:38.714-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:58619 conectado y saludado.
2025-11-23T16:09:38.719-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:09:38.727-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:09:38.733-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:09:38.743-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:09:38.743-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:09:38.743-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:58619
2025-11-23T16:09:38.745-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:58619
2025-11-23T16:09:38.747-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:09:38.751-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:09:38.755-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:09:38.761-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:09:38.765-05:00  WARN 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:09:38.767-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:09:38.779-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:09:38.787-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a laura
2025-11-23T16:15:42.921-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 12756 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:15:42.932-05:00 DEBUG 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:15:42.932-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:15:44.923-05:00  INFO 12756 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:15:44.945-05:00  INFO 12756 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:15:44.945-05:00  INFO 12756 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:15:45.023-05:00  INFO 12756 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:15:45.023-05:00  INFO 12756 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2028 ms
2025-11-23T16:15:45.223-05:00  INFO 12756 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:15:45.828-05:00  INFO 12756 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@54c622a7
2025-11-23T16:15:45.836-05:00  INFO 12756 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:15:46.014-05:00 DEBUG 12756 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:15:46.141-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:15:46.275-05:00  INFO 12756 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:15:46.983-05:00  INFO 12756 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:15:46.995-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.756 seconds (process running for 5.137)
2025-11-23T16:15:47.001-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:15:47.003-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:15:47.027-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:15:47.134-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:15:47.617-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:15:47.617-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:15:47.617-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:15:47.617-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:15:47.620-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:15:47.620-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:15:47.628-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:15:47.628-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:15:47.634-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:15:59.426-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61125
2025-11-23T16:15:59.440-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61125
2025-11-23T16:16:01.293-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61125
2025-11-23T16:16:01.295-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61125
2025-11-23T16:16:01.299-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61125
2025-11-23T16:16:01.320-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61125 conectado y saludado.
2025-11-23T16:16:01.322-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:16:01.339-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:16:01.345-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:16:01.351-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:16:01.354-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:16:01.356-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:61125
2025-11-23T16:16:01.358-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:61125
2025-11-23T16:16:01.358-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:16:01.361-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:16:01.363-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:16:01.367-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:16:01.377-05:00  WARN 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:16:01.379-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:16:01.382-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:16:01.388-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T16:16:11.041-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64691
2025-11-23T16:16:11.051-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64691
2025-11-23T16:16:12.524-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64691
2025-11-23T16:16:12.524-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64691
2025-11-23T16:16:12.532-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64691
2025-11-23T16:16:12.535-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64691 conectado y saludado.
2025-11-23T16:16:12.537-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:16:12.537-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:16:12.546-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:16:12.550-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:16:12.552-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:16:12.554-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:64691
2025-11-23T16:16:12.557-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:64691
2025-11-23T16:16:12.557-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:16:12.557-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:16:12.560-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:16:12.565-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:16:12.571-05:00  WARN 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:16:12.574-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:16:12.581-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:16:12.581-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a laura
2025-11-23T16:16:23.494-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola manuel'
2025-11-23T16:16:23.500-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:16:23] Mensaje enviado por: laura Para manuel Contenido: hola manuel
2025-11-23T16:16:23.509-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:16:23 Mensaje enviado por: laura Para manuel Contenido: hola manuel (desde /192.168.40.12:64691)
2025-11-23T16:16:23.512-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:16:23.516-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:16:23.523-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:16:23.528-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:16:23.530-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='hola manuel'
2025-11-23T16:16:23.532-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:21:29.924-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 12584 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:21:29.927-05:00 DEBUG 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:21:29.927-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:21:31.692-05:00  INFO 12584 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:21:31.708-05:00  INFO 12584 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:21:31.717-05:00  INFO 12584 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:21:31.776-05:00  INFO 12584 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:21:31.776-05:00  INFO 12584 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1781 ms
2025-11-23T16:21:31.942-05:00  INFO 12584 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:21:32.519-05:00  INFO 12584 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@485caa8f
2025-11-23T16:21:32.527-05:00  INFO 12584 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:21:32.683-05:00 DEBUG 12584 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:21:32.836-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:21:32.991-05:00  INFO 12584 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:21:33.470-05:00  INFO 12584 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:21:33.484-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.256 seconds (process running for 4.63)
2025-11-23T16:21:33.487-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:21:33.487-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:21:33.504-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:21:33.563-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:21:33.892-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:21:33.923-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:21:33.927-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:21:33.935-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:21:50.608-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:56577
2025-11-23T16:21:50.619-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:56577
2025-11-23T16:21:52.290-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:56577
2025-11-23T16:21:52.293-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:56577
2025-11-23T16:21:52.296-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:56577
2025-11-23T16:21:52.316-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:56577 conectado y saludado.
2025-11-23T16:21:52.322-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:21:52.339-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:21:52.350-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:21:52.355-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:21:52.355-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:21:52.355-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:56577
2025-11-23T16:21:52.355-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:56577
2025-11-23T16:21:52.355-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:21:52.359-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:21:52.359-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:21:52.363-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:21:52.374-05:00  WARN 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:21:52.375-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:21:52.380-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:21:52.389-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a manuel
2025-11-23T16:22:02.355-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:50556
2025-11-23T16:22:02.361-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:50556
2025-11-23T16:22:04.284-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:50556
2025-11-23T16:22:04.284-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:50556
2025-11-23T16:22:04.286-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:50556
2025-11-23T16:22:04.288-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:50556 conectado y saludado.
2025-11-23T16:22:04.294-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:22:04.316-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:22:04.327-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:22:04.342-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:22:04.343-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:22:04.344-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:50556
2025-11-23T16:22:04.345-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:50556
2025-11-23T16:22:04.345-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:22:04.347-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:22:04.350-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:22:04.354-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:22:04.358-05:00  WARN 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:22:04.362-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:22:04.367-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:22:04.374-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a laura
2025-11-23T16:22:44.181-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T16:22:44.186-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:22:44.188-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T16:22:45.658-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54759
2025-11-23T16:22:45.664-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54759
2025-11-23T16:22:47.843-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54759
2025-11-23T16:22:47.852-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54759
2025-11-23T16:22:47.856-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54759
2025-11-23T16:22:47.859-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54759 conectado y saludado.
2025-11-23T16:22:47.861-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:22:47.871-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:22:47.884-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:22:47.884-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:22:47.884-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:22:47.886-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:54759
2025-11-23T16:22:47.886-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:54759
2025-11-23T16:22:47.889-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:22:47.889-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:22:47.893-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:22:47.899-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:22:47.907-05:00  WARN 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:22:47.909-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:22:47.916-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:22:47.924-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a manuel
2025-11-23T16:27:00.878-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 19284 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:27:00.878-05:00 DEBUG 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:27:00.878-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:27:03.160-05:00  INFO 19284 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:27:03.177-05:00  INFO 19284 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:27:03.177-05:00  INFO 19284 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:27:03.283-05:00  INFO 19284 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:27:03.283-05:00  INFO 19284 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2315 ms
2025-11-23T16:27:03.507-05:00  INFO 19284 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:27:04.027-05:00  INFO 19284 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@383c3eb3
2025-11-23T16:27:04.036-05:00  INFO 19284 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:27:04.215-05:00 DEBUG 19284 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:27:04.370-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:27:04.504-05:00  INFO 19284 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:27:05.108-05:00  INFO 19284 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:27:05.289-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.04 seconds (process running for 5.434)
2025-11-23T16:27:05.295-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:27:05.296-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:27:05.310-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:27:05.370-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:27:05.707-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:27:05.707-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:27:05.717-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:27:37.183-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:50290
2025-11-23T16:27:37.194-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:50290
2025-11-23T16:27:40.306-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:50290
2025-11-23T16:27:40.320-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:50290
2025-11-23T16:27:40.348-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:50290
2025-11-23T16:27:40.365-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:50290 conectado y saludado.
2025-11-23T16:27:40.367-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:27:40.383-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:27:40.398-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:27:40.402-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:50290
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:50290
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:27:40.402-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:27:40.413-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:27:40.423-05:00  WARN 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:27:40.424-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:27:40.429-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:27:40.438-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a manuel
2025-11-23T16:27:48.769-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61548
2025-11-23T16:27:48.781-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61548
2025-11-23T16:27:50.528-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61548
2025-11-23T16:27:50.528-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61548
2025-11-23T16:27:50.530-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61548
2025-11-23T16:27:50.532-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61548 conectado y saludado.
2025-11-23T16:27:50.535-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:27:50.542-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:27:50.553-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:27:50.555-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:27:50.557-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:27:50.559-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:61548
2025-11-23T16:27:50.562-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:61548
2025-11-23T16:27:50.564-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:27:50.565-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:27:50.567-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:27:50.571-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:27:50.573-05:00  WARN 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:27:50.577-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:27:50.587-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:27:50.592-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a laura
2025-11-23T16:28:19.139-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR manuel|Tipos de mensaje avanzadas.txt|2038'
2025-11-23T16:28:19.143-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='manuel' filename='Tipos de mensaje avanzadas.txt' size='2038'
2025-11-23T16:28:19.147-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: Tipos de mensaje avanzadas.txt size=2038 desde /192.168.40.12:61548
2025-11-23T16:28:19.184-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA manuel|Tipos de mensaje avanzadas.txt|Ly8vLy8vLy8NCkFwbGljYWNpw7NuIGNsaWVudGUgc2Vydmlkb3IgcGFyYSBlbCBpbnRlcmNhbWJpbyBkZSBpbmZvcm1hY2nDs24gZW50cmUgdXN1YXJpb3MuIHB1ZWRlbiBpbnRlcmNhbWJpYXIgaW5mb3JtYWNpw7NuIGJhc2FkYSBlbiBtZW5zYWplcyBkZSB0ZXh0byB5IGFyY2hpdm9zICggdGV4dG8gbyBiaW5hcmlvICkNCkVsIHNlcnZpZG9yIHBvZHLDoSByZWNpYmlyIHZhcmlhcyBjb25leGlvbmVzIHNpbXVsdGFuZWFzIHBhcmEgZWwgcHJvY2VzYW1pZW50byBkZSBtZW5zYWplcywgZGViZXLDoW4gYXBsaWNhciBlbCBjb25jZXB0byBkZSBwcm9ncmFtYWNpw7NuIGNvbmN1cnJlbnRlIGNvbiBoaWxvcyBwYXJhIGdlc3Rpb25hciBsYXMgY29uZXhpb25lcw0KVG9kYSBsYSBpbmZvcm1hY2nDs24gZGVsIHNlcnZpZG9yIGRlYmUgc2VyIGFsbWFjZW5hZGEgZW4gbGEgYmFzZSBkZSBkYXRvcyByZWxhY2lvbmFsOyBlajogc3FsLCBPcmFjbGUNCkxvcyB1c3VhcmlvcyBzZSBkZWJlbiBjcmVhciBkZXNkZSBsYSBhcHAgZGUgY2xpZW50ZSwgcGVybyBzZSBhY2VwdGFuIGRlc2RlIGVsIHNlcnZpZG9yLCBzb2xvIHB1ZWRlbiBjb25lY3RhcnNlIGx1ZWdvIGRlIHNlciBhY2VwdGFkb3MNClVuIHVzdWFyaW8gcHVlZGUgdGVuZXIgbWFzIGRlIDEgY29uZXhpw7NuIGRlc2RlIG1hcyBkZSAxIGRpc3Bvc2l0aXZvDQpFbCBzZXJ2aWRvciBkZWJlIG1vc3RyYXIgcG9yIGNvbnNvbGEgdG9kYXMgbGFzIGFjY2lvbmVzIHF1ZSBzZSBlc3TDoW4gZWplY3V0YW5kbw0KRWwgc2Vydmlkb3IgbGltaXRhIGxhIGNhbnRpZGFkIGRlIGNvbmV4aW9uZXMgcG9yIHVzdWFyaW8NCkxhIGNvbmV4acOzbiBlbnRyZSBzZXJ2aWRvciBjbGllbnRlcyBzZSBoYWNlIGEgdHJhdsOpcyBkZSBwcm90b2NvbG8gdGNwIGlwDQpMb3MgdXN1YXJpb3MgcHVlZGVuIGRlc2NhcmdhciBsb3MgYXJjaGl2b3MgZW52aWFkb3MNCkxhIGFwbGljYWNpw7NuIGNsaWVudGUgaW1wbGVtZW50YXJhIGZvcm11bGFyaW9zIG1hZXN0cm8tZGV0YWxsZSBwYXJhIG1vc3RyYXIgbGEgaW5mb3JtYWNpw7NuIGFzb2NpYWRhIGFsIHVzdWFyaW8NCg0KVW5hIGFwbGljYWNpw7NuIHdlYiBtdmMgbXXDqXN0cmFsbyBzaWd1aWVudGUNCkxpc3RhZG8gZGUgdXN1YXJpb3MgcmVnaXN0cmFkb3MNCk1lbnNhamVzIGRlIGxvcyB1c3VhcmlvcywgY2xhc2lmaWNhZG9zIHBvciBlbCB0aXBvIGRlIG1lbnNhamUuIFZlciBkZXRhbGxlIGRlIG1lbnNhamUsIGluY2x1eWUgZGVzY2FyZ2FyIGFyY2hpdm9zLg0KTW9zdHJhciBsb3Mgc2lndWllbnRlcyBpbmZvcm1lcw0KVXN1YXJpbyBjb24gbWFzIG1lbnNhamVzIGVudmlhZG9zOiBtb3N0cmFyIGNhbnRpZGFkDQpBcmNoaXZvcyBlbnZpYWRvcywgbGlzdGFyIHBvciB0YW1hw7FvIHkgbW9zdHJhciBwcm9waWV0YXJpbw0KTGlzdGEgZGUgdXN1YXJpb3MgY29uZWN0YWRvcyB5IGluZm9ybWFjacOzbjogSXAsIGhvcmEgZGUgY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQpMaXN0YSBkZSB1c3VhcmlvcyBkZXNjb25lY3RhZG9zIHkgaW5mb3JtYWNpw7NuOiBJcCwgaG9yYSBkZSBjb25leGnDs24sIGhvcmEgZGUgZGVzY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQoNCg0KVW4gc2VydmljaW8gd2ViIGRlIGFwaSByZXN0IHBhcmEgbW9zdHJhciBsbyBzaWd1aWVudGU6DQpJbmZvcm1hY2nDs24gY29tcGxldGEgZGUgdXN1YXJpbzogTm9tYnJlLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcywgY2FudGlkYWQgZGUgbWVuc2FqZXMgcmVjaWJpZG9zLCBmZWNoYSB5IGhvcmEgZGUgdWx0aW1hIGNvbmV4acOzbiwgZXN0YWRvIChkZXNjb25lY3RhZG8vY29uZWN0YWRvKQ0KTGlzdGEgZGUgbWVuc2FqZXMgZW52aWFkb3MgKElwIHVzdWFyaW8saXAgdXN1YXJpbyByZW1vdG8sZmVjaGEsaG9yYSkNCkxpc3RhIGRlIG1lbnNhamVzIHJlY2liaWRvcyAoSXAgdXN1YXJpbyxpcCB1c3VhcmlvIHJlbW90byxmZWNoYSxob3JhKQ=='
2025-11-23T16:28:19.195-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: laura -> manuel : Tipos de mensaje avanzadas.txt (2038 bytes)
2025-11-23T16:28:19.207-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763933299195_laura_Tipos de mensaje avanzadas.txt
2025-11-23T16:28:19.209-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:28:19.214-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:28:19.240-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'Tipos de mensaje avanzadas.txt' using columns nombre_original / nombre_almacenado, id=1
2025-11-23T16:28:19.240-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:28:19.244-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:28:19.247-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=2 receptorId=1 archivoId=1
2025-11-23T16:28:19.247-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=ARCHIVO, sesionId=null
2025-11-23T16:28:38.473-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T16:28:38.475-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:28:38.476-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T16:28:40.288-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:62368
2025-11-23T16:28:40.294-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:62368
2025-11-23T16:28:43.516-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:62368
2025-11-23T16:28:43.518-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:62368
2025-11-23T16:28:43.519-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:62368
2025-11-23T16:28:43.523-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:62368 conectado y saludado.
2025-11-23T16:28:43.524-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:28:43.526-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:28:43.548-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:28:43.554-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:28:43.555-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:28:43.557-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:62368
2025-11-23T16:28:43.557-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:62368
2025-11-23T16:28:43.574-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:28:43.578-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:28:43.579-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:28:43.584-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:28:43.594-05:00  WARN 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:28:43.597-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:28:43.606-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:28:43.613-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 7 mensajes históricos desde BD a manuel
2025-11-23T16:28:43.667-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:28:43.674-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:30:53.404-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 18712 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:30:53.404-05:00 DEBUG 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:30:53.404-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:30:55.492-05:00  INFO 18712 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:30:55.513-05:00  INFO 18712 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:30:55.518-05:00  INFO 18712 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:30:55.599-05:00  INFO 18712 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:30:55.599-05:00  INFO 18712 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2125 ms
2025-11-23T16:30:55.816-05:00  INFO 18712 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:30:56.384-05:00  INFO 18712 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3a17b2e3
2025-11-23T16:30:56.388-05:00  INFO 18712 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:30:56.555-05:00 DEBUG 18712 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:30:56.705-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:30:56.836-05:00  INFO 18712 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:30:57.422-05:00  INFO 18712 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:30:57.439-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.707 seconds (process running for 5.121)
2025-11-23T16:30:57.444-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:30:57.445-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:30:57.468-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:30:57.526-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:30:57.945-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:30:57.972-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:30:57.976-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:30:57.984-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:31:14.827-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61431
2025-11-23T16:31:14.842-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61431
2025-11-23T16:31:16.356-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61431
2025-11-23T16:31:16.357-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61431
2025-11-23T16:31:16.364-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61431
2025-11-23T16:31:16.391-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61431 conectado y saludado.
2025-11-23T16:31:16.393-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:31:16.402-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:31:16.412-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:31:16.417-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:31:16.417-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:31:16.417-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:61431
2025-11-23T16:31:16.417-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:61431
2025-11-23T16:31:16.417-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:31:16.423-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:31:16.423-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:31:16.427-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:31:16.433-05:00  WARN 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:31:16.433-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:31:16.442-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:31:16.452-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 7 mensajes históricos desde BD a manuel
2025-11-23T16:31:16.498-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:31:16.500-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:31:23.983-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63366
2025-11-23T16:31:23.996-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63366
2025-11-23T16:31:26.548-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63366
2025-11-23T16:31:26.548-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63366
2025-11-23T16:31:26.550-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63366
2025-11-23T16:31:26.554-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63366 conectado y saludado.
2025-11-23T16:31:26.554-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:31:26.570-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:31:26.584-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:31:26.586-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:31:26.587-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:31:26.589-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:63366
2025-11-23T16:31:26.591-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:63366
2025-11-23T16:31:26.596-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:31:26.613-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:31:26.618-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:31:26.623-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:31:26.629-05:00  WARN 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:31:26.634-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:31:26.640-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:31:26.652-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 7 mensajes históricos desde BD a laura
2025-11-23T16:31:26.700-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:31:26.707-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:31:50.981-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|puede ver el mensaje de arhivo?'
2025-11-23T16:31:50.981-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:31:50] Mensaje enviado por: laura Para manuel Contenido: puede ver el mensaje de arhivo?
2025-11-23T16:31:50.996-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:31:50 Mensaje enviado por: laura Para manuel Contenido: puede ver el mensaje de arhivo? (desde /192.168.40.12:63366)
2025-11-23T16:31:50.998-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:31:51.008-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:31:51.017-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:31:51.025-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:31:51.039-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='puede ver el mensaje de arhivo?'
2025-11-23T16:31:51.044-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:32:49.606-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola?'
2025-11-23T16:32:49.611-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:32:49] Mensaje enviado por: laura Para manuel Contenido: hola?
2025-11-23T16:32:49.615-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:32:49 Mensaje enviado por: laura Para manuel Contenido: hola? (desde /192.168.40.12:63366)
2025-11-23T16:32:49.619-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:32:49.624-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:32:49.626-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:32:49.634-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:32:49.634-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='hola?'
2025-11-23T16:32:49.634-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:32:55.812-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T16:32:55.816-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:32:55.818-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:32:57.920-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:55592
2025-11-23T16:32:57.934-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:55592
2025-11-23T16:33:01.454-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:55592
2025-11-23T16:33:01.458-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:55592
2025-11-23T16:33:01.460-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:55592
2025-11-23T16:33:01.479-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:55592 conectado y saludado.
2025-11-23T16:33:01.481-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:33:01.485-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:01.491-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:01.491-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:33:01.491-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:33:01.491-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:55592
2025-11-23T16:33:01.491-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:55592
2025-11-23T16:33:01.495-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:33:01.495-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:33:01.497-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:01.503-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:01.509-05:00  WARN 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:33:01.511-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:01.515-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:01.520-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 9 mensajes históricos desde BD a laura
2025-11-23T16:33:01.564-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:33:01.568-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:33:12.200-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola'
2025-11-23T16:33:12.200-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:33:12] Mensaje enviado por: laura Para manuel Contenido: hola
2025-11-23T16:33:12.204-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:33:12 Mensaje enviado por: laura Para manuel Contenido: hola (desde /192.168.40.12:55592)
2025-11-23T16:33:12.206-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:12.211-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:12.213-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:33:12.217-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:33:12.221-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='hola'
2025-11-23T16:33:12.229-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:33:19.737-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|si?'
2025-11-23T16:33:19.744-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:33:19] Mensaje enviado por: manuel Para laura Contenido: si?
2025-11-23T16:33:19.748-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:33:19 Mensaje enviado por: manuel Para laura Contenido: si? (desde /192.168.40.12:61431)
2025-11-23T16:33:19.750-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:33:19.754-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:33:19.756-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:19.760-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:19.766-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=null contenido='si?'
2025-11-23T16:33:19.766-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=null
2025-11-23T16:34:25.952-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53497
2025-11-23T16:34:25.961-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53497
2025-11-23T16:34:29.016-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53497
2025-11-23T16:34:29.017-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53497
2025-11-23T16:34:29.018-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53497
2025-11-23T16:34:29.022-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53497 conectado y saludado.
2025-11-23T16:34:29.025-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 3|hector|1234'
2025-11-23T16:34:29.043-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T16:34:29.052-05:00  WARN 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='hector' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T16:34:29.088-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Usuario 'hector' (id=3) registrado en DB
2025-11-23T16:34:29.090-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'hector' (id=3) desde /192.168.40.12:53497
2025-11-23T16:34:29.092-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: hector (id=3) desde /192.168.40.12:53497
2025-11-23T16:34:29.098-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 3
2025-11-23T16:34:29.103-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 3
2025-11-23T16:34:36.814-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN hector|1234'
2025-11-23T16:34:36.815-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T16:34:36.823-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T16:34:36.824-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='hector' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:34:36.826-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='hector'
2025-11-23T16:34:36.828-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='hector' desde /192.168.40.12:53497
2025-11-23T16:34:36.828-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: hector desde /192.168.40.12:53497
2025-11-23T16:34:36.831-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: hector (user-conns=1)
2025-11-23T16:34:36.831-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 3 clients: hector,laura,manuel
2025-11-23T16:34:36.832-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T16:34:36.837-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T16:34:36.848-05:00  WARN 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:34:36.861-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T16:34:36.870-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T16:34:46.999-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Usuario 'hector' desconectado.
2025-11-23T16:34:47.000-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario hector desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:34:47.001-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:37:54.632-05:00 ERROR 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:55592: java.net.SocketException: Connection reset
2025-11-23T16:37:54.632-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T16:37:54.632-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:37:54.632-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:38:01.429-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 14852 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:38:01.429-05:00 DEBUG 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:38:01.444-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:38:03.738-05:00  INFO 14852 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:38:03.763-05:00  INFO 14852 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:38:03.766-05:00  INFO 14852 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:38:03.862-05:00  INFO 14852 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:38:03.862-05:00  INFO 14852 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2347 ms
2025-11-23T16:38:04.156-05:00  INFO 14852 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:38:04.712-05:00  INFO 14852 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@45545e7a
2025-11-23T16:38:04.712-05:00  INFO 14852 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:38:04.873-05:00 DEBUG 14852 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:38:05.003-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:38:05.146-05:00  INFO 14852 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:38:05.729-05:00  INFO 14852 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:38:05.750-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.032 seconds (process running for 5.411)
2025-11-23T16:38:05.752-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:38:05.752-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:38:05.762-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:38:05.835-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:38:06.287-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:38:06.289-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:38:06.291-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:38:06.293-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:38:06.299-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:38:06.300-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:38:06.320-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:38:06.322-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:38:06.333-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:38:19.174-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:50452
2025-11-23T16:38:19.184-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:50452
2025-11-23T16:38:23.455-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:50452
2025-11-23T16:38:23.458-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:50452
2025-11-23T16:38:23.462-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:50452
2025-11-23T16:38:23.506-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:50452 conectado y saludado.
2025-11-23T16:38:23.507-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:38:23.524-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:38:23.532-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:38:23.540-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:38:23.540-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:38:23.542-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:50452
2025-11-23T16:38:23.542-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:50452
2025-11-23T16:38:23.544-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:38:23.546-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:38:23.565-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:38:23.570-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:38:23.572-05:00  WARN 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:38:23.572-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:38:23.584-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:38:23.593-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 11 mensajes históricos desde BD a manuel
2025-11-23T16:38:23.663-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:38:23.667-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:38:28.958-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:51521
2025-11-23T16:38:28.965-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:51521
2025-11-23T16:38:31.259-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:51521
2025-11-23T16:38:31.259-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:51521
2025-11-23T16:38:31.264-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:51521
2025-11-23T16:38:31.267-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:51521 conectado y saludado.
2025-11-23T16:38:31.271-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:38:31.273-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:38:31.285-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:38:31.289-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:38:31.293-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:38:31.294-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:51521
2025-11-23T16:38:31.296-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:51521
2025-11-23T16:38:31.297-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:38:31.297-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:38:31.299-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:38:31.303-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:38:31.307-05:00  WARN 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:38:31.307-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:38:31.310-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:38:31.317-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 11 mensajes históricos desde BD a laura
2025-11-23T16:38:31.357-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:38:31.359-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:38:45.414-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|voy a enviar otro archivo'
2025-11-23T16:38:45.421-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:38:45] Mensaje enviado por: manuel Para laura Contenido: voy a enviar otro archivo
2025-11-23T16:38:45.426-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:38:45 Mensaje enviado por: manuel Para laura Contenido: voy a enviar otro archivo (desde /192.168.40.12:50452)
2025-11-23T16:38:45.434-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:38:45.441-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:38:45.441-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:38:45.445-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:38:45.447-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=null contenido='voy a enviar otro archivo'
2025-11-23T16:38:45.447-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=null
2025-11-23T16:40:04.920-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR manuel|conversar.txt|185'
2025-11-23T16:40:04.923-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='manuel' filename='conversar.txt' size='185'
2025-11-23T16:40:04.928-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: conversar.txt size=185 desde /192.168.40.12:51521
2025-11-23T16:40:04.942-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA manuel|conversar.txt|Y29udmVyc2FyDQpwcmVzZW50YWNpb25lcw0KZ3VzdG9zDQpwYcOtcw0KZXh0cmFzDQoNCnRpZW5kYXMNCmN1YW50byB2YWxlLCBjdWFuZG8gcGFnbywgZWZlY3Rpdm8vdGFyamV0YQ0KcmVjb21lbmRhY2lvbmVzLCBkdWxjZSwgcHJvdGXDrW5hcywgDQpib2xzYXMsIHRhcmpldGFzIGRlIGFmaWxpYWRvDQoNCnNpdGlvcw0KDQo='
2025-11-23T16:40:04.951-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: laura -> manuel : conversar.txt (185 bytes)
2025-11-23T16:40:04.958-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763934004951_laura_conversar.txt
2025-11-23T16:40:04.961-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:40:04.965-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:40:04.975-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'conversar.txt' using columns nombre_original / nombre_almacenado, id=2
2025-11-23T16:40:04.975-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:40:04.975-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:40:04.975-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=2 receptorId=1 archivoId=2
2025-11-23T16:40:04.975-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=ARCHIVO, sesionId=null
2025-11-23T16:41:00.811-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:55588
2025-11-23T16:41:00.817-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:55588
2025-11-23T16:41:05.233-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:55588
2025-11-23T16:41:05.233-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:55588
2025-11-23T16:41:05.234-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:55588
2025-11-23T16:41:05.237-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:55588 conectado y saludado.
2025-11-23T16:41:05.243-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:41:05.245-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:41:05.249-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:41:05.251-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:41:05.253-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:41:05.253-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:55588
2025-11-23T16:41:05.254-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:55588
2025-11-23T16:41:05.255-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'manuel' desde la misma IP 192.168.40.12 (ya conectado)
2025-11-23T16:41:05.257-05:00  WARN 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'manuel' desde 192.168.40.12 motivo=ya_conectado_misma_ip
2025-11-23T16:41:15.686-05:00 ERROR 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:55588: java.net.SocketException: Connection reset
2025-11-23T16:41:15.686-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:55588 desconectado sin autenticarse.
2025-11-23T16:45:18.573-05:00 ERROR 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:51521: java.net.SocketException: Connection reset
2025-11-23T16:45:18.576-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T16:45:18.576-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:45:18.576-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:45:21.502-05:00 ERROR 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:50452: java.net.SocketException: Connection reset
2025-11-23T16:45:21.504-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T16:45:21.504-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:45:21.504-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T16:45:25.873-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 1608 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:45:25.887-05:00 DEBUG 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:45:25.888-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:45:28.065-05:00  INFO 1608 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:45:28.092-05:00  INFO 1608 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:45:28.092-05:00  INFO 1608 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:45:28.196-05:00  INFO 1608 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:45:28.198-05:00  INFO 1608 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2245 ms
2025-11-23T16:45:28.374-05:00  INFO 1608 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:45:28.920-05:00  INFO 1608 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2007435e
2025-11-23T16:45:28.920-05:00  INFO 1608 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:45:29.065-05:00 DEBUG 1608 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:45:29.176-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:45:29.289-05:00  INFO 1608 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:45:29.756-05:00  INFO 1608 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:45:29.761-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.608 seconds (process running for 5.02)
2025-11-23T16:45:29.773-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:45:29.774-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:45:29.789-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:45:29.847-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:45:30.130-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:45:30.138-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:45:30.140-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:45:36.608-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63025
2025-11-23T16:45:36.622-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63025
2025-11-23T16:45:43.092-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63025
2025-11-23T16:45:43.092-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63025
2025-11-23T16:45:43.094-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63025
2025-11-23T16:45:43.115-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63025 conectado y saludado.
2025-11-23T16:45:43.117-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:45:43.136-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:45:43.143-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:45:43.146-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:45:43.152-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:45:43.153-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:63025
2025-11-23T16:45:43.155-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:63025
2025-11-23T16:45:43.157-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:45:43.159-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:45:43.161-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:45:43.164-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:45:43.174-05:00  WARN 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:45:43.178-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:45:43.182-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:45:43.196-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 13 mensajes históricos desde BD a manuel
2025-11-23T16:45:43.247-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:43.253-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:43.310-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:43.311-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:47.311-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59661
2025-11-23T16:45:47.315-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59661
2025-11-23T16:45:48.698-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59661
2025-11-23T16:45:48.698-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59661
2025-11-23T16:45:48.698-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59661
2025-11-23T16:45:48.702-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59661 conectado y saludado.
2025-11-23T16:45:48.704-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:45:48.706-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:45:48.713-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:45:48.713-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:45:48.715-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:45:48.715-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:59661
2025-11-23T16:45:48.719-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:59661
2025-11-23T16:45:48.719-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:45:48.719-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:45:48.719-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:45:48.723-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:45:48.727-05:00  WARN 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:45:48.727-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:45:48.733-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:45:48.740-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 13 mensajes históricos desde BD a laura
2025-11-23T16:45:48.778-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:48.778-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:48.816-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:48.817-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:46:04.139-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|mensaje actualizado'
2025-11-23T16:46:04.145-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:46:04] Mensaje enviado por: laura Para manuel Contenido: mensaje actualizado
2025-11-23T16:46:04.150-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:46:04 Mensaje enviado por: laura Para manuel Contenido: mensaje actualizado (desde /192.168.40.12:59661)
2025-11-23T16:46:04.150-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:46:04.155-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:46:04.157-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:46:04.161-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:46:04.163-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='mensaje actualizado'
2025-11-23T16:46:04.163-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:48:34.257-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 19680 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:48:34.257-05:00 DEBUG 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:48:34.257-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:48:36.737-05:00  INFO 19680 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:48:36.764-05:00  INFO 19680 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:48:36.766-05:00  INFO 19680 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:48:36.894-05:00  INFO 19680 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:48:36.896-05:00  INFO 19680 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2560 ms
2025-11-23T16:48:37.140-05:00  INFO 19680 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:48:37.825-05:00  INFO 19680 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@54c622a7
2025-11-23T16:48:37.827-05:00  INFO 19680 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:48:38.064-05:00 DEBUG 19680 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:48:38.288-05:00  INFO 19680 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:48:38.463-05:00  INFO 19680 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:48:39.088-05:00  INFO 19680 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:48:39.101-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.764 seconds (process running for 6.25)
2025-11-23T16:48:39.110-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:48:39.113-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:48:39.130-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:48:39.219-05:00  INFO 19680 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:48:39.668-05:00  INFO 19680 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:48:39.672-05:00  INFO 19680 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:48:39.672-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:48:39.674-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:48:39.674-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:48:39.676-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:48:39.699-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:48:39.703-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:48:39.711-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:49:07.997-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 5156 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:49:07.997-05:00 DEBUG 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:49:07.997-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:49:10.256-05:00  INFO 5156 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:49:10.277-05:00  INFO 5156 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:49:10.277-05:00  INFO 5156 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:49:10.382-05:00  INFO 5156 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:49:10.382-05:00  INFO 5156 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2292 ms
2025-11-23T16:49:10.589-05:00  INFO 5156 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:49:11.301-05:00  INFO 5156 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@23cbbd07
2025-11-23T16:49:11.306-05:00  INFO 5156 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:49:11.527-05:00 DEBUG 5156 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:49:11.724-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:49:11.884-05:00  INFO 5156 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:49:12.360-05:00  INFO 5156 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:49:12.369-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.359 seconds (process running for 6.164)
2025-11-23T16:49:12.374-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:49:12.376-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:49:12.383-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:49:12.451-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:49:12.732-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:49:12.749-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:49:12.750-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:49:12.753-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:49:12.825-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59740
2025-11-23T16:49:12.835-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59740
2025-11-23T16:49:14.657-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59740
2025-11-23T16:49:14.657-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59740
2025-11-23T16:49:14.659-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59740
2025-11-23T16:49:14.678-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59740 conectado y saludado.
2025-11-23T16:49:14.680-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:49:14.695-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:49:14.704-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:49:14.709-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:49:14.709-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:49:14.709-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:59740
2025-11-23T16:49:14.713-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:59740
2025-11-23T16:49:14.713-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:49:14.715-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:49:14.715-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:49:14.717-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:49:14.726-05:00  WARN 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:49:14.735-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:49:14.741-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:49:14.748-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 14 mensajes históricos desde BD a manuel
2025-11-23T16:49:14.795-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:14.801-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:14.846-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:14.858-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:23.385-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:55032
2025-11-23T16:49:23.393-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:55032
2025-11-23T16:49:25.724-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:55032
2025-11-23T16:49:25.724-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:55032
2025-11-23T16:49:25.724-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:55032
2025-11-23T16:49:25.742-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:55032 conectado y saludado.
2025-11-23T16:49:25.742-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:49:25.744-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:49:25.752-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:49:25.753-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:49:25.757-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:49:25.757-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:55032
2025-11-23T16:49:25.759-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:55032
2025-11-23T16:49:25.759-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:49:25.759-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:49:25.762-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:49:25.768-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:49:25.778-05:00  WARN 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:49:25.785-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:49:25.790-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:49:25.799-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 14 mensajes históricos desde BD a laura
2025-11-23T16:49:25.843-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:25.846-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:25.891-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:25.891-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:33.458-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T16:49:33.460-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:49:33.462-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:49:39.114-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49671
2025-11-23T16:49:39.125-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49671
2025-11-23T16:49:41.875-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49671
2025-11-23T16:49:41.877-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49671
2025-11-23T16:49:41.877-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49671
2025-11-23T16:49:41.880-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49671 conectado y saludado.
2025-11-23T16:49:41.895-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:49:41.896-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:49:41.908-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:49:41.908-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:49:41.908-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:49:41.910-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:49671
2025-11-23T16:49:41.910-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:49671
2025-11-23T16:49:41.913-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'manuel' desde la misma IP 192.168.40.12 (ya conectado)
2025-11-23T16:49:41.915-05:00  WARN 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'manuel' desde 192.168.40.12 motivo=ya_conectado_misma_ip
2025-11-23T16:55:55.871-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 972 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:55:55.876-05:00 DEBUG 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:55:55.876-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:55:57.715-05:00  INFO 972 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:55:57.731-05:00  INFO 972 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:55:57.732-05:00  INFO 972 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:55:57.828-05:00  INFO 972 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:55:57.828-05:00  INFO 972 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1867 ms
2025-11-23T16:55:58.016-05:00  INFO 972 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:55:58.491-05:00  INFO 972 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@54c622a7
2025-11-23T16:55:58.491-05:00  INFO 972 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:55:58.628-05:00 DEBUG 972 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:55:58.745-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:55:58.857-05:00  INFO 972 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:55:59.284-05:00  INFO 972 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:55:59.293-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.473 seconds (process running for 5.119)
2025-11-23T16:55:59.299-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:55:59.300-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:55:59.305-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:55:59.370-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:55:59.654-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:55:59.654-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:55:59.654-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:55:59.658-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:55:59.658-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:55:59.658-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:55:59.667-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:55:59.670-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:55:59.673-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:56:03.576-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59215
2025-11-23T16:56:03.583-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59215
2025-11-23T16:56:07.583-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59215
2025-11-23T16:56:07.585-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59215
2025-11-23T16:56:07.587-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59215
2025-11-23T16:56:07.609-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59215 conectado y saludado.
2025-11-23T16:56:07.612-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:56:07.630-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:56:07.632-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:56:07.645-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:56:07.645-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:56:07.645-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:59215
2025-11-23T16:56:07.645-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:59215
2025-11-23T16:56:07.645-05:00  INFO 972 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:56:07.650-05:00  INFO 972 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:56:07.650-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:56:07.654-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:56:07.667-05:00  WARN 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:56:07.667-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:56:07.674-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:56:07.686-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 14 mensajes históricos desde BD a manuel
2025-11-23T16:56:07.739-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:56:07.745-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:56:07.794-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:56:07.796-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:56:59.276-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64533
2025-11-23T16:56:59.283-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64533
2025-11-23T16:57:02.114-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64533
2025-11-23T16:57:02.114-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64533
2025-11-23T16:57:02.116-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64533
2025-11-23T16:57:02.118-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64533 conectado y saludado.
2025-11-23T16:57:02.118-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:57:02.121-05:00 DEBUG 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:57:02.128-05:00 DEBUG 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:57:02.128-05:00 DEBUG 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:57:02.128-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:57:02.130-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:64533
2025-11-23T16:57:02.131-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:64533
2025-11-23T16:57:02.131-05:00  INFO 972 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'manuel' desde la misma IP 192.168.40.12 (ya conectado)
2025-11-23T16:57:02.131-05:00  WARN 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'manuel' desde 192.168.40.12 motivo=Error: Limite de ips excedido, no puede ingresar en este equipo
2025-11-23T16:57:07.623-05:00 ERROR 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:64533: java.net.SocketException: Connection reset
2025-11-23T16:57:07.635-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64533 desconectado sin autenticarse.
2025-11-23T16:57:10.724-05:00 ERROR 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:59215: java.net.SocketException: Connection reset
2025-11-23T16:57:10.724-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T16:57:10.724-05:00  INFO 972 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:57:10.724-05:00  INFO 972 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T17:58:21.025-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 4660 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T17:58:21.025-05:00 DEBUG 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T17:58:21.034-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T17:58:23.352-05:00  INFO 4660 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T17:58:23.375-05:00  INFO 4660 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T17:58:23.376-05:00  INFO 4660 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T17:58:23.470-05:00  INFO 4660 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T17:58:23.471-05:00  INFO 4660 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2365 ms
2025-11-23T17:58:23.663-05:00  INFO 4660 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T17:58:24.328-05:00  INFO 4660 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@76e3b45b
2025-11-23T17:58:24.336-05:00  INFO 4660 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T17:58:24.471-05:00 DEBUG 4660 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T17:58:24.619-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T17:58:24.757-05:00  INFO 4660 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T17:58:25.233-05:00  INFO 4660 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T17:58:25.241-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.986 seconds (process running for 5.623)
2025-11-23T17:58:25.245-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T17:58:25.245-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T17:58:25.253-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T17:58:25.360-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T17:58:25.927-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 6
2025-11-23T17:58:25.935-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 6
2025-11-23T17:58:25.935-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T17:58:43.414-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:52662
2025-11-23T17:58:43.422-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:52662
2025-11-23T17:58:45.080-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:52662
2025-11-23T17:58:45.080-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:52662
2025-11-23T17:58:45.086-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:52662
2025-11-23T17:58:45.118-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:52662 conectado y saludado.
2025-11-23T17:58:45.118-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T17:58:45.139-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T17:58:45.152-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T17:58:45.160-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T17:58:45.160-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T17:58:45.160-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:52662
2025-11-23T17:58:45.164-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:52662
2025-11-23T17:58:45.164-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T17:58:45.168-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T17:58:45.168-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T17:58:45.176-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T17:58:45.193-05:00  WARN 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T17:58:45.196-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T17:58:45.201-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T17:58:45.210-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a manuel
2025-11-23T17:58:51.280-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T17:58:51.282-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T17:58:51.286-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T17:58:55.723-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:57916
2025-11-23T17:58:55.735-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:57916
2025-11-23T17:58:57.426-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:57916
2025-11-23T17:58:57.426-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:57916
2025-11-23T17:58:57.426-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:57916
2025-11-23T17:58:57.434-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:57916 conectado y saludado.
2025-11-23T17:58:57.434-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T17:58:57.442-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T17:58:57.460-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T17:58:57.463-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T17:58:57.463-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T17:58:57.466-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:57916
2025-11-23T17:58:57.467-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:57916
2025-11-23T17:58:57.467-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T17:58:57.467-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T17:58:57.467-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T17:58:57.476-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T17:58:57.486-05:00  WARN 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T17:58:57.489-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T17:58:57.489-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T17:59:56.381-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T17:59:56.383-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T17:59:56.383-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T18:00:00.549-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:58775
2025-11-23T18:00:00.554-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:58775
2025-11-23T18:00:03.456-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:58775
2025-11-23T18:00:03.458-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:58775
2025-11-23T18:00:03.487-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:58775
2025-11-23T18:00:03.510-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:58775 conectado y saludado.
2025-11-23T18:00:03.512-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T18:00:03.518-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:00:03.526-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:00:03.528-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T18:00:03.542-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T18:00:03.542-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:58775
2025-11-23T18:00:03.544-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:58775
2025-11-23T18:00:03.569-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T18:00:03.569-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:00:03.571-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:00:03.581-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:00:03.587-05:00  WARN 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T18:00:03.593-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:00:03.599-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:01:36.111-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49393
2025-11-23T18:01:36.121-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49393
2025-11-23T18:01:39.761-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49393
2025-11-23T18:01:39.762-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49393
2025-11-23T18:01:39.764-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49393
2025-11-23T18:01:39.768-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49393 conectado y saludado.
2025-11-23T18:01:39.771-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T18:01:39.776-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:01:39.786-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:01:39.792-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T18:01:39.794-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T18:01:39.794-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:49393
2025-11-23T18:01:39.794-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:49393
2025-11-23T18:01:39.813-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:01:39.814-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:01:39.816-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:01:39.826-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:01:39.835-05:00  WARN 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T18:01:39.845-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:01:39.851-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:01:39.857-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a manuel
2025-11-23T18:01:59.157-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|hola laura'
2025-11-23T18:01:59.161-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:01:59] Mensaje enviado por: manuel Para laura Contenido: hola laura
2025-11-23T18:01:59.175-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:01:59 Mensaje enviado por: manuel Para laura Contenido: hola laura (desde /192.168.40.12:49393)
2025-11-23T18:01:59.179-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:01:59.195-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:01:59.195-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:01:59.199-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:01:59.202-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=4 sesionId=null contenido='hola laura'
2025-11-23T18:01:59.212-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=4, tipo=TEXTO, sesionId=null
2025-11-23T18:02:08.798-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola manuel'
2025-11-23T18:02:08.806-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:02:08] Mensaje enviado por: laura Para manuel Contenido: hola manuel
2025-11-23T18:02:08.816-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:02:08 Mensaje enviado por: laura Para manuel Contenido: hola manuel (desde /192.168.40.12:58775)
2025-11-23T18:02:08.822-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:02:08.830-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:02:08.847-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:08.852-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:08.852-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=4 receptorId=1 sesionId=null contenido='hola manuel'
2025-11-23T18:02:08.852-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=4, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T18:02:21.575-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR laura|1020-1030.txt|2876'
2025-11-23T18:02:21.582-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='laura' filename='1020-1030.txt' size='2876'
2025-11-23T18:02:21.587-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: 1020-1030.txt size=2876 desde /192.168.40.12:49393
2025-11-23T18:02:21.615-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA laura|1020-1030.txt|RW1wcmVzYXMgaW50ZWxpZ2VudGVzOiBldm9sdWNpw7NuIHkgY3JlY2ltaWVudG8gZW4gdGllbXBvcyBkZSBsYSBJQQ0KTGFzIGVtcHJlc2FzIG5vIGRlYmVuIHRlbmVybGUgbWllZG8gYSB1c2FyIGxhIGlhLCBkZWJlbiBpbnRlZ3JhcmxhIHJlc3BvbnNhYmxlbWVudGUgYSBzdXMgb3BlcmFjaW9uZXMgeSBjYXBhY2l0YXIgYSBzdXMgZW1wbGVhZG9zIGFjZXJjYSBkZSByaWVzZ29zIHkgYmVuZWZpY2lvcw0KDQpDdWx0dXJhIEFuYWzDrXRpY2E6IMK/Q8OzbW8gbm8gZGVtb2NyYXRpemFyIGVsIHVzbyBkZSBsb3MgZGF0b3MgZW4gb3JnYW5pemFjaW9uZXMgcMO6YmxpY2FzIHkgcHJpdmFkYXM/DQpUZW5lciBjdWlkYWRvIGNvbiBsb3MgZGF0b3Mgc2Vuc2libGVzIHF1ZSB0aWVuZW4gbG9zIGFnZW50ZXMsIGxhcyBlbXByZXNhcyBwdWVkZW4gdGVuZXIgYWdlbnRlcyBjZW50cmFsaXphZG9zIHByaXZhZG9zDQpDSU8gZXMgbMOtZGVyIGRlIGFuYWzDrXRpY2EsIG11Y2hhcyByZXNwb25zYWJpbGlkYWRlcw0KTWVkaWNpw7NuIGRlIGRhdG9zLCBnb2Jlcm5hbnphIGRlIGRhdG9zDQpBbmFsaXRpY2EgZGUgSUEgZW4gb3JncmFuaXphY2lvbmVzDQpTYW50aWFnbyBSZXN0cmVwbyBEaXJlY3RvciBEYXRhIHkgZXN0cmF0ZWdpYSBkZSBwdW50b3MgQ29sb21iaWENCkFuZHJlcyBDYXN0ZWxsYW5vcyBIZWFkIG9mIERhdGEgJiBBcnRpZmljaWFsIEludGVsbGlnZW5jZSBkZSBWbGFtZXJpY2FzIENvcnANCk5vcm1hIEVzcGlub3NhIERpcmVjdG9yIERhdG9zICYgQW5hbGl0aWNhIGRlIEdlbnRlcmENCkFuZHJlcyBCYXJyYW50ZXMgVlAgR2xvYmFsIEFXUyBQcmFjdGljZSBIZWFkIG9mIEJsZW5kDQoNCjExOjMwLTEyOjIwDQpBeXVkYXJzZSBkZSBsYSBJQSBwYXJhIHRlbmVyIHZlbnRhamEgY29tcGV0aXRpdmEsIG5vIGVzIGRlbWFzaWFkbyBjb21wbGVqbyBkZSB1c2FyIHkgcmVudGEgbXVjaG8gYXByZW5lciBhIG1hbmVqYXJsYSBwb3IgbGFzIGdhbmFuY2lhcyBxdWUgcHVlZGUgYnJpbmRhcg0KQmFzZXMgZGUgZGF0b3Mgb2x0cCBNaWNyb3NvZnQgeSBhenVyZSBvZnJlY2VuIGNhZGEgdW5vIHVuIG1vdG9yIGRiIGNvbiB0b2RvIHVuIHByb2R1Y3RvIGRlICwgQ29zbW9zIG9mcmVjZSB1bm8gTm8gT3NxbCwgbm90IG9ubHkNClNlIHF1aWVyZSB2ZXIgaW5mbyBlbiB0aWVtcG8gcmVhbCwgbm8gZXNwZXJhciBhIGxhIEVUTA0KT3BlcmFjaW9uZXMgdHJhbnNhY2Npb25hbGVzIHkgYW5hbGl0aWNhcyBlbiB1bmEgc29sYSBwZXRpY2lvbg0KDQpSdXRhIHBhcmEgZGVzYXJyb2xsbyBkZSBhcHAgZGUgaWEgYWxpbWVudGFkYSBjb24gZGF0YSBkZSBsYSBlbXByZXNhDQoxLiBlc3RhYmxlY2VyIHJlcG9zaXRvcmlvIGNlbnRyYXINCjIuIHByZXBhcmFyIGRhdGEgcGFyYSBpbm5vdmFjaW9uIGRlIGlhDQozLiBDcmVhciBwbGF0YWZvcm1hIHVuaWZpY2FkYSBkZSBpYQ0KNC4gY29uc3RydWlyIGV4cGVyaWVuY2lhcyBkZSBpYSBjb24gbGEgcHJvcGlhIGRhdGEgZGUgbGEgZW1wcmVzYQ0KDQpMYSBhY3R1YWxpZGFkIHNvbiBsb3MgYWdlbnRlcywgZWwgZnV0dXJvIGFnZW50ZXMgcXVlIGNvbnN1bHRhbiBhIGFnZW50ZXMgY29tbyBvcnF1ZXN0YSBtdXNpY2FsLiBTZSBkZWJlIHRlbmVyIGVuIGN1ZW50YSBjdWFuZG8geSBjb21vIHVuIGFnZW50ZSBlcyBtZWpvciBxdWUgb3RybywgcGFyYSBwb2RlciBlbGVnaXIgYmllbi4gTWljcm9zb2Z0IHBlcm1pdGUgdW5hIGdyYW4gdmFyaWVkYWQgZGUgb3BjaW9uZXMgcGFyYSB0ZW5lciBlbCBtZWpvciBkZXNlbXBlw7FvDQpNaWNyb3NvZnQgZmFicmljIHkgQXp1cmUgQUkgRm91bmRyeSBwZXJtaXRlbiBjcmVhciBhZ2VudGVzDQpFc3RvcyBhZ2VudGVzIHNlIHB1ZWRlbiBjb25zdW1pciBwb3Igb3Ryb3MgdXN1YXJpb3MsIGludGVybm9zIG8gZXh0ZXJub3MgYSBsYSBlbXByZXNhDQoNCg0KQ29uc3RydXllbmRvIEVxdWlwb3MgZGUgRGF0b3MgZW4gTEFUQU06IEF0cmFjY2nDs24sIFJldGVuY2nDs24geSBVcHNraWxsaW5nIHluIElBDQoNCkVtcHJlc2FzIG9mcmVjZW4gZmxleGliaWxpYWRlcyBsYWJvcmFsZXMgZW4gZXN0b3MgY2FtcG9zLCBsYXMgcGVyc29uYXMgc2UgdmFuIHBvciBjcmVjaW1pZW50byBwZXJzb25hbCB5IG1lam9yZXMgb2ZlcnRhcywgaGF5IHF1ZSBoYWNlciBjcmVjZXIgYSBsYXMgcGVyc29uYXMgZGVzZGUgbGFzIGVtcHJlc2FzDQpsYXMgcGVyc29uYXMgZGViZW4gc2VudGlyc2UgcGFydGUgZGUgbG9zIHByb3llY3RvcyBwYXJhIGV2aXRhciByb3RhY2lvbiBkZSBwZXJzb25hbCwgbGEgYWRhcHRhY2lvbiBhbnRlIGxvcyBjYW1iaW9zIGVzIGRpZmljaWwNCg0KU2UgbmVjZXNpdGFuIHByb2Zlc2lvbmFsZXMgZGUgZGF0b3MgZGFkbyBlbCBjcmVjaW1pZW50byBkZWwgbWVyY2FkbywgaGF5IG11Y2hvcyBlY29ub21pc3RhcywgZXN0YWRpc3RpY29zIG8gaW5nIGRlIHNpc3RlbWFzLCBwZXJvIG5vIHByb2Zlc2lvbmFsZXMgZGUgZGF0b3MNCg0KU2UgbWlkZSBtdWNobyBsYSBwcm9kdWN0aXZpZGFkIGRlIGxvcyByZXN1bHRhZG9zLCBwb2NvIGVsIGNyZWNpbWllbnRvIGRlIHBlcnNvbmFzDQpTZSBkZWJlIGNvbnN0cnVpciBlbCB0YWxlbnRvIGRlc2RlIG9yZ2FuaXphY2lvbmVzLCBsYSBpYSBwdWVkZSBzZXIgaGVycmFtaWVudGEgcGVybyBubyByZWVtcGxhem8sIGVsIHRhbGVudG8gaHVtYW5vIGRlYmUgc2VndWlyIHNpZW5kbyBsYSBhcHVlc3RhIGRlIGxhcyBlbXByZXNhcywgZGUgbGEgbWFubyBjb24gaWENCk5vIHRvZGFzIGxhcyBwbGF0YWZvcm1hcyBkZWJlbiBzZXIgdGFuIGdyYW5kZXMgbyBwZXF1ZcOxYXMgY29tbyBsYXMgbWFzIGZhbW9zYXMsIHNlIGRlYmUgYnVzY2FyIGZ1bmNpb25hbGlkYWQgbm8gaW1hZ2VuIGRlIHBvZGVyDQo='
2025-11-23T18:02:21.645-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: manuel -> laura : 1020-1030.txt (2876 bytes)
2025-11-23T18:02:21.666-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763938941649_manuel_1020-1030.txt
2025-11-23T18:02:21.666-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:21.678-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:21.730-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file '1020-1030.txt' using columns nombre_original / nombre_almacenado, id=1
2025-11-23T18:02:21.730-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:02:21.738-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:02:21.738-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=1 receptorId=4 archivoId=1
2025-11-23T18:02:21.738-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=4, tipo=ARCHIVO, sesionId=null
2025-11-23T18:02:32.676-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T18:02:32.677-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:02:32.680-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:02:34.579-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63243
2025-11-23T18:02:34.591-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63243
2025-11-23T18:02:37.978-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63243
2025-11-23T18:02:37.980-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63243
2025-11-23T18:02:37.982-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63243
2025-11-23T18:02:37.982-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63243 conectado y saludado.
2025-11-23T18:02:37.988-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T18:02:38.013-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:38.023-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:38.029-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T18:02:38.029-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T18:02:38.031-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:63243
2025-11-23T18:02:38.033-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:63243
2025-11-23T18:02:38.072-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:02:38.080-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:02:38.084-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:38.090-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:38.098-05:00  WARN 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T18:02:38.100-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:38.108-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:38.112-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T18:02:38.160-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T18:02:38.166-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T18:05:02.540-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T18:05:02.542-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:05:02.548-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:05:17.039-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64409
2025-11-23T18:05:17.044-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64409
2025-11-23T18:05:18.585-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64409
2025-11-23T18:05:18.585-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64409
2025-11-23T18:05:18.586-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64409
2025-11-23T18:05:18.588-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64409 conectado y saludado.
2025-11-23T18:05:18.589-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T18:05:18.590-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:05:18.599-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:05:18.602-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T18:05:18.603-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T18:05:18.603-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:64409
2025-11-23T18:05:18.604-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:64409
2025-11-23T18:05:18.605-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:05:18.605-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:05:18.607-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:05:18.611-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:05:18.616-05:00  WARN 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T18:05:18.619-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:05:18.624-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:05:18.631-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T18:05:18.662-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T18:05:18.673-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T18:05:31.026-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|mensaje para laura'
2025-11-23T18:05:31.034-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:05:31] Mensaje enviado por: manuel Para laura Contenido: mensaje para laura
2025-11-23T18:05:31.042-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:05:31 Mensaje enviado por: manuel Para laura Contenido: mensaje para laura (desde /192.168.40.12:64409)
2025-11-23T18:05:31.043-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:05:31.052-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:05:31.055-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:05:31.061-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:05:31.077-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=4 sesionId=null contenido='mensaje para laura'
2025-11-23T18:05:31.086-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=4, tipo=TEXTO, sesionId=null
2025-11-23T18:38:30.687-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 12856 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T18:38:30.690-05:00 DEBUG 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T18:38:30.692-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T18:38:32.371-05:00  INFO 12856 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T18:38:32.390-05:00  INFO 12856 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T18:38:32.390-05:00  INFO 12856 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T18:38:32.474-05:00  INFO 12856 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T18:38:32.474-05:00  INFO 12856 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1710 ms
2025-11-23T18:38:32.717-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-23T18:38:32.757-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-23T18:38:32.757-05:00  INFO 12856 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T18:38:33.128-05:00  INFO 12856 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@72a2312e
2025-11-23T18:38:33.128-05:00  INFO 12856 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T18:38:33.188-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-23T18:38:33.242-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T18:38:33.450-05:00  INFO 12856 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T18:38:33.842-05:00  INFO 12856 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T18:38:33.854-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.801 seconds (process running for 4.245)
2025-11-23T18:38:33.861-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T18:38:33.862-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T18:38:33.874-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T18:38:33.922-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T18:38:34.232-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T18:38:34.233-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T18:38:34.234-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T18:38:34.234-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T18:38:34.235-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T18:38:34.235-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T18:38:34.273-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-23T18:38:34.275-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-23T18:38:34.277-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T18:39:05.928-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49671
2025-11-23T18:39:05.934-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49671
2025-11-23T18:39:08.067-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49671
2025-11-23T18:39:08.068-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49671
2025-11-23T18:39:08.068-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49671
2025-11-23T18:39:08.077-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49671 conectado y saludado.
2025-11-23T18:39:08.077-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|manuel|1234'
2025-11-23T18:39:08.095-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:39:08.100-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='manuel' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:39:08.125-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'manuel' (id=1) registrado en DB
2025-11-23T18:39:08.125-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'manuel' (id=1) desde /192.168.40.12:49671
2025-11-23T18:39:08.125-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: manuel (id=1) desde /192.168.40.12:49671
2025-11-23T18:39:08.125-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-23T18:39:08.139-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-23T18:39:15.073-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T18:39:15.077-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T18:39:15.078-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:49671
2025-11-23T18:39:15.079-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:49671
2025-11-23T18:39:15.080-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:39:15.083-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T18:39:15.083-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:39:15.087-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:39:15.126-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=b0db89b6-2ec2-4d69-859a-c5cc11bf202d
2025-11-23T18:39:15.126-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:39:15.126-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:39:19.141-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T18:39:19.143-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:39:19.143-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T18:39:23.404-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:52554
2025-11-23T18:39:23.411-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:52554
2025-11-23T18:39:25.313-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:52554
2025-11-23T18:39:25.314-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:52554
2025-11-23T18:39:25.314-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:52554
2025-11-23T18:39:25.316-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:52554 conectado y saludado.
2025-11-23T18:39:25.316-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|manuel|1234'
2025-11-23T18:39:25.320-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:39:25.320-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 2
2025-11-23T18:39:25.321-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='2' desde /192.168.40.12:52554
2025-11-23T18:39:25.325-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 2 desde /192.168.40.12:52554
2025-11-23T18:39:31.380-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|laura|1234'
2025-11-23T18:39:31.381-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:39:31.384-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='laura' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:39:31.407-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'laura' (id=2) registrado en DB
2025-11-23T18:39:31.408-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'laura' (id=2) desde /192.168.40.12:52554
2025-11-23T18:39:31.408-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: laura (id=2) desde /192.168.40.12:52554
2025-11-23T18:39:31.411-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-23T18:39:31.412-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-23T18:39:38.940-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|laura|1234'
2025-11-23T18:39:38.944-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura' id=2
2025-11-23T18:39:38.944-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='laura' id=2 desde /192.168.40.12:52554
2025-11-23T18:39:38.945-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura (id=2) desde /192.168.40.12:52554
2025-11-23T18:39:38.945-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T18:39:38.945-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:39:38.946-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:39:38.949-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:39:38.963-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario laura id=ade6fccb-6727-4b76-891a-3ce57e5a3703
2025-11-23T18:39:38.963-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:39:38.975-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:40:03.058-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49672
2025-11-23T18:40:03.064-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49672
2025-11-23T18:40:05.090-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49672
2025-11-23T18:40:05.091-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49672
2025-11-23T18:40:05.092-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49672
2025-11-23T18:40:05.094-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49672 conectado y saludado.
2025-11-23T18:40:05.095-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|laura|1234'
2025-11-23T18:40:05.100-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura' id=2
2025-11-23T18:40:05.100-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='laura' id=2 desde /192.168.40.12:49672
2025-11-23T18:40:05.100-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura (id=2) desde /192.168.40.12:49672
2025-11-23T18:40:05.100-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'laura' desde la misma IP 192.168.40.12 (ya conectado)
2025-11-23T18:40:05.104-05:00  WARN 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'laura' desde 192.168.40.12 motivo=Error: Limite de ips excedido, no puede ingresar en este equipo
2025-11-23T18:40:17.477-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T18:40:17.480-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T18:40:17.481-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:49672
2025-11-23T18:40:17.481-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:49672
2025-11-23T18:40:17.482-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:40:17.482-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:40:17.483-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:40:17.486-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:40:17.509-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=a182664a-c166-4966-b406-42dfcf973f95
2025-11-23T18:40:17.509-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:40:17.513-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:40:28.714-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54522
2025-11-23T18:40:28.731-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54522
2025-11-23T18:40:31.151-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54522
2025-11-23T18:40:31.152-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54522
2025-11-23T18:40:31.152-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54522
2025-11-23T18:40:31.154-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54522 conectado y saludado.
2025-11-23T18:40:31.155-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 3|hector|1234'
2025-11-23T18:40:31.159-05:00  WARN 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='3' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:40:31.160-05:00  WARN 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 3
2025-11-23T18:40:31.160-05:00  WARN 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='3' desde /192.168.40.12:54522
2025-11-23T18:40:31.162-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 3 desde /192.168.40.12:54522
2025-11-23T18:40:34.952-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 3|hector|1234'
2025-11-23T18:40:34.953-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T18:40:34.955-05:00  WARN 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='hector' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:40:34.960-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Usuario 'hector' (id=3) registrado en DB
2025-11-23T18:40:34.960-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'hector' (id=3) desde /192.168.40.12:54522
2025-11-23T18:40:34.961-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: hector (id=3) desde /192.168.40.12:54522
2025-11-23T18:40:34.964-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 3
2025-11-23T18:40:34.964-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 3
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 3|hector|1234'
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='hector' id=3
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='hector' id=3 desde /192.168.40.12:54522
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: hector (id=3) desde /192.168.40.12:54522
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: hector (user-conns=1)
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 3 clients: hector,laura,manuel
2025-11-23T18:40:43.419-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T18:40:43.432-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T18:40:43.451-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario hector id=b15f6d8e-ac21-4699-9ca0-fc8fb15b9dbd
2025-11-23T18:40:43.451-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T18:40:43.451-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T18:41:01.900-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola manuek'
2025-11-23T18:41:01.900-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:41:01] Mensaje enviado por: laura Para manuel Contenido: hola manuek
2025-11-23T18:41:01.906-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:41:01 Mensaje enviado por: laura Para manuel Contenido: hola manuek (desde /192.168.40.12:52554)
2025-11-23T18:41:01.909-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:01.911-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:01.915-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:01.918-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:01.920-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=ade6fccb-6727-4b76-891a-3ce57e5a3703 contenido='hola manuek'
2025-11-23T18:41:01.926-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=ade6fccb-6727-4b76-891a-3ce57e5a3703
2025-11-23T18:41:07.988-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|voy a enviarle un archivo'
2025-11-23T18:41:07.988-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:41:07] Mensaje enviado por: laura Para manuel Contenido: voy a enviarle un archivo
2025-11-23T18:41:07.988-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:41:07 Mensaje enviado por: laura Para manuel Contenido: voy a enviarle un archivo (desde /192.168.40.12:52554)
2025-11-23T18:41:07.988-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:07.998-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:07.998-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:08.003-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:08.004-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=ade6fccb-6727-4b76-891a-3ce57e5a3703 contenido='voy a enviarle un archivo'
2025-11-23T18:41:08.004-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=ade6fccb-6727-4b76-891a-3ce57e5a3703
2025-11-23T18:41:12.537-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|hola laura'
2025-11-23T18:41:12.537-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:41:12] Mensaje enviado por: manuel Para laura Contenido: hola laura
2025-11-23T18:41:12.543-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:41:12 Mensaje enviado por: manuel Para laura Contenido: hola laura (desde /192.168.40.12:49672)
2025-11-23T18:41:12.545-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:12.549-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:12.551-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:12.555-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:12.555-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=a182664a-c166-4966-b406-42dfcf973f95 contenido='hola laura'
2025-11-23T18:41:12.557-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=a182664a-c166-4966-b406-42dfcf973f95
2025-11-23T18:41:13.336-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|ok'
2025-11-23T18:41:13.336-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:41:13] Mensaje enviado por: manuel Para laura Contenido: ok
2025-11-23T18:41:13.336-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:41:13 Mensaje enviado por: manuel Para laura Contenido: ok (desde /192.168.40.12:49672)
2025-11-23T18:41:13.336-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:13.346-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:13.350-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:13.354-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:13.354-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=a182664a-c166-4966-b406-42dfcf973f95 contenido='ok'
2025-11-23T18:41:13.354-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=a182664a-c166-4966-b406-42dfcf973f95
2025-11-23T18:41:27.824-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR manuel|Tipos de mensaje avanzadas.txt|2038'
2025-11-23T18:41:27.824-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='manuel' filename='Tipos de mensaje avanzadas.txt' size='2038'
2025-11-23T18:41:27.824-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: Tipos de mensaje avanzadas.txt size=2038 desde /192.168.40.12:52554
2025-11-23T18:41:27.842-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA manuel|Tipos de mensaje avanzadas.txt|Ly8vLy8vLy8NCkFwbGljYWNpw7NuIGNsaWVudGUgc2Vydmlkb3IgcGFyYSBlbCBpbnRlcmNhbWJpbyBkZSBpbmZvcm1hY2nDs24gZW50cmUgdXN1YXJpb3MuIHB1ZWRlbiBpbnRlcmNhbWJpYXIgaW5mb3JtYWNpw7NuIGJhc2FkYSBlbiBtZW5zYWplcyBkZSB0ZXh0byB5IGFyY2hpdm9zICggdGV4dG8gbyBiaW5hcmlvICkNCkVsIHNlcnZpZG9yIHBvZHLDoSByZWNpYmlyIHZhcmlhcyBjb25leGlvbmVzIHNpbXVsdGFuZWFzIHBhcmEgZWwgcHJvY2VzYW1pZW50byBkZSBtZW5zYWplcywgZGViZXLDoW4gYXBsaWNhciBlbCBjb25jZXB0byBkZSBwcm9ncmFtYWNpw7NuIGNvbmN1cnJlbnRlIGNvbiBoaWxvcyBwYXJhIGdlc3Rpb25hciBsYXMgY29uZXhpb25lcw0KVG9kYSBsYSBpbmZvcm1hY2nDs24gZGVsIHNlcnZpZG9yIGRlYmUgc2VyIGFsbWFjZW5hZGEgZW4gbGEgYmFzZSBkZSBkYXRvcyByZWxhY2lvbmFsOyBlajogc3FsLCBPcmFjbGUNCkxvcyB1c3VhcmlvcyBzZSBkZWJlbiBjcmVhciBkZXNkZSBsYSBhcHAgZGUgY2xpZW50ZSwgcGVybyBzZSBhY2VwdGFuIGRlc2RlIGVsIHNlcnZpZG9yLCBzb2xvIHB1ZWRlbiBjb25lY3RhcnNlIGx1ZWdvIGRlIHNlciBhY2VwdGFkb3MNClVuIHVzdWFyaW8gcHVlZGUgdGVuZXIgbWFzIGRlIDEgY29uZXhpw7NuIGRlc2RlIG1hcyBkZSAxIGRpc3Bvc2l0aXZvDQpFbCBzZXJ2aWRvciBkZWJlIG1vc3RyYXIgcG9yIGNvbnNvbGEgdG9kYXMgbGFzIGFjY2lvbmVzIHF1ZSBzZSBlc3TDoW4gZWplY3V0YW5kbw0KRWwgc2Vydmlkb3IgbGltaXRhIGxhIGNhbnRpZGFkIGRlIGNvbmV4aW9uZXMgcG9yIHVzdWFyaW8NCkxhIGNvbmV4acOzbiBlbnRyZSBzZXJ2aWRvciBjbGllbnRlcyBzZSBoYWNlIGEgdHJhdsOpcyBkZSBwcm90b2NvbG8gdGNwIGlwDQpMb3MgdXN1YXJpb3MgcHVlZGVuIGRlc2NhcmdhciBsb3MgYXJjaGl2b3MgZW52aWFkb3MNCkxhIGFwbGljYWNpw7NuIGNsaWVudGUgaW1wbGVtZW50YXJhIGZvcm11bGFyaW9zIG1hZXN0cm8tZGV0YWxsZSBwYXJhIG1vc3RyYXIgbGEgaW5mb3JtYWNpw7NuIGFzb2NpYWRhIGFsIHVzdWFyaW8NCg0KVW5hIGFwbGljYWNpw7NuIHdlYiBtdmMgbXXDqXN0cmFsbyBzaWd1aWVudGUNCkxpc3RhZG8gZGUgdXN1YXJpb3MgcmVnaXN0cmFkb3MNCk1lbnNhamVzIGRlIGxvcyB1c3VhcmlvcywgY2xhc2lmaWNhZG9zIHBvciBlbCB0aXBvIGRlIG1lbnNhamUuIFZlciBkZXRhbGxlIGRlIG1lbnNhamUsIGluY2x1eWUgZGVzY2FyZ2FyIGFyY2hpdm9zLg0KTW9zdHJhciBsb3Mgc2lndWllbnRlcyBpbmZvcm1lcw0KVXN1YXJpbyBjb24gbWFzIG1lbnNhamVzIGVudmlhZG9zOiBtb3N0cmFyIGNhbnRpZGFkDQpBcmNoaXZvcyBlbnZpYWRvcywgbGlzdGFyIHBvciB0YW1hw7FvIHkgbW9zdHJhciBwcm9waWV0YXJpbw0KTGlzdGEgZGUgdXN1YXJpb3MgY29uZWN0YWRvcyB5IGluZm9ybWFjacOzbjogSXAsIGhvcmEgZGUgY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQpMaXN0YSBkZSB1c3VhcmlvcyBkZXNjb25lY3RhZG9zIHkgaW5mb3JtYWNpw7NuOiBJcCwgaG9yYSBkZSBjb25leGnDs24sIGhvcmEgZGUgZGVzY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQoNCg0KVW4gc2VydmljaW8gd2ViIGRlIGFwaSByZXN0IHBhcmEgbW9zdHJhciBsbyBzaWd1aWVudGU6DQpJbmZvcm1hY2nDs24gY29tcGxldGEgZGUgdXN1YXJpbzogTm9tYnJlLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcywgY2FudGlkYWQgZGUgbWVuc2FqZXMgcmVjaWJpZG9zLCBmZWNoYSB5IGhvcmEgZGUgdWx0aW1hIGNvbmV4acOzbiwgZXN0YWRvIChkZXNjb25lY3RhZG8vY29uZWN0YWRvKQ0KTGlzdGEgZGUgbWVuc2FqZXMgZW52aWFkb3MgKElwIHVzdWFyaW8saXAgdXN1YXJpbyByZW1vdG8sZmVjaGEsaG9yYSkNCkxpc3RhIGRlIG1lbnNhamVzIHJlY2liaWRvcyAoSXAgdXN1YXJpbyxpcCB1c3VhcmlvIHJlbW90byxmZWNoYSxob3JhKQ=='
2025-11-23T18:41:27.853-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: laura -> manuel : Tipos de mensaje avanzadas.txt (2038 bytes)
2025-11-23T18:41:27.860-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763941287853_laura_Tipos de mensaje avanzadas.txt
2025-11-23T18:41:27.865-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:27.869-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:27.889-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'Tipos de mensaje avanzadas.txt' using columns nombre / ruta, id=1
2025-11-23T18:41:27.889-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:27.902-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:27.902-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=2 receptorId=1 archivoId=1
2025-11-23T18:41:27.902-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=ARCHIVO, sesionId=null
2025-11-23T18:41:38.573-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Usuario 'hector' desconectado.
2025-11-23T18:41:38.574-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario hector desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:41:38.575-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:42:31.130-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T18:42:31.131-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:42:31.132-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:42:33.113-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:60857
2025-11-23T18:42:33.117-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:60857
2025-11-23T18:42:36.423-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:60857
2025-11-23T18:42:36.423-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:60857
2025-11-23T18:42:36.423-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:60857
2025-11-23T18:42:36.425-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:60857 conectado y saludado.
2025-11-23T18:42:36.426-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:60857
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:60857
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:42:36.433-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:42:36.435-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:42:36.461-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=68e02855-dbd2-421c-a20b-871a769af289
2025-11-23T18:42:36.462-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:42:36.465-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:42:36.469-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T18:42:36.532-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T18:44:17.437-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T18:44:17.438-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:44:17.439-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T18:44:19.054-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:60194
2025-11-23T18:44:19.060-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:60194
2025-11-23T18:44:21.772-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: RECHAZADA para /192.168.40.12:60194
2025-11-23T18:44:21.773-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión rechazada desde /192.168.40.12:60194
2025-11-23T18:44:21.773-05:00  WARN 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión rechazada manualmente desde /192.168.40.12:60194
2025-11-23T18:44:23.619-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:51925
2025-11-23T18:44:23.624-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:51925
2025-11-23T18:44:25.880-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:51925
2025-11-23T18:44:25.880-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:51925
2025-11-23T18:44:25.880-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:51925
2025-11-23T18:44:25.882-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:51925 conectado y saludado.
2025-11-23T18:44:25.882-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|laura|1234'
2025-11-23T18:44:25.886-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura' id=2
2025-11-23T18:44:25.886-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='laura' id=2 desde /192.168.40.12:51925
2025-11-23T18:44:25.887-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura (id=2) desde /192.168.40.12:51925
2025-11-23T18:44:25.888-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T18:44:25.890-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:44:25.892-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:44:25.898-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:44:25.921-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario laura id=3197853d-22b6-433f-9dc7-63cb0019aeb9
2025-11-23T18:44:25.921-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:44:25.924-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:44:25.927-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a laura
2025-11-23T18:44:25.953-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T19:04:24.637-05:00 ERROR 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:51925: java.net.SocketException: Connection reset
2025-11-23T19:04:24.639-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T19:04:24.639-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T19:04:24.639-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T19:04:26.981-05:00 ERROR 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:60857: java.net.SocketException: Connection reset
2025-11-23T19:04:26.982-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T19:04:26.982-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T19:04:26.983-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T19:59:47.097-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 16044 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T19:59:47.097-05:00 DEBUG 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T19:59:47.097-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T19:59:48.836-05:00  INFO 16044 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T19:59:48.853-05:00  INFO 16044 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T19:59:48.853-05:00  INFO 16044 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T19:59:48.930-05:00  INFO 16044 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T19:59:48.931-05:00  INFO 16044 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1760 ms
2025-11-23T19:59:49.091-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-23T19:59:49.132-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-23T19:59:49.132-05:00  INFO 16044 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T19:59:49.535-05:00  INFO 16044 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4ed9f7b1
2025-11-23T19:59:49.546-05:00  INFO 16044 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T19:59:49.598-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-23T19:59:49.663-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T19:59:49.769-05:00  INFO 16044 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T19:59:50.187-05:00  INFO 16044 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T19:59:50.197-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.93 seconds (process running for 4.593)
2025-11-23T19:59:50.197-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T19:59:50.197-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T19:59:50.212-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T19:59:50.264-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T19:59:50.653-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T19:59:50.653-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T19:59:50.653-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T19:59:50.660-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T19:59:50.660-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T19:59:50.660-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T19:59:50.693-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T19:59:50.697-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T19:59:50.699-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T20:00:12.608-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64099
2025-11-23T20:00:12.620-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64099
2025-11-23T20:00:14.962-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64099
2025-11-23T20:00:14.962-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64099
2025-11-23T20:00:14.962-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64099
2025-11-23T20:00:14.990-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64099 conectado y saludado.
2025-11-23T20:00:14.994-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T20:00:15.030-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T20:00:15.032-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:64099
2025-11-23T20:00:15.034-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:64099
2025-11-23T20:00:15.034-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T20:00:15.038-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T20:00:15.040-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T20:00:15.046-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T20:00:15.080-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=98ae76ca-62a9-4a1a-8c89-1b7fe806c8a9
2025-11-23T20:00:15.080-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T20:00:15.093-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T20:00:15.100-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T20:00:15.185-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T20:00:35.117-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T20:00:35.118-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T20:00:35.120-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T20:02:56.927-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49772
2025-11-23T20:02:56.933-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49772
2025-11-23T20:02:59.059-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49772
2025-11-23T20:02:59.061-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49772
2025-11-23T20:02:59.061-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49772
2025-11-23T20:02:59.065-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49772 conectado y saludado.
2025-11-23T20:02:59.065-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T20:02:59.083-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T20:02:59.085-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:49772
2025-11-23T20:02:59.087-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:49772
2025-11-23T20:02:59.094-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T20:02:59.096-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T20:02:59.098-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T20:02:59.102-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T20:02:59.115-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=a87518e8-7bc8-4f9a-a742-2d8d78aca148
2025-11-23T20:02:59.115-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T20:02:59.121-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T20:02:59.125-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T20:02:59.174-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T20:06:20.835-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
