2025-11-23T14:56:33.973-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 6648 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T14:56:33.989-05:00 DEBUG 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T14:56:33.995-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T14:56:35.913-05:00  INFO 6648 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T14:56:35.931-05:00  INFO 6648 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T14:56:35.931-05:00  INFO 6648 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T14:56:36.029-05:00  INFO 6648 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T14:56:36.029-05:00  INFO 6648 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1955 ms
2025-11-23T14:56:36.205-05:00  INFO 6648 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T14:56:36.721-05:00  INFO 6648 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@47f04e4d
2025-11-23T14:56:36.729-05:00  INFO 6648 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T14:56:36.859-05:00 DEBUG 6648 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T14:56:36.959-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T14:56:37.071-05:00  INFO 6648 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T14:56:37.553-05:00  INFO 6648 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T14:56:37.561-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.345 seconds (process running for 4.801)
2025-11-23T14:56:37.569-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T14:56:37.569-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T14:56:37.582-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T14:56:37.674-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T14:56:38.107-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T14:56:38.107-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T14:56:38.107-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T14:56:38.107-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T14:56:38.110-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T14:56:38.110-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T14:56:38.123-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T14:56:38.123-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T14:56:38.132-05:00  INFO 6648 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T14:56:57.966-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53635
2025-11-23T14:56:57.974-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53635
2025-11-23T14:57:00.199-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53635
2025-11-23T14:57:00.199-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53635
2025-11-23T14:57:00.199-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53635
2025-11-23T14:57:00.225-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53635 conectado y saludado.
2025-11-23T14:57:00.233-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T14:57:00.241-05:00  WARN 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:53635
2025-11-23T14:57:00.241-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:53635
2025-11-23T14:57:07.731-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T14:57:07.739-05:00  WARN 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:53635
2025-11-23T14:57:07.741-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:53635
2025-11-23T14:57:24.625-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T14:57:24.630-05:00  WARN 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:53635
2025-11-23T14:57:24.630-05:00  INFO 6648 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:53635
2025-11-23T14:58:35.477-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:52927
2025-11-23T14:58:35.477-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:52927
2025-11-23T14:58:39.623-05:00  INFO 6648 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:52927
2025-11-23T14:58:39.623-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:52927
2025-11-23T14:58:39.623-05:00  INFO 6648 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:52927
2025-11-23T14:58:39.628-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:52927 conectado y saludado.
2025-11-23T14:58:39.630-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T14:58:39.633-05:00  WARN 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:52927
2025-11-23T14:58:39.635-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:52927
2025-11-23T14:58:50.092-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T14:58:50.100-05:00  WARN 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='laura' desde /192.168.40.12:52927
2025-11-23T14:58:50.100-05:00  INFO 6648 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: laura desde /192.168.40.12:52927
2025-11-23T15:06:09.003-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 15960 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:06:09.012-05:00 DEBUG 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:06:09.014-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:06:11.384-05:00  INFO 15960 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:06:11.408-05:00  INFO 15960 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:06:11.408-05:00  INFO 15960 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:06:11.504-05:00  INFO 15960 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:06:11.504-05:00  INFO 15960 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2427 ms
2025-11-23T15:06:11.701-05:00  INFO 15960 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:06:12.381-05:00  INFO 15960 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4d157493
2025-11-23T15:06:12.389-05:00  INFO 15960 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:06:12.567-05:00 DEBUG 15960 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:06:12.656-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:06:12.772-05:00  INFO 15960 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:06:13.346-05:00  INFO 15960 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:06:13.354-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.073 seconds (process running for 5.551)
2025-11-23T15:06:13.354-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:06:13.362-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:06:13.372-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:06:13.468-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:06:13.840-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:06:13.842-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:06:13.844-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:06:13.846-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:06:13.846-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:06:13.854-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:06:13.862-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:06:13.862-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:06:13.868-05:00  INFO 15960 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:06:20.444-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54344
2025-11-23T15:06:20.457-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54344
2025-11-23T15:06:22.941-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54344
2025-11-23T15:06:22.943-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54344
2025-11-23T15:06:22.943-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54344
2025-11-23T15:06:22.981-05:00  INFO 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54344 conectado y saludado.
2025-11-23T15:06:22.983-05:00  INFO 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:06:23.006-05:00  WARN 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: manuel
2025-11-23T15:06:23.006-05:00  WARN 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:54344
2025-11-23T15:06:23.010-05:00  INFO 15960 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:54344
2025-11-23T15:06:32.782-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63995
2025-11-23T15:06:32.794-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63995
2025-11-23T15:06:34.141-05:00  INFO 15960 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63995
2025-11-23T15:06:34.141-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63995
2025-11-23T15:06:34.141-05:00  INFO 15960 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63995
2025-11-23T15:06:34.152-05:00  INFO 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63995 conectado y saludado.
2025-11-23T15:06:34.152-05:00  INFO 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:06:34.165-05:00  WARN 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: laura
2025-11-23T15:06:34.165-05:00  WARN 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='laura' desde /192.168.40.12:63995
2025-11-23T15:06:34.165-05:00  INFO 15960 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: laura desde /192.168.40.12:63995
2025-11-23T15:08:45.758-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 2020 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:08:45.763-05:00 DEBUG 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:08:45.765-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:08:48.157-05:00  INFO 2020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:08:48.187-05:00  INFO 2020 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:08:48.187-05:00  INFO 2020 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:08:48.324-05:00  INFO 2020 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:08:48.324-05:00  INFO 2020 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2476 ms
2025-11-23T15:08:48.562-05:00  INFO 2020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:08:49.099-05:00  INFO 2020 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@37348491
2025-11-23T15:08:49.108-05:00  INFO 2020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:08:49.296-05:00 DEBUG 2020 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:08:49.453-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:08:49.606-05:00  INFO 2020 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:08:50.267-05:00  INFO 2020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:08:50.282-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.269 seconds (process running for 5.795)
2025-11-23T15:08:50.285-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:08:50.285-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:08:50.304-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:08:50.385-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:08:50.693-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:08:50.696-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:08:50.704-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:08:50.704-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:08:50.713-05:00  INFO 2020 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:08:54.898-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61636
2025-11-23T15:08:54.906-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61636
2025-11-23T15:08:56.739-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61636
2025-11-23T15:08:56.742-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61636
2025-11-23T15:08:56.742-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61636
2025-11-23T15:08:56.760-05:00  INFO 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61636 conectado y saludado.
2025-11-23T15:08:56.764-05:00  INFO 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:08:56.773-05:00 DEBUG 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel'
2025-11-23T15:08:56.785-05:00  WARN 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='manuel' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:08:56.785-05:00  WARN 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: manuel
2025-11-23T15:08:56.785-05:00  WARN 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:61636
2025-11-23T15:08:56.785-05:00  INFO 2020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:61636
2025-11-23T15:09:01.735-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61491
2025-11-23T15:09:01.739-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61491
2025-11-23T15:09:03.151-05:00  INFO 2020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61491
2025-11-23T15:09:03.151-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61491
2025-11-23T15:09:03.151-05:00  INFO 2020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61491
2025-11-23T15:09:03.151-05:00  INFO 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61491 conectado y saludado.
2025-11-23T15:09:03.157-05:00  INFO 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:09:03.159-05:00 DEBUG 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura'
2025-11-23T15:09:03.166-05:00  WARN 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='laura' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:09:03.168-05:00  WARN 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: laura
2025-11-23T15:09:03.168-05:00  WARN 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='laura' desde /192.168.40.12:61491
2025-11-23T15:09:03.169-05:00  INFO 2020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: laura desde /192.168.40.12:61491
2025-11-23T15:10:27.746-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 24.0.2 with PID 18272 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo)
2025-11-23T15:10:27.750-05:00 DEBUG 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:10:27.751-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:10:29.378-05:00  INFO 18272 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:10:29.409-05:00  INFO 18272 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:10:29.411-05:00  INFO 18272 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:10:29.513-05:00  INFO 18272 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:10:29.514-05:00  INFO 18272 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1693 ms
2025-11-23T15:10:29.707-05:00  INFO 18272 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:10:30.333-05:00  INFO 18272 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@56e9a474
2025-11-23T15:10:30.335-05:00  INFO 18272 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:10:30.424-05:00 DEBUG 18272 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:10:30.499-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:10:30.576-05:00  INFO 18272 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:10:30.923-05:00  INFO 18272 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:10:30.929-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.773 seconds (process running for 4.123)
2025-11-23T15:10:30.933-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:10:30.934-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:10:30.949-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:10:31.063-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:10:31.501-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:10:31.501-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:10:31.501-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:10:31.502-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:10:31.503-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:10:31.503-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:10:31.513-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:10:31.518-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:10:31.521-05:00  INFO 18272 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:10:41.344-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53111
2025-11-23T15:10:41.356-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53111
2025-11-23T15:10:43.341-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53111
2025-11-23T15:10:43.343-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53111
2025-11-23T15:10:43.345-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53111
2025-11-23T15:10:43.387-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53111 conectado y saludado.
2025-11-23T15:10:43.389-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:10:43.394-05:00 DEBUG 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura'
2025-11-23T15:10:43.408-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='laura' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:10:43.408-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: laura
2025-11-23T15:10:43.409-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='laura' desde /192.168.40.12:53111
2025-11-23T15:10:43.411-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: laura desde /192.168.40.12:53111
2025-11-23T15:10:49.593-05:00 ERROR 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:53111: java.net.SocketException: Connection reset
2025-11-23T15:10:49.593-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53111 desconectado sin autenticarse.
2025-11-23T15:11:25.113-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53434
2025-11-23T15:11:25.119-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53434
2025-11-23T15:11:29.096-05:00  INFO 18272 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53434
2025-11-23T15:11:29.097-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53434
2025-11-23T15:11:29.098-05:00  INFO 18272 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53434
2025-11-23T15:11:29.102-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53434 conectado y saludado.
2025-11-23T15:11:29.109-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:11:29.115-05:00 DEBUG 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel'
2025-11-23T15:11:29.123-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='manuel' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:11:29.129-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: manuel
2025-11-23T15:11:29.138-05:00  WARN 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:53434
2025-11-23T15:11:29.139-05:00  INFO 18272 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:53434
2025-11-23T15:12:29.509-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 24.0.2 with PID 17004 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo)
2025-11-23T15:12:29.512-05:00 DEBUG 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:12:29.513-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:12:30.865-05:00  INFO 17004 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:12:30.879-05:00  INFO 17004 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:12:30.880-05:00  INFO 17004 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:12:30.935-05:00  INFO 17004 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:12:30.936-05:00  INFO 17004 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1350 ms
2025-11-23T15:12:31.050-05:00  INFO 17004 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:12:31.449-05:00  INFO 17004 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@506aabf6
2025-11-23T15:12:31.452-05:00  INFO 17004 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:12:31.565-05:00 DEBUG 17004 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:12:31.663-05:00  INFO 17004 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:12:31.740-05:00  INFO 17004 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:12:32.034-05:00  INFO 17004 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:12:32.041-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.209 seconds (process running for 3.617)
2025-11-23T15:12:32.044-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:12:32.045-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:12:32.053-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:12:32.108-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:12:32.401-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:12:32.402-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:12:32.403-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:12:32.404-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:12:32.405-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:12:32.406-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:12:32.415-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:12:32.415-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:12:32.419-05:00  INFO 17004 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:12:57.888-05:00  INFO 17004 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59607
2025-11-23T15:12:57.895-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59607
2025-11-23T15:13:08.120-05:00  INFO 17004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59607
2025-11-23T15:13:08.122-05:00  INFO 17004 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59607
2025-11-23T15:13:08.126-05:00  INFO 17004 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59607
2025-11-23T15:13:08.144-05:00  INFO 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59607 conectado y saludado.
2025-11-23T15:13:08.145-05:00  INFO 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:13:08.152-05:00 DEBUG 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel'
2025-11-23T15:13:08.177-05:00  WARN 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='manuel' - PreparedStatementCallback; bad SQL grammar [SELECT id, nombre, contrasena_hash FROM usuarios WHERE nombre = ?]
2025-11-23T15:13:08.178-05:00  WARN 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para usuario desconocido: manuel
2025-11-23T15:13:08.179-05:00  WARN 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='manuel' desde /192.168.40.12:59607
2025-11-23T15:13:08.181-05:00  INFO 17004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: manuel desde /192.168.40.12:59607
2025-11-23T15:15:24.462-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 11420 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:15:24.470-05:00 DEBUG 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:15:24.470-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:15:26.273-05:00  INFO 11420 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:15:26.281-05:00  INFO 11420 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:15:26.281-05:00  INFO 11420 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:15:26.371-05:00  INFO 11420 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:15:26.372-05:00  INFO 11420 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1831 ms
2025-11-23T15:15:26.545-05:00  INFO 11420 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:15:26.992-05:00  INFO 11420 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5be052ca
2025-11-23T15:15:27.001-05:00  INFO 11420 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:15:27.141-05:00 DEBUG 11420 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:15:27.221-05:00  INFO 11420 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:15:27.323-05:00  INFO 11420 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:15:27.759-05:00  INFO 11420 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:15:27.767-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.916 seconds (process running for 4.384)
2025-11-23T15:15:27.772-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:15:27.775-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:15:27.783-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:15:27.841-05:00  INFO 11420 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:15:28.112-05:00  INFO 11420 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:15:28.112-05:00  INFO 11420 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:15:28.120-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:15:28.120-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:15:28.120-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:15:28.120-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:15:28.128-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:15:28.128-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:15:28.136-05:00  INFO 11420 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:15:31.185-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 8020 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:15:31.185-05:00 DEBUG 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:15:31.185-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:15:33.022-05:00  INFO 8020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:15:33.030-05:00  INFO 8020 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:15:33.030-05:00  INFO 8020 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:15:33.104-05:00  INFO 8020 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:15:33.104-05:00  INFO 8020 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1843 ms
2025-11-23T15:15:33.284-05:00  INFO 8020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:15:33.695-05:00  INFO 8020 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1da4b3f9
2025-11-23T15:15:33.701-05:00  INFO 8020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:15:33.837-05:00 DEBUG 8020 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:15:33.908-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:15:34.024-05:00  INFO 8020 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:15:34.524-05:00  INFO 8020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:15:34.550-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.128 seconds (process running for 4.667)
2025-11-23T15:15:34.557-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:15:34.559-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:15:34.587-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:15:34.671-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:15:35.082-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:15:35.086-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:15:35.086-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:15:35.086-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:15:35.089-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:15:35.089-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:15:35.102-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:15:35.102-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:15:35.115-05:00  INFO 8020 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:15:44.920-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:56651
2025-11-23T15:15:44.924-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:56651
2025-11-23T15:15:47.258-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:56651
2025-11-23T15:15:47.260-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:56651
2025-11-23T15:15:47.260-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:56651
2025-11-23T15:15:47.275-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:56651 conectado y saludado.
2025-11-23T15:15:47.275-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:15:47.302-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:15:47.306-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:15:47.314-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:56651
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:56651
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:15:47.314-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:15:47.314-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:15:47.324-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:15:47.338-05:00  WARN 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:16:09.264-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:60550
2025-11-23T15:16:09.273-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:60550
2025-11-23T15:16:12.653-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:60550
2025-11-23T15:16:12.655-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:60550
2025-11-23T15:16:12.656-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:60550
2025-11-23T15:16:12.659-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:60550 conectado y saludado.
2025-11-23T15:16:12.662-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:16:12.678-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:16:12.683-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:16:12.685-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:16:12.687-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:16:12.688-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:60550
2025-11-23T15:16:12.689-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:60550
2025-11-23T15:16:12.690-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:16:12.690-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:16:12.692-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:16:12.698-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:16:12.706-05:00  WARN 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:16:24.707-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|manuel, le voy a enviar un archivo'
2025-11-23T15:16:24.709-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 15:16:24] Mensaje enviado por: laura Para manuel Contenido: manuel, le voy a enviar un archivo
2025-11-23T15:16:24.722-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 15:16:24 Mensaje enviado por: laura Para manuel Contenido: manuel, le voy a enviar un archivo (desde /192.168.40.12:60550)
2025-11-23T15:16:24.733-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:16:24.739-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:16:24.740-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:16:24.744-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:16:24.747-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='manuel, le voy a enviar un archivo'
2025-11-23T15:16:24.754-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T15:16:24.766-05:00 ERROR 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Error inserting message into DB (emisorId=2, receptorId=1, sesionId=null)

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:103) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcMessageDao.insertMessage(JdbcMessageDao.java:129) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleMessage(ClientWorker.java:658) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:82) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'tipo' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:121) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1061) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1009) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1320) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:994) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-23T15:16:39.072-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR manuel|1020-1030.txt|2876'
2025-11-23T15:16:39.074-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='manuel' filename='1020-1030.txt' size='2876'
2025-11-23T15:16:39.077-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: 1020-1030.txt size=2876 desde /192.168.40.12:60550
2025-11-23T15:16:39.107-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA manuel|1020-1030.txt|RW1wcmVzYXMgaW50ZWxpZ2VudGVzOiBldm9sdWNpw7NuIHkgY3JlY2ltaWVudG8gZW4gdGllbXBvcyBkZSBsYSBJQQ0KTGFzIGVtcHJlc2FzIG5vIGRlYmVuIHRlbmVybGUgbWllZG8gYSB1c2FyIGxhIGlhLCBkZWJlbiBpbnRlZ3JhcmxhIHJlc3BvbnNhYmxlbWVudGUgYSBzdXMgb3BlcmFjaW9uZXMgeSBjYXBhY2l0YXIgYSBzdXMgZW1wbGVhZG9zIGFjZXJjYSBkZSByaWVzZ29zIHkgYmVuZWZpY2lvcw0KDQpDdWx0dXJhIEFuYWzDrXRpY2E6IMK/Q8OzbW8gbm8gZGVtb2NyYXRpemFyIGVsIHVzbyBkZSBsb3MgZGF0b3MgZW4gb3JnYW5pemFjaW9uZXMgcMO6YmxpY2FzIHkgcHJpdmFkYXM/DQpUZW5lciBjdWlkYWRvIGNvbiBsb3MgZGF0b3Mgc2Vuc2libGVzIHF1ZSB0aWVuZW4gbG9zIGFnZW50ZXMsIGxhcyBlbXByZXNhcyBwdWVkZW4gdGVuZXIgYWdlbnRlcyBjZW50cmFsaXphZG9zIHByaXZhZG9zDQpDSU8gZXMgbMOtZGVyIGRlIGFuYWzDrXRpY2EsIG11Y2hhcyByZXNwb25zYWJpbGlkYWRlcw0KTWVkaWNpw7NuIGRlIGRhdG9zLCBnb2Jlcm5hbnphIGRlIGRhdG9zDQpBbmFsaXRpY2EgZGUgSUEgZW4gb3JncmFuaXphY2lvbmVzDQpTYW50aWFnbyBSZXN0cmVwbyBEaXJlY3RvciBEYXRhIHkgZXN0cmF0ZWdpYSBkZSBwdW50b3MgQ29sb21iaWENCkFuZHJlcyBDYXN0ZWxsYW5vcyBIZWFkIG9mIERhdGEgJiBBcnRpZmljaWFsIEludGVsbGlnZW5jZSBkZSBWbGFtZXJpY2FzIENvcnANCk5vcm1hIEVzcGlub3NhIERpcmVjdG9yIERhdG9zICYgQW5hbGl0aWNhIGRlIEdlbnRlcmENCkFuZHJlcyBCYXJyYW50ZXMgVlAgR2xvYmFsIEFXUyBQcmFjdGljZSBIZWFkIG9mIEJsZW5kDQoNCjExOjMwLTEyOjIwDQpBeXVkYXJzZSBkZSBsYSBJQSBwYXJhIHRlbmVyIHZlbnRhamEgY29tcGV0aXRpdmEsIG5vIGVzIGRlbWFzaWFkbyBjb21wbGVqbyBkZSB1c2FyIHkgcmVudGEgbXVjaG8gYXByZW5lciBhIG1hbmVqYXJsYSBwb3IgbGFzIGdhbmFuY2lhcyBxdWUgcHVlZGUgYnJpbmRhcg0KQmFzZXMgZGUgZGF0b3Mgb2x0cCBNaWNyb3NvZnQgeSBhenVyZSBvZnJlY2VuIGNhZGEgdW5vIHVuIG1vdG9yIGRiIGNvbiB0b2RvIHVuIHByb2R1Y3RvIGRlICwgQ29zbW9zIG9mcmVjZSB1bm8gTm8gT3NxbCwgbm90IG9ubHkNClNlIHF1aWVyZSB2ZXIgaW5mbyBlbiB0aWVtcG8gcmVhbCwgbm8gZXNwZXJhciBhIGxhIEVUTA0KT3BlcmFjaW9uZXMgdHJhbnNhY2Npb25hbGVzIHkgYW5hbGl0aWNhcyBlbiB1bmEgc29sYSBwZXRpY2lvbg0KDQpSdXRhIHBhcmEgZGVzYXJyb2xsbyBkZSBhcHAgZGUgaWEgYWxpbWVudGFkYSBjb24gZGF0YSBkZSBsYSBlbXByZXNhDQoxLiBlc3RhYmxlY2VyIHJlcG9zaXRvcmlvIGNlbnRyYXINCjIuIHByZXBhcmFyIGRhdGEgcGFyYSBpbm5vdmFjaW9uIGRlIGlhDQozLiBDcmVhciBwbGF0YWZvcm1hIHVuaWZpY2FkYSBkZSBpYQ0KNC4gY29uc3RydWlyIGV4cGVyaWVuY2lhcyBkZSBpYSBjb24gbGEgcHJvcGlhIGRhdGEgZGUgbGEgZW1wcmVzYQ0KDQpMYSBhY3R1YWxpZGFkIHNvbiBsb3MgYWdlbnRlcywgZWwgZnV0dXJvIGFnZW50ZXMgcXVlIGNvbnN1bHRhbiBhIGFnZW50ZXMgY29tbyBvcnF1ZXN0YSBtdXNpY2FsLiBTZSBkZWJlIHRlbmVyIGVuIGN1ZW50YSBjdWFuZG8geSBjb21vIHVuIGFnZW50ZSBlcyBtZWpvciBxdWUgb3RybywgcGFyYSBwb2RlciBlbGVnaXIgYmllbi4gTWljcm9zb2Z0IHBlcm1pdGUgdW5hIGdyYW4gdmFyaWVkYWQgZGUgb3BjaW9uZXMgcGFyYSB0ZW5lciBlbCBtZWpvciBkZXNlbXBlw7FvDQpNaWNyb3NvZnQgZmFicmljIHkgQXp1cmUgQUkgRm91bmRyeSBwZXJtaXRlbiBjcmVhciBhZ2VudGVzDQpFc3RvcyBhZ2VudGVzIHNlIHB1ZWRlbiBjb25zdW1pciBwb3Igb3Ryb3MgdXN1YXJpb3MsIGludGVybm9zIG8gZXh0ZXJub3MgYSBsYSBlbXByZXNhDQoNCg0KQ29uc3RydXllbmRvIEVxdWlwb3MgZGUgRGF0b3MgZW4gTEFUQU06IEF0cmFjY2nDs24sIFJldGVuY2nDs24geSBVcHNraWxsaW5nIHluIElBDQoNCkVtcHJlc2FzIG9mcmVjZW4gZmxleGliaWxpYWRlcyBsYWJvcmFsZXMgZW4gZXN0b3MgY2FtcG9zLCBsYXMgcGVyc29uYXMgc2UgdmFuIHBvciBjcmVjaW1pZW50byBwZXJzb25hbCB5IG1lam9yZXMgb2ZlcnRhcywgaGF5IHF1ZSBoYWNlciBjcmVjZXIgYSBsYXMgcGVyc29uYXMgZGVzZGUgbGFzIGVtcHJlc2FzDQpsYXMgcGVyc29uYXMgZGViZW4gc2VudGlyc2UgcGFydGUgZGUgbG9zIHByb3llY3RvcyBwYXJhIGV2aXRhciByb3RhY2lvbiBkZSBwZXJzb25hbCwgbGEgYWRhcHRhY2lvbiBhbnRlIGxvcyBjYW1iaW9zIGVzIGRpZmljaWwNCg0KU2UgbmVjZXNpdGFuIHByb2Zlc2lvbmFsZXMgZGUgZGF0b3MgZGFkbyBlbCBjcmVjaW1pZW50byBkZWwgbWVyY2FkbywgaGF5IG11Y2hvcyBlY29ub21pc3RhcywgZXN0YWRpc3RpY29zIG8gaW5nIGRlIHNpc3RlbWFzLCBwZXJvIG5vIHByb2Zlc2lvbmFsZXMgZGUgZGF0b3MNCg0KU2UgbWlkZSBtdWNobyBsYSBwcm9kdWN0aXZpZGFkIGRlIGxvcyByZXN1bHRhZG9zLCBwb2NvIGVsIGNyZWNpbWllbnRvIGRlIHBlcnNvbmFzDQpTZSBkZWJlIGNvbnN0cnVpciBlbCB0YWxlbnRvIGRlc2RlIG9yZ2FuaXphY2lvbmVzLCBsYSBpYSBwdWVkZSBzZXIgaGVycmFtaWVudGEgcGVybyBubyByZWVtcGxhem8sIGVsIHRhbGVudG8gaHVtYW5vIGRlYmUgc2VndWlyIHNpZW5kbyBsYSBhcHVlc3RhIGRlIGxhcyBlbXByZXNhcywgZGUgbGEgbWFubyBjb24gaWENCk5vIHRvZGFzIGxhcyBwbGF0YWZvcm1hcyBkZWJlbiBzZXIgdGFuIGdyYW5kZXMgbyBwZXF1ZcOxYXMgY29tbyBsYXMgbWFzIGZhbW9zYXMsIHNlIGRlYmUgYnVzY2FyIGZ1bmNpb25hbGlkYWQgbm8gaW1hZ2VuIGRlIHBvZGVyDQo='
2025-11-23T15:16:39.123-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: laura -> manuel : 1020-1030.txt (2876 bytes)
2025-11-23T15:16:39.165-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763928999157_laura_1020-1030.txt
2025-11-23T15:16:39.167-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:16:39.173-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:16:39.201-05:00 ERROR 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo persistir archivo/mensaje en BD

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:103) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcArchivoDao.insertArchivo(JdbcArchivoDao.java:42) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleFileData(ClientWorker.java:433) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:97) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'nombre' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:121) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:916) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1061) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1009) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1320) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:994) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-23T15:17:39.380-05:00 ERROR 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:56651: java.net.SocketException: Connection reset
2025-11-23T15:17:39.380-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T15:17:39.380-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:17:39.380-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T15:17:55.434-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:57973
2025-11-23T15:17:55.440-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:57973
2025-11-23T15:17:58.175-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:57973
2025-11-23T15:17:58.175-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:57973
2025-11-23T15:17:58.184-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:57973
2025-11-23T15:17:58.218-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:57973 conectado y saludado.
2025-11-23T15:17:58.219-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:17:58.227-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:17:58.245-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:17:58.249-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:17:58.253-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:17:58.255-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:57973
2025-11-23T15:17:58.257-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:57973
2025-11-23T15:17:58.263-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:17:58.271-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:17:58.281-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:17:58.285-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:17:58.299-05:00  WARN 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:25:27.484-05:00 ERROR 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:60550: java.net.SocketException: Connection reset
2025-11-23T15:25:27.485-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T15:25:27.486-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:25:27.486-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:25:32.456-05:00 ERROR 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:57973: java.net.SocketException: Connection reset
2025-11-23T15:25:32.456-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T15:25:32.457-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:25:32.458-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T15:25:47.986-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:65519
2025-11-23T15:25:47.994-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:65519
2025-11-23T15:25:50.434-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:65519
2025-11-23T15:25:50.434-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:65519
2025-11-23T15:25:50.444-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:65519
2025-11-23T15:25:50.458-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:65519 conectado y saludado.
2025-11-23T15:25:50.505-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:25:50.507-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:25:50.512-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:25:50.517-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:25:50.519-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:25:50.521-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:65519
2025-11-23T15:25:50.521-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:65519
2025-11-23T15:25:50.555-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:25:50.562-05:00  INFO 8020 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:25:50.577-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:25:50.584-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:25:50.590-05:00  WARN 8020 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:25:59.038-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:60290
2025-11-23T15:25:59.045-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:60290
2025-11-23T15:26:01.784-05:00  INFO 8020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:60290
2025-11-23T15:26:01.788-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:60290
2025-11-23T15:26:01.838-05:00  INFO 8020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:60290
2025-11-23T15:26:01.842-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:60290 conectado y saludado.
2025-11-23T15:26:01.844-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:26:01.846-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:26:01.853-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:26:01.859-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:26:01.863-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:26:01.865-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:60290
2025-11-23T15:26:01.867-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:60290
2025-11-23T15:26:01.869-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:26:01.869-05:00  INFO 8020 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:26:01.869-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:26:01.889-05:00 DEBUG 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:26:01.906-05:00  WARN 8020 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:38:28.545-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 1084 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:38:28.548-05:00 DEBUG 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:38:28.550-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:38:30.577-05:00  INFO 1084 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:38:30.599-05:00  INFO 1084 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:38:30.599-05:00  INFO 1084 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:38:30.707-05:00  INFO 1084 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:38:30.707-05:00  INFO 1084 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2073 ms
2025-11-23T15:38:30.929-05:00  INFO 1084 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:38:31.572-05:00  INFO 1084 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@46e190ed
2025-11-23T15:38:31.572-05:00  INFO 1084 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:38:31.737-05:00 DEBUG 1084 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:38:31.852-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:38:31.993-05:00  INFO 1084 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:38:32.606-05:00  INFO 1084 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:38:32.606-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.11 seconds (process running for 5.777)
2025-11-23T15:38:32.625-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:38:32.626-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:38:32.650-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:38:32.729-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:38:33.422-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:38:33.422-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:38:33.424-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:38:33.426-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:38:33.426-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:38:33.428-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:38:33.444-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:38:33.446-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:38:33.450-05:00  INFO 1084 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:38:47.174-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53847
2025-11-23T15:38:47.181-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53847
2025-11-23T15:38:49.138-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53847
2025-11-23T15:38:49.138-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53847
2025-11-23T15:38:49.138-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53847
2025-11-23T15:38:49.164-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53847 conectado y saludado.
2025-11-23T15:38:49.166-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:38:49.178-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:38:49.190-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:38:49.196-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:53847
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:53847
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:38:49.196-05:00  INFO 1084 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:38:49.196-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:38:49.205-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:38:49.214-05:00  WARN 1084 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:38:55.358-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:51356
2025-11-23T15:38:55.368-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:51356
2025-11-23T15:38:59.672-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:51356
2025-11-23T15:38:59.672-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:51356
2025-11-23T15:38:59.674-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:51356
2025-11-23T15:38:59.685-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:51356 conectado y saludado.
2025-11-23T15:38:59.711-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:38:59.713-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:38:59.720-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:38:59.721-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:38:59.724-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:38:59.726-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:51356
2025-11-23T15:38:59.728-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:51356
2025-11-23T15:38:59.732-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:38:59.734-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:38:59.736-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:38:59.748-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:38:59.754-05:00  WARN 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:39:48.450-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T15:39:48.452-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:39:48.454-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:39:50.148-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64263
2025-11-23T15:39:50.172-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64263
2025-11-23T15:39:53.499-05:00  INFO 1084 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64263
2025-11-23T15:39:53.504-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64263
2025-11-23T15:39:53.506-05:00  INFO 1084 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64263
2025-11-23T15:39:53.508-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64263 conectado y saludado.
2025-11-23T15:39:53.523-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:39:53.523-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:39:53.535-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:39:53.537-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:39:53.541-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:39:53.545-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:64263
2025-11-23T15:39:53.546-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:64263
2025-11-23T15:39:53.549-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:39:53.555-05:00  INFO 1084 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:39:53.562-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:39:53.568-05:00 DEBUG 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:39:53.585-05:00  WARN 1084 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:51:53.217-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 8248 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:51:53.220-05:00 DEBUG 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:51:53.221-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:51:55.037-05:00  INFO 8248 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:51:55.051-05:00  INFO 8248 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:51:55.052-05:00  INFO 8248 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:51:55.126-05:00  INFO 8248 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:51:55.127-05:00  INFO 8248 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1833 ms
2025-11-23T15:51:55.308-05:00  INFO 8248 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:51:55.864-05:00  INFO 8248 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@dab1f89
2025-11-23T15:51:55.868-05:00  INFO 8248 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:51:56.032-05:00 DEBUG 8248 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:51:56.149-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:51:56.269-05:00  INFO 8248 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:51:56.922-05:00  INFO 8248 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:51:56.933-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.426 seconds (process running for 4.864)
2025-11-23T15:51:56.937-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:51:56.938-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:51:56.953-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:51:57.085-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:51:57.432-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:51:57.434-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:51:57.436-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:51:57.436-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:51:57.437-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:51:57.438-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:51:57.452-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:51:57.453-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:51:57.455-05:00  INFO 8248 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:52:20.292-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49288
2025-11-23T15:52:20.322-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49288
2025-11-23T15:52:22.140-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49288
2025-11-23T15:52:22.146-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49288
2025-11-23T15:52:22.149-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49288
2025-11-23T15:52:22.184-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49288 conectado y saludado.
2025-11-23T15:52:22.187-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:52:22.196-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:52:22.209-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:52:22.213-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:52:22.217-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:52:22.217-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:49288
2025-11-23T15:52:22.221-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:49288
2025-11-23T15:52:22.221-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:52:22.223-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:52:22.225-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:52:22.229-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:52:22.241-05:00  WARN 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:52:22.245-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:52:22.254-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:52:22.270-05:00  WARN 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo enviar historial de mensajes desde BD tras login para user manuel: PreparedStatementCallback; uncategorized SQLException for SQL [SELECT m.* FROM mensajes m WHERE m.emisor_id = ? OR m.receptor_id = ? ORDER BY m.creado_en ASC LIMIT ?]; SQL state [S0022]; error code [0]; Column 'tipo' not found.
2025-11-23T15:52:31.532-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:65337
2025-11-23T15:52:31.545-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:65337
2025-11-23T15:52:33.909-05:00  INFO 8248 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:65337
2025-11-23T15:52:33.909-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:65337
2025-11-23T15:52:33.909-05:00  INFO 8248 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:65337
2025-11-23T15:52:33.918-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:65337 conectado y saludado.
2025-11-23T15:52:33.918-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:52:33.918-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:52:33.926-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:52:33.928-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:52:33.928-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:52:33.928-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:65337
2025-11-23T15:52:33.931-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:65337
2025-11-23T15:52:33.934-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:52:33.936-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:52:33.936-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:52:33.941-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:52:33.947-05:00  WARN 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:52:33.947-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:52:33.954-05:00 DEBUG 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:52:33.958-05:00  WARN 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo enviar historial de mensajes desde BD tras login para user laura: PreparedStatementCallback; uncategorized SQLException for SQL [SELECT m.* FROM mensajes m WHERE m.emisor_id = ? OR m.receptor_id = ? ORDER BY m.creado_en ASC LIMIT ?]; SQL state [S0022]; error code [0]; Column 'tipo' not found.
2025-11-23T15:56:28.779-05:00 ERROR 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:49288: java.net.SocketException: Connection reset
2025-11-23T15:56:28.779-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T15:56:28.784-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:56:28.784-05:00  INFO 8248 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T15:56:33.310-05:00 ERROR 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:65337: java.net.SocketException: Connection reset
2025-11-23T15:56:33.310-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T15:56:33.310-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:56:33.310-05:00  INFO 8248 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T15:56:39.078-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 15872 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T15:56:39.082-05:00 DEBUG 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T15:56:39.082-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T15:56:41.178-05:00  INFO 15872 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T15:56:41.202-05:00  INFO 15872 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T15:56:41.213-05:00  INFO 15872 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T15:56:41.295-05:00  INFO 15872 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T15:56:41.295-05:00  INFO 15872 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2135 ms
2025-11-23T15:56:41.509-05:00  INFO 15872 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T15:56:41.995-05:00  INFO 15872 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1727e03a
2025-11-23T15:56:42.005-05:00  INFO 15872 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T15:56:42.154-05:00 DEBUG 15872 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T15:56:42.268-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T15:56:42.380-05:00  INFO 15872 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T15:56:42.845-05:00  INFO 15872 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T15:56:42.848-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.545 seconds (process running for 4.998)
2025-11-23T15:56:42.860-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T15:56:42.860-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T15:56:42.876-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T15:56:42.945-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T15:56:43.240-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T15:56:43.248-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T15:56:43.253-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T15:56:43.256-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T15:56:47.348-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59402
2025-11-23T15:56:47.354-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59402
2025-11-23T15:56:49.906-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59402
2025-11-23T15:56:49.906-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59402
2025-11-23T15:56:49.908-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59402
2025-11-23T15:56:49.917-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59402 conectado y saludado.
2025-11-23T15:56:49.917-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:56:49.939-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:56:49.944-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:56:49.948-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:56:49.948-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:56:49.948-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:59402
2025-11-23T15:56:49.952-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:59402
2025-11-23T15:56:49.952-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:56:49.952-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T15:56:49.953-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:56:49.956-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:56:49.963-05:00  WARN 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:56:49.968-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:56:49.974-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:56:49.980-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 3 mensajes históricos desde BD a manuel
2025-11-23T15:57:00.258-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54686
2025-11-23T15:57:00.275-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54686
2025-11-23T15:57:02.785-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54686
2025-11-23T15:57:02.785-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54686
2025-11-23T15:57:02.785-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54686
2025-11-23T15:57:02.790-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54686 conectado y saludado.
2025-11-23T15:57:02.792-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T15:57:02.793-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:02.807-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:02.809-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:57:02.809-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T15:57:02.809-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:54686
2025-11-23T15:57:02.812-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:54686
2025-11-23T15:57:02.812-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T15:57:02.812-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:57:02.814-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:02.817-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:02.826-05:00  WARN 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:57:02.832-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:02.838-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:02.840-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 3 mensajes históricos desde BD a laura
2025-11-23T15:57:13.294-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola manuel'
2025-11-23T15:57:13.302-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 15:57:13] Mensaje enviado por: laura Para manuel Contenido: hola manuel
2025-11-23T15:57:13.310-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 15:57:13 Mensaje enviado por: laura Para manuel Contenido: hola manuel (desde /192.168.40.12:54686)
2025-11-23T15:57:13.316-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:13.322-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:13.322-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:57:13.326-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:57:13.331-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='hola manuel'
2025-11-23T15:57:13.336-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T15:57:28.262-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|hola laura'
2025-11-23T15:57:28.262-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 15:57:28] Mensaje enviado por: manuel Para laura Contenido: hola laura
2025-11-23T15:57:28.275-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 15:57:28 Mensaje enviado por: manuel Para laura Contenido: hola laura (desde /192.168.40.12:59402)
2025-11-23T15:57:28.288-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:57:28.294-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:57:28.301-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T15:57:28.304-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T15:57:28.304-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=null contenido='hola laura'
2025-11-23T15:57:28.304-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=null
2025-11-23T15:58:05.874-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T15:58:05.874-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T15:58:05.875-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T15:58:07.547-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54126
2025-11-23T15:58:07.554-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54126
2025-11-23T15:58:12.452-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54126
2025-11-23T15:58:12.457-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54126
2025-11-23T15:58:12.459-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54126
2025-11-23T15:58:12.459-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54126 conectado y saludado.
2025-11-23T15:58:12.459-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T15:58:12.464-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:58:12.486-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:58:12.497-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T15:58:12.498-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T15:58:12.502-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:54126
2025-11-23T15:58:12.507-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:54126
2025-11-23T15:58:12.509-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T15:58:12.509-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T15:58:12.511-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:58:12.519-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:58:12.528-05:00  WARN 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T15:58:12.540-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T15:58:12.544-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T15:58:12.551-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T16:01:37.543-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 15820 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:01:37.549-05:00 DEBUG 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:01:37.549-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:01:39.583-05:00  INFO 15820 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:01:39.611-05:00  INFO 15820 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:01:39.613-05:00  INFO 15820 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:01:39.710-05:00  INFO 15820 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:01:39.710-05:00  INFO 15820 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2091 ms
2025-11-23T16:01:39.903-05:00  INFO 15820 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:01:40.427-05:00  INFO 15820 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@5792c08c
2025-11-23T16:01:40.427-05:00  INFO 15820 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:01:40.627-05:00 DEBUG 15820 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:01:40.766-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:01:40.900-05:00  INFO 15820 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:01:41.447-05:00  INFO 15820 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:01:41.461-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.596 seconds (process running for 4.987)
2025-11-23T16:01:41.470-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:01:41.472-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:01:41.488-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:01:41.544-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:01:41.918-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:01:41.920-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:01:41.922-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:01:41.922-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:01:41.924-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:01:41.930-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:01:41.958-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:01:41.966-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:01:41.977-05:00  INFO 15820 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:01:53.906-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:50811
2025-11-23T16:01:53.913-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:50811
2025-11-23T16:01:57.300-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:50811
2025-11-23T16:01:57.305-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:50811
2025-11-23T16:01:57.309-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:50811
2025-11-23T16:01:57.361-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:50811 conectado y saludado.
2025-11-23T16:01:57.365-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:01:57.381-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:01:57.393-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:01:57.401-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:01:57.403-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:01:57.405-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:50811
2025-11-23T16:01:57.405-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:50811
2025-11-23T16:01:57.409-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:01:57.420-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:01:57.422-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:01:57.426-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:01:57.444-05:00  WARN 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:01:57.448-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:01:57.452-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:01:57.461-05:00  INFO 15820 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T16:02:06.687-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63540
2025-11-23T16:02:06.692-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63540
2025-11-23T16:02:11.863-05:00  INFO 15820 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63540
2025-11-23T16:02:11.863-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63540
2025-11-23T16:02:11.865-05:00  INFO 15820 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63540
2025-11-23T16:02:11.868-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63540 conectado y saludado.
2025-11-23T16:02:11.870-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:02:11.888-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:02:11.896-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:02:11.898-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:02:11.900-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:02:11.902-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:63540
2025-11-23T16:02:11.902-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:63540
2025-11-23T16:02:11.910-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:02:11.919-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:02:11.924-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:02:11.928-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:02:11.933-05:00  WARN 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:02:11.935-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:02:11.942-05:00 DEBUG 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:02:11.947-05:00  INFO 15820 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a laura
2025-11-23T16:09:11.145-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 16456 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:09:11.145-05:00 DEBUG 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:09:11.151-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:09:12.782-05:00  INFO 16456 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:09:12.801-05:00  INFO 16456 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:09:12.803-05:00  INFO 16456 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:09:12.855-05:00  INFO 16456 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:09:12.871-05:00  INFO 16456 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1654 ms
2025-11-23T16:09:13.044-05:00  INFO 16456 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:09:13.621-05:00  INFO 16456 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2007435e
2025-11-23T16:09:13.628-05:00  INFO 16456 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:09:13.829-05:00 DEBUG 16456 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:09:14.077-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:09:14.219-05:00  INFO 16456 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:09:14.788-05:00  INFO 16456 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:09:14.788-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.346 seconds (process running for 4.818)
2025-11-23T16:09:14.806-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:09:14.806-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:09:14.820-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:09:14.877-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:09:15.304-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:09:15.306-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:09:15.308-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:09:15.308-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:09:15.308-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:09:15.308-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:09:15.329-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:09:15.329-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:09:15.337-05:00  INFO 16456 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:09:26.027-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:52845
2025-11-23T16:09:26.040-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:52845
2025-11-23T16:09:27.714-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:52845
2025-11-23T16:09:27.716-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:52845
2025-11-23T16:09:27.716-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:52845
2025-11-23T16:09:27.726-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:52845 conectado y saludado.
2025-11-23T16:09:27.726-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:09:27.737-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:09:27.745-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:09:27.754-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:52845
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:52845
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:09:27.754-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:09:27.754-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:09:27.762-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:09:27.771-05:00  WARN 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:09:27.771-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:09:27.776-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:09:27.780-05:00  INFO 16456 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T16:09:37.187-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:58619
2025-11-23T16:09:37.195-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:58619
2025-11-23T16:09:38.703-05:00  INFO 16456 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:58619
2025-11-23T16:09:38.706-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:58619
2025-11-23T16:09:38.706-05:00  INFO 16456 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:58619
2025-11-23T16:09:38.714-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:58619 conectado y saludado.
2025-11-23T16:09:38.719-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:09:38.727-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:09:38.733-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:09:38.743-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:09:38.743-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:09:38.743-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:58619
2025-11-23T16:09:38.745-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:58619
2025-11-23T16:09:38.747-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:09:38.751-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:09:38.755-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:09:38.761-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:09:38.765-05:00  WARN 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:09:38.767-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:09:38.779-05:00 DEBUG 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:09:38.787-05:00  INFO 16456 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a laura
2025-11-23T16:15:42.921-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 12756 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:15:42.932-05:00 DEBUG 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:15:42.932-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:15:44.923-05:00  INFO 12756 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:15:44.945-05:00  INFO 12756 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:15:44.945-05:00  INFO 12756 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:15:45.023-05:00  INFO 12756 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:15:45.023-05:00  INFO 12756 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2028 ms
2025-11-23T16:15:45.223-05:00  INFO 12756 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:15:45.828-05:00  INFO 12756 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@54c622a7
2025-11-23T16:15:45.836-05:00  INFO 12756 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:15:46.014-05:00 DEBUG 12756 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:15:46.141-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:15:46.275-05:00  INFO 12756 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:15:46.983-05:00  INFO 12756 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:15:46.995-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.756 seconds (process running for 5.137)
2025-11-23T16:15:47.001-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:15:47.003-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:15:47.027-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:15:47.134-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:15:47.617-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:15:47.617-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:15:47.617-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:15:47.617-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:15:47.620-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:15:47.620-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:15:47.628-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:15:47.628-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:15:47.634-05:00  INFO 12756 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:15:59.426-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61125
2025-11-23T16:15:59.440-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61125
2025-11-23T16:16:01.293-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61125
2025-11-23T16:16:01.295-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61125
2025-11-23T16:16:01.299-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61125
2025-11-23T16:16:01.320-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61125 conectado y saludado.
2025-11-23T16:16:01.322-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:16:01.339-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:16:01.345-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:16:01.351-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:16:01.354-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:16:01.356-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:61125
2025-11-23T16:16:01.358-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:61125
2025-11-23T16:16:01.358-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:16:01.361-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:16:01.363-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:16:01.367-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:16:01.377-05:00  WARN 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:16:01.379-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:16:01.382-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:16:01.388-05:00  INFO 12756 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T16:16:11.041-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64691
2025-11-23T16:16:11.051-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64691
2025-11-23T16:16:12.524-05:00  INFO 12756 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64691
2025-11-23T16:16:12.524-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64691
2025-11-23T16:16:12.532-05:00  INFO 12756 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64691
2025-11-23T16:16:12.535-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64691 conectado y saludado.
2025-11-23T16:16:12.537-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:16:12.537-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:16:12.546-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:16:12.550-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:16:12.552-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:16:12.554-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:64691
2025-11-23T16:16:12.557-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:64691
2025-11-23T16:16:12.557-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:16:12.557-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:16:12.560-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:16:12.565-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:16:12.571-05:00  WARN 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:16:12.574-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:16:12.581-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:16:12.581-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a laura
2025-11-23T16:16:23.494-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola manuel'
2025-11-23T16:16:23.500-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:16:23] Mensaje enviado por: laura Para manuel Contenido: hola manuel
2025-11-23T16:16:23.509-05:00  INFO 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:16:23 Mensaje enviado por: laura Para manuel Contenido: hola manuel (desde /192.168.40.12:64691)
2025-11-23T16:16:23.512-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:16:23.516-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:16:23.523-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:16:23.528-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:16:23.530-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='hola manuel'
2025-11-23T16:16:23.532-05:00 DEBUG 12756 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:21:29.924-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 12584 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:21:29.927-05:00 DEBUG 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:21:29.927-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:21:31.692-05:00  INFO 12584 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:21:31.708-05:00  INFO 12584 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:21:31.717-05:00  INFO 12584 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:21:31.776-05:00  INFO 12584 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:21:31.776-05:00  INFO 12584 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1781 ms
2025-11-23T16:21:31.942-05:00  INFO 12584 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:21:32.519-05:00  INFO 12584 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@485caa8f
2025-11-23T16:21:32.527-05:00  INFO 12584 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:21:32.683-05:00 DEBUG 12584 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:21:32.836-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:21:32.991-05:00  INFO 12584 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:21:33.470-05:00  INFO 12584 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:21:33.484-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.256 seconds (process running for 4.63)
2025-11-23T16:21:33.487-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:21:33.487-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:21:33.504-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:21:33.563-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:21:33.892-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:21:33.894-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:21:33.923-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:21:33.927-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:21:33.935-05:00  INFO 12584 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:21:50.608-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:56577
2025-11-23T16:21:50.619-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:56577
2025-11-23T16:21:52.290-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:56577
2025-11-23T16:21:52.293-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:56577
2025-11-23T16:21:52.296-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:56577
2025-11-23T16:21:52.316-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:56577 conectado y saludado.
2025-11-23T16:21:52.322-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:21:52.339-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:21:52.350-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:21:52.355-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:21:52.355-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:21:52.355-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:56577
2025-11-23T16:21:52.355-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:56577
2025-11-23T16:21:52.355-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:21:52.359-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:21:52.359-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:21:52.363-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:21:52.374-05:00  WARN 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:21:52.375-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:21:52.380-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:21:52.389-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a manuel
2025-11-23T16:22:02.355-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:50556
2025-11-23T16:22:02.361-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:50556
2025-11-23T16:22:04.284-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:50556
2025-11-23T16:22:04.284-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:50556
2025-11-23T16:22:04.286-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:50556
2025-11-23T16:22:04.288-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:50556 conectado y saludado.
2025-11-23T16:22:04.294-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:22:04.316-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:22:04.327-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:22:04.342-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:22:04.343-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:22:04.344-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:50556
2025-11-23T16:22:04.345-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:50556
2025-11-23T16:22:04.345-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:22:04.347-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:22:04.350-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:22:04.354-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:22:04.358-05:00  WARN 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:22:04.362-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:22:04.367-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:22:04.374-05:00  INFO 12584 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a laura
2025-11-23T16:22:44.181-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T16:22:44.186-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:22:44.188-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T16:22:45.658-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54759
2025-11-23T16:22:45.664-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54759
2025-11-23T16:22:47.843-05:00  INFO 12584 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54759
2025-11-23T16:22:47.852-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54759
2025-11-23T16:22:47.856-05:00  INFO 12584 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54759
2025-11-23T16:22:47.859-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54759 conectado y saludado.
2025-11-23T16:22:47.861-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:22:47.871-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:22:47.884-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:22:47.884-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:22:47.884-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:22:47.886-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:54759
2025-11-23T16:22:47.886-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:54759
2025-11-23T16:22:47.889-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:22:47.889-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:22:47.893-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:22:47.899-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:22:47.907-05:00  WARN 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:22:47.909-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:22:47.916-05:00 DEBUG 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:22:47.924-05:00  INFO 12584 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a manuel
2025-11-23T16:27:00.878-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 19284 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:27:00.878-05:00 DEBUG 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:27:00.878-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:27:03.160-05:00  INFO 19284 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:27:03.177-05:00  INFO 19284 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:27:03.177-05:00  INFO 19284 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:27:03.283-05:00  INFO 19284 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:27:03.283-05:00  INFO 19284 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2315 ms
2025-11-23T16:27:03.507-05:00  INFO 19284 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:27:04.027-05:00  INFO 19284 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@383c3eb3
2025-11-23T16:27:04.036-05:00  INFO 19284 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:27:04.215-05:00 DEBUG 19284 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:27:04.370-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:27:04.504-05:00  INFO 19284 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:27:05.108-05:00  INFO 19284 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:27:05.289-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.04 seconds (process running for 5.434)
2025-11-23T16:27:05.295-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:27:05.296-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:27:05.310-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:27:05.370-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:27:05.695-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:27:05.707-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:27:05.707-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:27:05.717-05:00  INFO 19284 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:27:37.183-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:50290
2025-11-23T16:27:37.194-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:50290
2025-11-23T16:27:40.306-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:50290
2025-11-23T16:27:40.320-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:50290
2025-11-23T16:27:40.348-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:50290
2025-11-23T16:27:40.365-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:50290 conectado y saludado.
2025-11-23T16:27:40.367-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:27:40.383-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:27:40.398-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:27:40.402-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:50290
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:50290
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:27:40.402-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:27:40.402-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:27:40.413-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:27:40.423-05:00  WARN 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:27:40.424-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:27:40.429-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:27:40.438-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a manuel
2025-11-23T16:27:48.769-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61548
2025-11-23T16:27:48.781-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61548
2025-11-23T16:27:50.528-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61548
2025-11-23T16:27:50.528-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61548
2025-11-23T16:27:50.530-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61548
2025-11-23T16:27:50.532-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61548 conectado y saludado.
2025-11-23T16:27:50.535-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:27:50.542-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:27:50.553-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:27:50.555-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:27:50.557-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:27:50.559-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:61548
2025-11-23T16:27:50.562-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:61548
2025-11-23T16:27:50.564-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:27:50.565-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:27:50.567-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:27:50.571-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:27:50.573-05:00  WARN 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:27:50.577-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:27:50.587-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:27:50.592-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a laura
2025-11-23T16:28:19.139-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR manuel|Tipos de mensaje avanzadas.txt|2038'
2025-11-23T16:28:19.143-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='manuel' filename='Tipos de mensaje avanzadas.txt' size='2038'
2025-11-23T16:28:19.147-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: Tipos de mensaje avanzadas.txt size=2038 desde /192.168.40.12:61548
2025-11-23T16:28:19.184-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA manuel|Tipos de mensaje avanzadas.txt|Ly8vLy8vLy8NCkFwbGljYWNpw7NuIGNsaWVudGUgc2Vydmlkb3IgcGFyYSBlbCBpbnRlcmNhbWJpbyBkZSBpbmZvcm1hY2nDs24gZW50cmUgdXN1YXJpb3MuIHB1ZWRlbiBpbnRlcmNhbWJpYXIgaW5mb3JtYWNpw7NuIGJhc2FkYSBlbiBtZW5zYWplcyBkZSB0ZXh0byB5IGFyY2hpdm9zICggdGV4dG8gbyBiaW5hcmlvICkNCkVsIHNlcnZpZG9yIHBvZHLDoSByZWNpYmlyIHZhcmlhcyBjb25leGlvbmVzIHNpbXVsdGFuZWFzIHBhcmEgZWwgcHJvY2VzYW1pZW50byBkZSBtZW5zYWplcywgZGViZXLDoW4gYXBsaWNhciBlbCBjb25jZXB0byBkZSBwcm9ncmFtYWNpw7NuIGNvbmN1cnJlbnRlIGNvbiBoaWxvcyBwYXJhIGdlc3Rpb25hciBsYXMgY29uZXhpb25lcw0KVG9kYSBsYSBpbmZvcm1hY2nDs24gZGVsIHNlcnZpZG9yIGRlYmUgc2VyIGFsbWFjZW5hZGEgZW4gbGEgYmFzZSBkZSBkYXRvcyByZWxhY2lvbmFsOyBlajogc3FsLCBPcmFjbGUNCkxvcyB1c3VhcmlvcyBzZSBkZWJlbiBjcmVhciBkZXNkZSBsYSBhcHAgZGUgY2xpZW50ZSwgcGVybyBzZSBhY2VwdGFuIGRlc2RlIGVsIHNlcnZpZG9yLCBzb2xvIHB1ZWRlbiBjb25lY3RhcnNlIGx1ZWdvIGRlIHNlciBhY2VwdGFkb3MNClVuIHVzdWFyaW8gcHVlZGUgdGVuZXIgbWFzIGRlIDEgY29uZXhpw7NuIGRlc2RlIG1hcyBkZSAxIGRpc3Bvc2l0aXZvDQpFbCBzZXJ2aWRvciBkZWJlIG1vc3RyYXIgcG9yIGNvbnNvbGEgdG9kYXMgbGFzIGFjY2lvbmVzIHF1ZSBzZSBlc3TDoW4gZWplY3V0YW5kbw0KRWwgc2Vydmlkb3IgbGltaXRhIGxhIGNhbnRpZGFkIGRlIGNvbmV4aW9uZXMgcG9yIHVzdWFyaW8NCkxhIGNvbmV4acOzbiBlbnRyZSBzZXJ2aWRvciBjbGllbnRlcyBzZSBoYWNlIGEgdHJhdsOpcyBkZSBwcm90b2NvbG8gdGNwIGlwDQpMb3MgdXN1YXJpb3MgcHVlZGVuIGRlc2NhcmdhciBsb3MgYXJjaGl2b3MgZW52aWFkb3MNCkxhIGFwbGljYWNpw7NuIGNsaWVudGUgaW1wbGVtZW50YXJhIGZvcm11bGFyaW9zIG1hZXN0cm8tZGV0YWxsZSBwYXJhIG1vc3RyYXIgbGEgaW5mb3JtYWNpw7NuIGFzb2NpYWRhIGFsIHVzdWFyaW8NCg0KVW5hIGFwbGljYWNpw7NuIHdlYiBtdmMgbXXDqXN0cmFsbyBzaWd1aWVudGUNCkxpc3RhZG8gZGUgdXN1YXJpb3MgcmVnaXN0cmFkb3MNCk1lbnNhamVzIGRlIGxvcyB1c3VhcmlvcywgY2xhc2lmaWNhZG9zIHBvciBlbCB0aXBvIGRlIG1lbnNhamUuIFZlciBkZXRhbGxlIGRlIG1lbnNhamUsIGluY2x1eWUgZGVzY2FyZ2FyIGFyY2hpdm9zLg0KTW9zdHJhciBsb3Mgc2lndWllbnRlcyBpbmZvcm1lcw0KVXN1YXJpbyBjb24gbWFzIG1lbnNhamVzIGVudmlhZG9zOiBtb3N0cmFyIGNhbnRpZGFkDQpBcmNoaXZvcyBlbnZpYWRvcywgbGlzdGFyIHBvciB0YW1hw7FvIHkgbW9zdHJhciBwcm9waWV0YXJpbw0KTGlzdGEgZGUgdXN1YXJpb3MgY29uZWN0YWRvcyB5IGluZm9ybWFjacOzbjogSXAsIGhvcmEgZGUgY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQpMaXN0YSBkZSB1c3VhcmlvcyBkZXNjb25lY3RhZG9zIHkgaW5mb3JtYWNpw7NuOiBJcCwgaG9yYSBkZSBjb25leGnDs24sIGhvcmEgZGUgZGVzY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQoNCg0KVW4gc2VydmljaW8gd2ViIGRlIGFwaSByZXN0IHBhcmEgbW9zdHJhciBsbyBzaWd1aWVudGU6DQpJbmZvcm1hY2nDs24gY29tcGxldGEgZGUgdXN1YXJpbzogTm9tYnJlLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcywgY2FudGlkYWQgZGUgbWVuc2FqZXMgcmVjaWJpZG9zLCBmZWNoYSB5IGhvcmEgZGUgdWx0aW1hIGNvbmV4acOzbiwgZXN0YWRvIChkZXNjb25lY3RhZG8vY29uZWN0YWRvKQ0KTGlzdGEgZGUgbWVuc2FqZXMgZW52aWFkb3MgKElwIHVzdWFyaW8saXAgdXN1YXJpbyByZW1vdG8sZmVjaGEsaG9yYSkNCkxpc3RhIGRlIG1lbnNhamVzIHJlY2liaWRvcyAoSXAgdXN1YXJpbyxpcCB1c3VhcmlvIHJlbW90byxmZWNoYSxob3JhKQ=='
2025-11-23T16:28:19.195-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: laura -> manuel : Tipos de mensaje avanzadas.txt (2038 bytes)
2025-11-23T16:28:19.207-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763933299195_laura_Tipos de mensaje avanzadas.txt
2025-11-23T16:28:19.209-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:28:19.214-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:28:19.240-05:00  INFO 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'Tipos de mensaje avanzadas.txt' using columns nombre_original / nombre_almacenado, id=1
2025-11-23T16:28:19.240-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:28:19.244-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:28:19.247-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=2 receptorId=1 archivoId=1
2025-11-23T16:28:19.247-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=ARCHIVO, sesionId=null
2025-11-23T16:28:38.473-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T16:28:38.475-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:28:38.476-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T16:28:40.288-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:62368
2025-11-23T16:28:40.294-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:62368
2025-11-23T16:28:43.516-05:00  INFO 19284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:62368
2025-11-23T16:28:43.518-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:62368
2025-11-23T16:28:43.519-05:00  INFO 19284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:62368
2025-11-23T16:28:43.523-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:62368 conectado y saludado.
2025-11-23T16:28:43.524-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:28:43.526-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:28:43.548-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:28:43.554-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:28:43.555-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:28:43.557-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:62368
2025-11-23T16:28:43.557-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:62368
2025-11-23T16:28:43.574-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:28:43.578-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:28:43.579-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:28:43.584-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:28:43.594-05:00  WARN 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:28:43.597-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:28:43.606-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:28:43.613-05:00  INFO 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 7 mensajes históricos desde BD a manuel
2025-11-23T16:28:43.667-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:28:43.674-05:00 DEBUG 19284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:30:53.404-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 18712 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:30:53.404-05:00 DEBUG 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:30:53.404-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:30:55.492-05:00  INFO 18712 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:30:55.513-05:00  INFO 18712 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:30:55.518-05:00  INFO 18712 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:30:55.599-05:00  INFO 18712 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:30:55.599-05:00  INFO 18712 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2125 ms
2025-11-23T16:30:55.816-05:00  INFO 18712 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:30:56.384-05:00  INFO 18712 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3a17b2e3
2025-11-23T16:30:56.388-05:00  INFO 18712 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:30:56.555-05:00 DEBUG 18712 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:30:56.705-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:30:56.836-05:00  INFO 18712 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:30:57.422-05:00  INFO 18712 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:30:57.439-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.707 seconds (process running for 5.121)
2025-11-23T16:30:57.444-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:30:57.445-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:30:57.468-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:30:57.526-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:30:57.945-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:30:57.946-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:30:57.972-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-23T16:30:57.976-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-23T16:30:57.984-05:00  INFO 18712 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:31:14.827-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:61431
2025-11-23T16:31:14.842-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:61431
2025-11-23T16:31:16.356-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:61431
2025-11-23T16:31:16.357-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:61431
2025-11-23T16:31:16.364-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:61431
2025-11-23T16:31:16.391-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:61431 conectado y saludado.
2025-11-23T16:31:16.393-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:31:16.402-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:31:16.412-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:31:16.417-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:31:16.417-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:31:16.417-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:61431
2025-11-23T16:31:16.417-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:61431
2025-11-23T16:31:16.417-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:31:16.423-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:31:16.423-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:31:16.427-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:31:16.433-05:00  WARN 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:31:16.433-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:31:16.442-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:31:16.452-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 7 mensajes históricos desde BD a manuel
2025-11-23T16:31:16.498-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:31:16.500-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:31:23.983-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63366
2025-11-23T16:31:23.996-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63366
2025-11-23T16:31:26.548-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63366
2025-11-23T16:31:26.548-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63366
2025-11-23T16:31:26.550-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63366
2025-11-23T16:31:26.554-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63366 conectado y saludado.
2025-11-23T16:31:26.554-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:31:26.570-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:31:26.584-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:31:26.586-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:31:26.587-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:31:26.589-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:63366
2025-11-23T16:31:26.591-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:63366
2025-11-23T16:31:26.596-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:31:26.613-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:31:26.618-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:31:26.623-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:31:26.629-05:00  WARN 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:31:26.634-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:31:26.640-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:31:26.652-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 7 mensajes históricos desde BD a laura
2025-11-23T16:31:26.700-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:31:26.707-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:31:50.981-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|puede ver el mensaje de arhivo?'
2025-11-23T16:31:50.981-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:31:50] Mensaje enviado por: laura Para manuel Contenido: puede ver el mensaje de arhivo?
2025-11-23T16:31:50.996-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:31:50 Mensaje enviado por: laura Para manuel Contenido: puede ver el mensaje de arhivo? (desde /192.168.40.12:63366)
2025-11-23T16:31:50.998-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:31:51.008-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:31:51.017-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:31:51.025-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:31:51.039-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='puede ver el mensaje de arhivo?'
2025-11-23T16:31:51.044-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:32:49.606-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola?'
2025-11-23T16:32:49.611-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:32:49] Mensaje enviado por: laura Para manuel Contenido: hola?
2025-11-23T16:32:49.615-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:32:49 Mensaje enviado por: laura Para manuel Contenido: hola? (desde /192.168.40.12:63366)
2025-11-23T16:32:49.619-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:32:49.624-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:32:49.626-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:32:49.634-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:32:49.634-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='hola?'
2025-11-23T16:32:49.634-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:32:55.812-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T16:32:55.816-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:32:55.818-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:32:57.920-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:55592
2025-11-23T16:32:57.934-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:55592
2025-11-23T16:33:01.454-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:55592
2025-11-23T16:33:01.458-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:55592
2025-11-23T16:33:01.460-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:55592
2025-11-23T16:33:01.479-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:55592 conectado y saludado.
2025-11-23T16:33:01.481-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:33:01.485-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:01.491-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:01.491-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:33:01.491-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:33:01.491-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:55592
2025-11-23T16:33:01.491-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:55592
2025-11-23T16:33:01.495-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:33:01.495-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:33:01.497-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:01.503-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:01.509-05:00  WARN 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:33:01.511-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:01.515-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:01.520-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 9 mensajes históricos desde BD a laura
2025-11-23T16:33:01.564-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:33:01.568-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:33:12.200-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola'
2025-11-23T16:33:12.200-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:33:12] Mensaje enviado por: laura Para manuel Contenido: hola
2025-11-23T16:33:12.204-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:33:12 Mensaje enviado por: laura Para manuel Contenido: hola (desde /192.168.40.12:55592)
2025-11-23T16:33:12.206-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:12.211-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:12.213-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:33:12.217-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:33:12.221-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='hola'
2025-11-23T16:33:12.229-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:33:19.737-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|si?'
2025-11-23T16:33:19.744-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:33:19] Mensaje enviado por: manuel Para laura Contenido: si?
2025-11-23T16:33:19.748-05:00  INFO 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:33:19 Mensaje enviado por: manuel Para laura Contenido: si? (desde /192.168.40.12:61431)
2025-11-23T16:33:19.750-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:33:19.754-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:33:19.756-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:33:19.760-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:33:19.766-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=null contenido='si?'
2025-11-23T16:33:19.766-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=null
2025-11-23T16:34:25.952-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:53497
2025-11-23T16:34:25.961-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:53497
2025-11-23T16:34:29.016-05:00  INFO 18712 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:53497
2025-11-23T16:34:29.017-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:53497
2025-11-23T16:34:29.018-05:00  INFO 18712 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:53497
2025-11-23T16:34:29.022-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:53497 conectado y saludado.
2025-11-23T16:34:29.025-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 3|hector|1234'
2025-11-23T16:34:29.043-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T16:34:29.052-05:00  WARN 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='hector' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T16:34:29.088-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Usuario 'hector' (id=3) registrado en DB
2025-11-23T16:34:29.090-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'hector' (id=3) desde /192.168.40.12:53497
2025-11-23T16:34:29.092-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: hector (id=3) desde /192.168.40.12:53497
2025-11-23T16:34:29.098-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 3
2025-11-23T16:34:29.103-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 3
2025-11-23T16:34:36.814-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN hector|1234'
2025-11-23T16:34:36.815-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T16:34:36.823-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T16:34:36.824-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='hector' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:34:36.826-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='hector'
2025-11-23T16:34:36.828-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='hector' desde /192.168.40.12:53497
2025-11-23T16:34:36.828-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: hector desde /192.168.40.12:53497
2025-11-23T16:34:36.831-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: hector (user-conns=1)
2025-11-23T16:34:36.831-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 3 clients: hector,laura,manuel
2025-11-23T16:34:36.832-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T16:34:36.837-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T16:34:36.848-05:00  WARN 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:34:36.861-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T16:34:36.870-05:00 DEBUG 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T16:34:46.999-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Usuario 'hector' desconectado.
2025-11-23T16:34:47.000-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario hector desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:34:47.001-05:00  INFO 18712 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:37:54.632-05:00 ERROR 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:55592: java.net.SocketException: Connection reset
2025-11-23T16:37:54.632-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T16:37:54.632-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:37:54.632-05:00  INFO 18712 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:38:01.429-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 14852 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:38:01.429-05:00 DEBUG 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:38:01.444-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:38:03.738-05:00  INFO 14852 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:38:03.763-05:00  INFO 14852 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:38:03.766-05:00  INFO 14852 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:38:03.862-05:00  INFO 14852 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:38:03.862-05:00  INFO 14852 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2347 ms
2025-11-23T16:38:04.156-05:00  INFO 14852 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:38:04.712-05:00  INFO 14852 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@45545e7a
2025-11-23T16:38:04.712-05:00  INFO 14852 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:38:04.873-05:00 DEBUG 14852 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:38:05.003-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:38:05.146-05:00  INFO 14852 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:38:05.729-05:00  INFO 14852 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:38:05.750-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.032 seconds (process running for 5.411)
2025-11-23T16:38:05.752-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:38:05.752-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:38:05.762-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:38:05.835-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:38:06.287-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:38:06.289-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:38:06.291-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:38:06.293-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:38:06.299-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:38:06.300-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:38:06.320-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:38:06.322-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:38:06.333-05:00  INFO 14852 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:38:19.174-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:50452
2025-11-23T16:38:19.184-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:50452
2025-11-23T16:38:23.455-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:50452
2025-11-23T16:38:23.458-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:50452
2025-11-23T16:38:23.462-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:50452
2025-11-23T16:38:23.506-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:50452 conectado y saludado.
2025-11-23T16:38:23.507-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:38:23.524-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:38:23.532-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:38:23.540-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:38:23.540-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:38:23.542-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:50452
2025-11-23T16:38:23.542-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:50452
2025-11-23T16:38:23.544-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:38:23.546-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:38:23.565-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:38:23.570-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:38:23.572-05:00  WARN 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:38:23.572-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:38:23.584-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:38:23.593-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 11 mensajes históricos desde BD a manuel
2025-11-23T16:38:23.663-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:38:23.667-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:38:28.958-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:51521
2025-11-23T16:38:28.965-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:51521
2025-11-23T16:38:31.259-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:51521
2025-11-23T16:38:31.259-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:51521
2025-11-23T16:38:31.264-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:51521
2025-11-23T16:38:31.267-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:51521 conectado y saludado.
2025-11-23T16:38:31.271-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:38:31.273-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:38:31.285-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:38:31.289-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:38:31.293-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:38:31.294-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:51521
2025-11-23T16:38:31.296-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:51521
2025-11-23T16:38:31.297-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:38:31.297-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:38:31.299-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:38:31.303-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:38:31.307-05:00  WARN 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:38:31.307-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:38:31.310-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:38:31.317-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 11 mensajes históricos desde BD a laura
2025-11-23T16:38:31.357-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:38:31.359-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:38:45.414-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|voy a enviar otro archivo'
2025-11-23T16:38:45.421-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:38:45] Mensaje enviado por: manuel Para laura Contenido: voy a enviar otro archivo
2025-11-23T16:38:45.426-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:38:45 Mensaje enviado por: manuel Para laura Contenido: voy a enviar otro archivo (desde /192.168.40.12:50452)
2025-11-23T16:38:45.434-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:38:45.441-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:38:45.441-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:38:45.445-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:38:45.447-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=null contenido='voy a enviar otro archivo'
2025-11-23T16:38:45.447-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=null
2025-11-23T16:40:04.920-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR manuel|conversar.txt|185'
2025-11-23T16:40:04.923-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='manuel' filename='conversar.txt' size='185'
2025-11-23T16:40:04.928-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: conversar.txt size=185 desde /192.168.40.12:51521
2025-11-23T16:40:04.942-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA manuel|conversar.txt|Y29udmVyc2FyDQpwcmVzZW50YWNpb25lcw0KZ3VzdG9zDQpwYcOtcw0KZXh0cmFzDQoNCnRpZW5kYXMNCmN1YW50byB2YWxlLCBjdWFuZG8gcGFnbywgZWZlY3Rpdm8vdGFyamV0YQ0KcmVjb21lbmRhY2lvbmVzLCBkdWxjZSwgcHJvdGXDrW5hcywgDQpib2xzYXMsIHRhcmpldGFzIGRlIGFmaWxpYWRvDQoNCnNpdGlvcw0KDQo='
2025-11-23T16:40:04.951-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: laura -> manuel : conversar.txt (185 bytes)
2025-11-23T16:40:04.958-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763934004951_laura_conversar.txt
2025-11-23T16:40:04.961-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:40:04.965-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:40:04.975-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'conversar.txt' using columns nombre_original / nombre_almacenado, id=2
2025-11-23T16:40:04.975-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:40:04.975-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:40:04.975-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=2 receptorId=1 archivoId=2
2025-11-23T16:40:04.975-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=ARCHIVO, sesionId=null
2025-11-23T16:41:00.811-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:55588
2025-11-23T16:41:00.817-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:55588
2025-11-23T16:41:05.233-05:00  INFO 14852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:55588
2025-11-23T16:41:05.233-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:55588
2025-11-23T16:41:05.234-05:00  INFO 14852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:55588
2025-11-23T16:41:05.237-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:55588 conectado y saludado.
2025-11-23T16:41:05.243-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:41:05.245-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:41:05.249-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:41:05.251-05:00 DEBUG 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:41:05.253-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:41:05.253-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:55588
2025-11-23T16:41:05.254-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:55588
2025-11-23T16:41:05.255-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'manuel' desde la misma IP 192.168.40.12 (ya conectado)
2025-11-23T16:41:05.257-05:00  WARN 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'manuel' desde 192.168.40.12 motivo=ya_conectado_misma_ip
2025-11-23T16:41:15.686-05:00 ERROR 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:55588: java.net.SocketException: Connection reset
2025-11-23T16:41:15.686-05:00  INFO 14852 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:55588 desconectado sin autenticarse.
2025-11-23T16:45:18.573-05:00 ERROR 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:51521: java.net.SocketException: Connection reset
2025-11-23T16:45:18.576-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T16:45:18.576-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:45:18.576-05:00  INFO 14852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:45:21.502-05:00 ERROR 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:50452: java.net.SocketException: Connection reset
2025-11-23T16:45:21.504-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T16:45:21.504-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:45:21.504-05:00  INFO 14852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T16:45:25.873-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 1608 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:45:25.887-05:00 DEBUG 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:45:25.888-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:45:28.065-05:00  INFO 1608 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:45:28.092-05:00  INFO 1608 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:45:28.092-05:00  INFO 1608 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:45:28.196-05:00  INFO 1608 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:45:28.198-05:00  INFO 1608 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2245 ms
2025-11-23T16:45:28.374-05:00  INFO 1608 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:45:28.920-05:00  INFO 1608 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2007435e
2025-11-23T16:45:28.920-05:00  INFO 1608 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:45:29.065-05:00 DEBUG 1608 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:45:29.176-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:45:29.289-05:00  INFO 1608 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:45:29.756-05:00  INFO 1608 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:45:29.761-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.608 seconds (process running for 5.02)
2025-11-23T16:45:29.773-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:45:29.774-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:45:29.789-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:45:29.847-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:45:30.127-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:45:30.130-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:45:30.138-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:45:30.140-05:00  INFO 1608 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:45:36.608-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63025
2025-11-23T16:45:36.622-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63025
2025-11-23T16:45:43.092-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63025
2025-11-23T16:45:43.092-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63025
2025-11-23T16:45:43.094-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63025
2025-11-23T16:45:43.115-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63025 conectado y saludado.
2025-11-23T16:45:43.117-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:45:43.136-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:45:43.143-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:45:43.146-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:45:43.152-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:45:43.153-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:63025
2025-11-23T16:45:43.155-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:63025
2025-11-23T16:45:43.157-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:45:43.159-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:45:43.161-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:45:43.164-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:45:43.174-05:00  WARN 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:45:43.178-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:45:43.182-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:45:43.196-05:00  INFO 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 13 mensajes históricos desde BD a manuel
2025-11-23T16:45:43.247-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:43.253-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:43.310-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:43.311-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:47.311-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59661
2025-11-23T16:45:47.315-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59661
2025-11-23T16:45:48.698-05:00  INFO 1608 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59661
2025-11-23T16:45:48.698-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59661
2025-11-23T16:45:48.698-05:00  INFO 1608 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59661
2025-11-23T16:45:48.702-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59661 conectado y saludado.
2025-11-23T16:45:48.704-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:45:48.706-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:45:48.713-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:45:48.713-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:45:48.715-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:45:48.715-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:59661
2025-11-23T16:45:48.719-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:59661
2025-11-23T16:45:48.719-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:45:48.719-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:45:48.719-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:45:48.723-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:45:48.727-05:00  WARN 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:45:48.727-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:45:48.733-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:45:48.740-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 13 mensajes históricos desde BD a laura
2025-11-23T16:45:48.778-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:48.778-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:48.816-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:45:48.817-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:46:04.139-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|mensaje actualizado'
2025-11-23T16:46:04.145-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 16:46:04] Mensaje enviado por: laura Para manuel Contenido: mensaje actualizado
2025-11-23T16:46:04.150-05:00  INFO 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 16:46:04 Mensaje enviado por: laura Para manuel Contenido: mensaje actualizado (desde /192.168.40.12:59661)
2025-11-23T16:46:04.150-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:46:04.155-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:46:04.157-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:46:04.161-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:46:04.163-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=null contenido='mensaje actualizado'
2025-11-23T16:46:04.163-05:00 DEBUG 1608 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T16:48:34.257-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 19680 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:48:34.257-05:00 DEBUG 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:48:34.257-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:48:36.737-05:00  INFO 19680 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:48:36.764-05:00  INFO 19680 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:48:36.766-05:00  INFO 19680 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:48:36.894-05:00  INFO 19680 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:48:36.896-05:00  INFO 19680 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2560 ms
2025-11-23T16:48:37.140-05:00  INFO 19680 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:48:37.825-05:00  INFO 19680 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@54c622a7
2025-11-23T16:48:37.827-05:00  INFO 19680 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:48:38.064-05:00 DEBUG 19680 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:48:38.288-05:00  INFO 19680 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:48:38.463-05:00  INFO 19680 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:48:39.088-05:00  INFO 19680 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:48:39.101-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.764 seconds (process running for 6.25)
2025-11-23T16:48:39.110-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:48:39.113-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:48:39.130-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:48:39.219-05:00  INFO 19680 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:48:39.668-05:00  INFO 19680 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:48:39.672-05:00  INFO 19680 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:48:39.672-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:48:39.674-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:48:39.674-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:48:39.676-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:48:39.699-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:48:39.703-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:48:39.711-05:00  INFO 19680 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:49:07.997-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 5156 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:49:07.997-05:00 DEBUG 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:49:07.997-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:49:10.256-05:00  INFO 5156 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:49:10.277-05:00  INFO 5156 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:49:10.277-05:00  INFO 5156 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:49:10.382-05:00  INFO 5156 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:49:10.382-05:00  INFO 5156 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2292 ms
2025-11-23T16:49:10.589-05:00  INFO 5156 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:49:11.301-05:00  INFO 5156 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@23cbbd07
2025-11-23T16:49:11.306-05:00  INFO 5156 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:49:11.527-05:00 DEBUG 5156 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:49:11.724-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:49:11.884-05:00  INFO 5156 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:49:12.360-05:00  INFO 5156 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:49:12.369-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.359 seconds (process running for 6.164)
2025-11-23T16:49:12.374-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:49:12.376-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:49:12.383-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:49:12.451-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:49:12.724-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:49:12.732-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:49:12.749-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:49:12.750-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:49:12.753-05:00  INFO 5156 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:49:12.825-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59740
2025-11-23T16:49:12.835-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59740
2025-11-23T16:49:14.657-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59740
2025-11-23T16:49:14.657-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59740
2025-11-23T16:49:14.659-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59740
2025-11-23T16:49:14.678-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59740 conectado y saludado.
2025-11-23T16:49:14.680-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:49:14.695-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:49:14.704-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:49:14.709-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:49:14.709-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:49:14.709-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:59740
2025-11-23T16:49:14.713-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:59740
2025-11-23T16:49:14.713-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:49:14.715-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:49:14.715-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:49:14.717-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:49:14.726-05:00  WARN 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:49:14.735-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:49:14.741-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:49:14.748-05:00  INFO 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 14 mensajes históricos desde BD a manuel
2025-11-23T16:49:14.795-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:14.801-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:14.846-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:14.858-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:23.385-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:55032
2025-11-23T16:49:23.393-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:55032
2025-11-23T16:49:25.724-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:55032
2025-11-23T16:49:25.724-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:55032
2025-11-23T16:49:25.724-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:55032
2025-11-23T16:49:25.742-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:55032 conectado y saludado.
2025-11-23T16:49:25.742-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T16:49:25.744-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:49:25.752-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:49:25.753-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:49:25.757-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T16:49:25.757-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:55032
2025-11-23T16:49:25.759-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:55032
2025-11-23T16:49:25.759-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T16:49:25.759-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T16:49:25.762-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:49:25.768-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:49:25.778-05:00  WARN 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:49:25.785-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T16:49:25.790-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T16:49:25.799-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 14 mensajes históricos desde BD a laura
2025-11-23T16:49:25.843-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:25.846-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:25.891-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:25.891-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:49:33.458-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T16:49:33.460-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:49:33.462-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:49:39.114-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49671
2025-11-23T16:49:39.125-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49671
2025-11-23T16:49:41.875-05:00  INFO 5156 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49671
2025-11-23T16:49:41.877-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49671
2025-11-23T16:49:41.877-05:00  INFO 5156 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49671
2025-11-23T16:49:41.880-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49671 conectado y saludado.
2025-11-23T16:49:41.895-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:49:41.896-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:49:41.908-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:49:41.908-05:00 DEBUG 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:49:41.908-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:49:41.910-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:49671
2025-11-23T16:49:41.910-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:49671
2025-11-23T16:49:41.913-05:00  INFO 5156 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'manuel' desde la misma IP 192.168.40.12 (ya conectado)
2025-11-23T16:49:41.915-05:00  WARN 5156 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'manuel' desde 192.168.40.12 motivo=ya_conectado_misma_ip
2025-11-23T16:55:55.871-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 972 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T16:55:55.876-05:00 DEBUG 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T16:55:55.876-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T16:55:57.715-05:00  INFO 972 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T16:55:57.731-05:00  INFO 972 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T16:55:57.732-05:00  INFO 972 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T16:55:57.828-05:00  INFO 972 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T16:55:57.828-05:00  INFO 972 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1867 ms
2025-11-23T16:55:58.016-05:00  INFO 972 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T16:55:58.491-05:00  INFO 972 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@54c622a7
2025-11-23T16:55:58.491-05:00  INFO 972 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T16:55:58.628-05:00 DEBUG 972 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T16:55:58.745-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T16:55:58.857-05:00  INFO 972 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T16:55:59.284-05:00  INFO 972 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T16:55:59.293-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.473 seconds (process running for 5.119)
2025-11-23T16:55:59.299-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T16:55:59.300-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T16:55:59.305-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T16:55:59.370-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T16:55:59.654-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T16:55:59.654-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T16:55:59.654-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T16:55:59.658-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T16:55:59.658-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T16:55:59.658-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T16:55:59.667-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T16:55:59.670-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T16:55:59.673-05:00  INFO 972 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T16:56:03.576-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:59215
2025-11-23T16:56:03.583-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:59215
2025-11-23T16:56:07.583-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:59215
2025-11-23T16:56:07.585-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:59215
2025-11-23T16:56:07.587-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:59215
2025-11-23T16:56:07.609-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:59215 conectado y saludado.
2025-11-23T16:56:07.612-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:56:07.630-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:56:07.632-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:56:07.645-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:56:07.645-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:56:07.645-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:59215
2025-11-23T16:56:07.645-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:59215
2025-11-23T16:56:07.645-05:00  INFO 972 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T16:56:07.650-05:00  INFO 972 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T16:56:07.650-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:56:07.654-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:56:07.667-05:00  WARN 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T16:56:07.667-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:56:07.674-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:56:07.686-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 14 mensajes históricos desde BD a manuel
2025-11-23T16:56:07.739-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:56:07.745-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:56:07.794-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T16:56:07.796-05:00 DEBUG 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T16:56:59.276-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64533
2025-11-23T16:56:59.283-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64533
2025-11-23T16:57:02.114-05:00  INFO 972 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64533
2025-11-23T16:57:02.114-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64533
2025-11-23T16:57:02.116-05:00  INFO 972 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64533
2025-11-23T16:57:02.118-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64533 conectado y saludado.
2025-11-23T16:57:02.118-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T16:57:02.121-05:00 DEBUG 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T16:57:02.128-05:00 DEBUG 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T16:57:02.128-05:00 DEBUG 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T16:57:02.128-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T16:57:02.130-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:64533
2025-11-23T16:57:02.131-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:64533
2025-11-23T16:57:02.131-05:00  INFO 972 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'manuel' desde la misma IP 192.168.40.12 (ya conectado)
2025-11-23T16:57:02.131-05:00  WARN 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'manuel' desde 192.168.40.12 motivo=Error: Limite de ips excedido, no puede ingresar en este equipo
2025-11-23T16:57:07.623-05:00 ERROR 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:64533: java.net.SocketException: Connection reset
2025-11-23T16:57:07.635-05:00  INFO 972 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64533 desconectado sin autenticarse.
2025-11-23T16:57:10.724-05:00 ERROR 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:59215: java.net.SocketException: Connection reset
2025-11-23T16:57:10.724-05:00  INFO 972 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T16:57:10.724-05:00  INFO 972 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T16:57:10.724-05:00  INFO 972 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T17:58:21.025-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 4660 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T17:58:21.025-05:00 DEBUG 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T17:58:21.034-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T17:58:23.352-05:00  INFO 4660 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T17:58:23.375-05:00  INFO 4660 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T17:58:23.376-05:00  INFO 4660 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T17:58:23.470-05:00  INFO 4660 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T17:58:23.471-05:00  INFO 4660 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2365 ms
2025-11-23T17:58:23.663-05:00  INFO 4660 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T17:58:24.328-05:00  INFO 4660 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@76e3b45b
2025-11-23T17:58:24.336-05:00  INFO 4660 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T17:58:24.471-05:00 DEBUG 4660 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : No se pudo ejecutar ALTER TABLE para agregar 'sesion_id' (posiblemente versión antigua de MySQL). Continuando: StatementCallback; bad SQL grammar [ALTER TABLE mensajes ADD COLUMN IF NOT EXISTS sesion_id CHAR(36) NULL]
2025-11-23T17:58:24.619-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T17:58:24.757-05:00  INFO 4660 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T17:58:25.233-05:00  INFO 4660 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T17:58:25.241-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.986 seconds (process running for 5.623)
2025-11-23T17:58:25.245-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T17:58:25.245-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T17:58:25.253-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T17:58:25.360-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T17:58:25.919-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T17:58:25.927-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 6
2025-11-23T17:58:25.935-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 6
2025-11-23T17:58:25.935-05:00  INFO 4660 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T17:58:43.414-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:52662
2025-11-23T17:58:43.422-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:52662
2025-11-23T17:58:45.080-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:52662
2025-11-23T17:58:45.080-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:52662
2025-11-23T17:58:45.086-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:52662
2025-11-23T17:58:45.118-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:52662 conectado y saludado.
2025-11-23T17:58:45.118-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T17:58:45.139-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T17:58:45.152-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T17:58:45.160-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T17:58:45.160-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T17:58:45.160-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:52662
2025-11-23T17:58:45.164-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:52662
2025-11-23T17:58:45.164-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T17:58:45.168-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T17:58:45.168-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T17:58:45.176-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T17:58:45.193-05:00  WARN 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T17:58:45.196-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T17:58:45.201-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T17:58:45.210-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a manuel
2025-11-23T17:58:51.280-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T17:58:51.282-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T17:58:51.286-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T17:58:55.723-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:57916
2025-11-23T17:58:55.735-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:57916
2025-11-23T17:58:57.426-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:57916
2025-11-23T17:58:57.426-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:57916
2025-11-23T17:58:57.426-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:57916
2025-11-23T17:58:57.434-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:57916 conectado y saludado.
2025-11-23T17:58:57.434-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T17:58:57.442-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T17:58:57.460-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T17:58:57.463-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T17:58:57.463-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T17:58:57.466-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:57916
2025-11-23T17:58:57.467-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:57916
2025-11-23T17:58:57.467-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T17:58:57.467-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T17:58:57.467-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T17:58:57.476-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T17:58:57.486-05:00  WARN 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T17:58:57.489-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T17:58:57.489-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T17:59:56.381-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T17:59:56.383-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T17:59:56.383-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T18:00:00.549-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:58775
2025-11-23T18:00:00.554-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:58775
2025-11-23T18:00:03.456-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:58775
2025-11-23T18:00:03.458-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:58775
2025-11-23T18:00:03.487-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:58775
2025-11-23T18:00:03.510-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:58775 conectado y saludado.
2025-11-23T18:00:03.512-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN laura|1234'
2025-11-23T18:00:03.518-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:00:03.526-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:00:03.528-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='laura' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T18:00:03.542-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura'
2025-11-23T18:00:03.542-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='laura' desde /192.168.40.12:58775
2025-11-23T18:00:03.544-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura desde /192.168.40.12:58775
2025-11-23T18:00:03.569-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T18:00:03.569-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:00:03.571-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:00:03.581-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:00:03.587-05:00  WARN 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T18:00:03.593-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:00:03.599-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:01:36.111-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49393
2025-11-23T18:01:36.121-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49393
2025-11-23T18:01:39.761-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49393
2025-11-23T18:01:39.762-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49393
2025-11-23T18:01:39.764-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49393
2025-11-23T18:01:39.768-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49393 conectado y saludado.
2025-11-23T18:01:39.771-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T18:01:39.776-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:01:39.786-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:01:39.792-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T18:01:39.794-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T18:01:39.794-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:49393
2025-11-23T18:01:39.794-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:49393
2025-11-23T18:01:39.813-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:01:39.814-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:01:39.816-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:01:39.826-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:01:39.835-05:00  WARN 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T18:01:39.845-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:01:39.851-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:01:39.857-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a manuel
2025-11-23T18:01:59.157-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|hola laura'
2025-11-23T18:01:59.161-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:01:59] Mensaje enviado por: manuel Para laura Contenido: hola laura
2025-11-23T18:01:59.175-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:01:59 Mensaje enviado por: manuel Para laura Contenido: hola laura (desde /192.168.40.12:49393)
2025-11-23T18:01:59.179-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:01:59.195-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:01:59.195-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:01:59.199-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:01:59.202-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=4 sesionId=null contenido='hola laura'
2025-11-23T18:01:59.212-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=4, tipo=TEXTO, sesionId=null
2025-11-23T18:02:08.798-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola manuel'
2025-11-23T18:02:08.806-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:02:08] Mensaje enviado por: laura Para manuel Contenido: hola manuel
2025-11-23T18:02:08.816-05:00  INFO 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:02:08 Mensaje enviado por: laura Para manuel Contenido: hola manuel (desde /192.168.40.12:58775)
2025-11-23T18:02:08.822-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:02:08.830-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:02:08.847-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:08.852-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:08.852-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=4 receptorId=1 sesionId=null contenido='hola manuel'
2025-11-23T18:02:08.852-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=4, receptorId=1, tipo=TEXTO, sesionId=null
2025-11-23T18:02:21.575-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR laura|1020-1030.txt|2876'
2025-11-23T18:02:21.582-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='laura' filename='1020-1030.txt' size='2876'
2025-11-23T18:02:21.587-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: 1020-1030.txt size=2876 desde /192.168.40.12:49393
2025-11-23T18:02:21.615-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA laura|1020-1030.txt|RW1wcmVzYXMgaW50ZWxpZ2VudGVzOiBldm9sdWNpw7NuIHkgY3JlY2ltaWVudG8gZW4gdGllbXBvcyBkZSBsYSBJQQ0KTGFzIGVtcHJlc2FzIG5vIGRlYmVuIHRlbmVybGUgbWllZG8gYSB1c2FyIGxhIGlhLCBkZWJlbiBpbnRlZ3JhcmxhIHJlc3BvbnNhYmxlbWVudGUgYSBzdXMgb3BlcmFjaW9uZXMgeSBjYXBhY2l0YXIgYSBzdXMgZW1wbGVhZG9zIGFjZXJjYSBkZSByaWVzZ29zIHkgYmVuZWZpY2lvcw0KDQpDdWx0dXJhIEFuYWzDrXRpY2E6IMK/Q8OzbW8gbm8gZGVtb2NyYXRpemFyIGVsIHVzbyBkZSBsb3MgZGF0b3MgZW4gb3JnYW5pemFjaW9uZXMgcMO6YmxpY2FzIHkgcHJpdmFkYXM/DQpUZW5lciBjdWlkYWRvIGNvbiBsb3MgZGF0b3Mgc2Vuc2libGVzIHF1ZSB0aWVuZW4gbG9zIGFnZW50ZXMsIGxhcyBlbXByZXNhcyBwdWVkZW4gdGVuZXIgYWdlbnRlcyBjZW50cmFsaXphZG9zIHByaXZhZG9zDQpDSU8gZXMgbMOtZGVyIGRlIGFuYWzDrXRpY2EsIG11Y2hhcyByZXNwb25zYWJpbGlkYWRlcw0KTWVkaWNpw7NuIGRlIGRhdG9zLCBnb2Jlcm5hbnphIGRlIGRhdG9zDQpBbmFsaXRpY2EgZGUgSUEgZW4gb3JncmFuaXphY2lvbmVzDQpTYW50aWFnbyBSZXN0cmVwbyBEaXJlY3RvciBEYXRhIHkgZXN0cmF0ZWdpYSBkZSBwdW50b3MgQ29sb21iaWENCkFuZHJlcyBDYXN0ZWxsYW5vcyBIZWFkIG9mIERhdGEgJiBBcnRpZmljaWFsIEludGVsbGlnZW5jZSBkZSBWbGFtZXJpY2FzIENvcnANCk5vcm1hIEVzcGlub3NhIERpcmVjdG9yIERhdG9zICYgQW5hbGl0aWNhIGRlIEdlbnRlcmENCkFuZHJlcyBCYXJyYW50ZXMgVlAgR2xvYmFsIEFXUyBQcmFjdGljZSBIZWFkIG9mIEJsZW5kDQoNCjExOjMwLTEyOjIwDQpBeXVkYXJzZSBkZSBsYSBJQSBwYXJhIHRlbmVyIHZlbnRhamEgY29tcGV0aXRpdmEsIG5vIGVzIGRlbWFzaWFkbyBjb21wbGVqbyBkZSB1c2FyIHkgcmVudGEgbXVjaG8gYXByZW5lciBhIG1hbmVqYXJsYSBwb3IgbGFzIGdhbmFuY2lhcyBxdWUgcHVlZGUgYnJpbmRhcg0KQmFzZXMgZGUgZGF0b3Mgb2x0cCBNaWNyb3NvZnQgeSBhenVyZSBvZnJlY2VuIGNhZGEgdW5vIHVuIG1vdG9yIGRiIGNvbiB0b2RvIHVuIHByb2R1Y3RvIGRlICwgQ29zbW9zIG9mcmVjZSB1bm8gTm8gT3NxbCwgbm90IG9ubHkNClNlIHF1aWVyZSB2ZXIgaW5mbyBlbiB0aWVtcG8gcmVhbCwgbm8gZXNwZXJhciBhIGxhIEVUTA0KT3BlcmFjaW9uZXMgdHJhbnNhY2Npb25hbGVzIHkgYW5hbGl0aWNhcyBlbiB1bmEgc29sYSBwZXRpY2lvbg0KDQpSdXRhIHBhcmEgZGVzYXJyb2xsbyBkZSBhcHAgZGUgaWEgYWxpbWVudGFkYSBjb24gZGF0YSBkZSBsYSBlbXByZXNhDQoxLiBlc3RhYmxlY2VyIHJlcG9zaXRvcmlvIGNlbnRyYXINCjIuIHByZXBhcmFyIGRhdGEgcGFyYSBpbm5vdmFjaW9uIGRlIGlhDQozLiBDcmVhciBwbGF0YWZvcm1hIHVuaWZpY2FkYSBkZSBpYQ0KNC4gY29uc3RydWlyIGV4cGVyaWVuY2lhcyBkZSBpYSBjb24gbGEgcHJvcGlhIGRhdGEgZGUgbGEgZW1wcmVzYQ0KDQpMYSBhY3R1YWxpZGFkIHNvbiBsb3MgYWdlbnRlcywgZWwgZnV0dXJvIGFnZW50ZXMgcXVlIGNvbnN1bHRhbiBhIGFnZW50ZXMgY29tbyBvcnF1ZXN0YSBtdXNpY2FsLiBTZSBkZWJlIHRlbmVyIGVuIGN1ZW50YSBjdWFuZG8geSBjb21vIHVuIGFnZW50ZSBlcyBtZWpvciBxdWUgb3RybywgcGFyYSBwb2RlciBlbGVnaXIgYmllbi4gTWljcm9zb2Z0IHBlcm1pdGUgdW5hIGdyYW4gdmFyaWVkYWQgZGUgb3BjaW9uZXMgcGFyYSB0ZW5lciBlbCBtZWpvciBkZXNlbXBlw7FvDQpNaWNyb3NvZnQgZmFicmljIHkgQXp1cmUgQUkgRm91bmRyeSBwZXJtaXRlbiBjcmVhciBhZ2VudGVzDQpFc3RvcyBhZ2VudGVzIHNlIHB1ZWRlbiBjb25zdW1pciBwb3Igb3Ryb3MgdXN1YXJpb3MsIGludGVybm9zIG8gZXh0ZXJub3MgYSBsYSBlbXByZXNhDQoNCg0KQ29uc3RydXllbmRvIEVxdWlwb3MgZGUgRGF0b3MgZW4gTEFUQU06IEF0cmFjY2nDs24sIFJldGVuY2nDs24geSBVcHNraWxsaW5nIHluIElBDQoNCkVtcHJlc2FzIG9mcmVjZW4gZmxleGliaWxpYWRlcyBsYWJvcmFsZXMgZW4gZXN0b3MgY2FtcG9zLCBsYXMgcGVyc29uYXMgc2UgdmFuIHBvciBjcmVjaW1pZW50byBwZXJzb25hbCB5IG1lam9yZXMgb2ZlcnRhcywgaGF5IHF1ZSBoYWNlciBjcmVjZXIgYSBsYXMgcGVyc29uYXMgZGVzZGUgbGFzIGVtcHJlc2FzDQpsYXMgcGVyc29uYXMgZGViZW4gc2VudGlyc2UgcGFydGUgZGUgbG9zIHByb3llY3RvcyBwYXJhIGV2aXRhciByb3RhY2lvbiBkZSBwZXJzb25hbCwgbGEgYWRhcHRhY2lvbiBhbnRlIGxvcyBjYW1iaW9zIGVzIGRpZmljaWwNCg0KU2UgbmVjZXNpdGFuIHByb2Zlc2lvbmFsZXMgZGUgZGF0b3MgZGFkbyBlbCBjcmVjaW1pZW50byBkZWwgbWVyY2FkbywgaGF5IG11Y2hvcyBlY29ub21pc3RhcywgZXN0YWRpc3RpY29zIG8gaW5nIGRlIHNpc3RlbWFzLCBwZXJvIG5vIHByb2Zlc2lvbmFsZXMgZGUgZGF0b3MNCg0KU2UgbWlkZSBtdWNobyBsYSBwcm9kdWN0aXZpZGFkIGRlIGxvcyByZXN1bHRhZG9zLCBwb2NvIGVsIGNyZWNpbWllbnRvIGRlIHBlcnNvbmFzDQpTZSBkZWJlIGNvbnN0cnVpciBlbCB0YWxlbnRvIGRlc2RlIG9yZ2FuaXphY2lvbmVzLCBsYSBpYSBwdWVkZSBzZXIgaGVycmFtaWVudGEgcGVybyBubyByZWVtcGxhem8sIGVsIHRhbGVudG8gaHVtYW5vIGRlYmUgc2VndWlyIHNpZW5kbyBsYSBhcHVlc3RhIGRlIGxhcyBlbXByZXNhcywgZGUgbGEgbWFubyBjb24gaWENCk5vIHRvZGFzIGxhcyBwbGF0YWZvcm1hcyBkZWJlbiBzZXIgdGFuIGdyYW5kZXMgbyBwZXF1ZcOxYXMgY29tbyBsYXMgbWFzIGZhbW9zYXMsIHNlIGRlYmUgYnVzY2FyIGZ1bmNpb25hbGlkYWQgbm8gaW1hZ2VuIGRlIHBvZGVyDQo='
2025-11-23T18:02:21.645-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: manuel -> laura : 1020-1030.txt (2876 bytes)
2025-11-23T18:02:21.666-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763938941649_manuel_1020-1030.txt
2025-11-23T18:02:21.666-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:21.678-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:21.730-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file '1020-1030.txt' using columns nombre_original / nombre_almacenado, id=1
2025-11-23T18:02:21.730-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:02:21.738-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:02:21.738-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=1 receptorId=4 archivoId=1
2025-11-23T18:02:21.738-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=4, tipo=ARCHIVO, sesionId=null
2025-11-23T18:02:32.676-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T18:02:32.677-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:02:32.680-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:02:34.579-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:63243
2025-11-23T18:02:34.591-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:63243
2025-11-23T18:02:37.978-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:63243
2025-11-23T18:02:37.980-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:63243
2025-11-23T18:02:37.982-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:63243
2025-11-23T18:02:37.982-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:63243 conectado y saludado.
2025-11-23T18:02:37.988-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T18:02:38.013-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:38.023-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:38.029-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T18:02:38.029-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T18:02:38.031-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:63243
2025-11-23T18:02:38.033-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:63243
2025-11-23T18:02:38.072-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:02:38.080-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:02:38.084-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:38.090-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:38.098-05:00  WARN 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T18:02:38.100-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:02:38.108-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:02:38.112-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T18:02:38.160-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T18:02:38.166-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T18:05:02.540-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T18:05:02.542-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:05:02.548-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:05:17.039-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64409
2025-11-23T18:05:17.044-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64409
2025-11-23T18:05:18.585-05:00  INFO 4660 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64409
2025-11-23T18:05:18.585-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64409
2025-11-23T18:05:18.586-05:00  INFO 4660 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64409
2025-11-23T18:05:18.588-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64409 conectado y saludado.
2025-11-23T18:05:18.589-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN manuel|1234'
2025-11-23T18:05:18.590-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:05:18.599-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:05:18.602-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Auth attempt user='manuel' providedHashPrefix='03ac6742' storedHashLen=64
2025-11-23T18:05:18.603-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel'
2025-11-23T18:05:18.603-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso (provisional): usuario='manuel' desde /192.168.40.12:64409
2025-11-23T18:05:18.604-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel desde /192.168.40.12:64409
2025-11-23T18:05:18.605-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:05:18.605-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:05:18.607-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:05:18.611-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:05:18.616-05:00  WARN 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : No se pudo crear sesion en BD: PreparedStatementCallback; bad SQL grammar [INSERT INTO sesiones (id,usuario_id,token,ip) VALUES (?,?,?,?)]
2025-11-23T18:05:18.619-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:05:18.624-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:05:18.631-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T18:05:18.662-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T18:05:18.673-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre_original as filename, nombre_almacenado as path, tamano as size, creado_en FROM archivos WHERE id = ?]
2025-11-23T18:05:31.026-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|mensaje para laura'
2025-11-23T18:05:31.034-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:05:31] Mensaje enviado por: manuel Para laura Contenido: mensaje para laura
2025-11-23T18:05:31.042-05:00  INFO 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:05:31 Mensaje enviado por: manuel Para laura Contenido: mensaje para laura (desde /192.168.40.12:64409)
2025-11-23T18:05:31.043-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:05:31.052-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:05:31.055-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:05:31.061-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=4 usuario='Laura'
2025-11-23T18:05:31.077-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=4 sesionId=null contenido='mensaje para laura'
2025-11-23T18:05:31.086-05:00 DEBUG 4660 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo_mensaje,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=4, tipo=TEXTO, sesionId=null
2025-11-23T18:38:30.687-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 12856 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T18:38:30.690-05:00 DEBUG 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T18:38:30.692-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T18:38:32.371-05:00  INFO 12856 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T18:38:32.390-05:00  INFO 12856 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T18:38:32.390-05:00  INFO 12856 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T18:38:32.474-05:00  INFO 12856 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T18:38:32.474-05:00  INFO 12856 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1710 ms
2025-11-23T18:38:32.717-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-23T18:38:32.757-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-23T18:38:32.757-05:00  INFO 12856 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T18:38:33.128-05:00  INFO 12856 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@72a2312e
2025-11-23T18:38:33.128-05:00  INFO 12856 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T18:38:33.188-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-23T18:38:33.242-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T18:38:33.450-05:00  INFO 12856 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T18:38:33.842-05:00  INFO 12856 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T18:38:33.854-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.801 seconds (process running for 4.245)
2025-11-23T18:38:33.861-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T18:38:33.862-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T18:38:33.874-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T18:38:33.922-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T18:38:34.232-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T18:38:34.233-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T18:38:34.234-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T18:38:34.234-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T18:38:34.235-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T18:38:34.235-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T18:38:34.273-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-23T18:38:34.275-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-23T18:38:34.277-05:00  INFO 12856 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T18:39:05.928-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49671
2025-11-23T18:39:05.934-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49671
2025-11-23T18:39:08.067-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49671
2025-11-23T18:39:08.068-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49671
2025-11-23T18:39:08.068-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49671
2025-11-23T18:39:08.077-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49671 conectado y saludado.
2025-11-23T18:39:08.077-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|manuel|1234'
2025-11-23T18:39:08.095-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:39:08.100-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='manuel' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:39:08.125-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'manuel' (id=1) registrado en DB
2025-11-23T18:39:08.125-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'manuel' (id=1) desde /192.168.40.12:49671
2025-11-23T18:39:08.125-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: manuel (id=1) desde /192.168.40.12:49671
2025-11-23T18:39:08.125-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-23T18:39:08.139-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-23T18:39:15.073-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T18:39:15.077-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T18:39:15.078-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:49671
2025-11-23T18:39:15.079-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:49671
2025-11-23T18:39:15.080-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:39:15.083-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T18:39:15.083-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:39:15.087-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:39:15.126-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=b0db89b6-2ec2-4d69-859a-c5cc11bf202d
2025-11-23T18:39:15.126-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:39:15.126-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:39:19.141-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T18:39:19.143-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:39:19.143-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T18:39:23.404-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:52554
2025-11-23T18:39:23.411-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:52554
2025-11-23T18:39:25.313-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:52554
2025-11-23T18:39:25.314-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:52554
2025-11-23T18:39:25.314-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:52554
2025-11-23T18:39:25.316-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:52554 conectado y saludado.
2025-11-23T18:39:25.316-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|manuel|1234'
2025-11-23T18:39:25.320-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:39:25.320-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 2
2025-11-23T18:39:25.321-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='2' desde /192.168.40.12:52554
2025-11-23T18:39:25.325-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 2 desde /192.168.40.12:52554
2025-11-23T18:39:31.380-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|laura|1234'
2025-11-23T18:39:31.381-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:39:31.384-05:00  WARN 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='laura' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:39:31.407-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'laura' (id=2) registrado en DB
2025-11-23T18:39:31.408-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'laura' (id=2) desde /192.168.40.12:52554
2025-11-23T18:39:31.408-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: laura (id=2) desde /192.168.40.12:52554
2025-11-23T18:39:31.411-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-23T18:39:31.412-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-23T18:39:38.940-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|laura|1234'
2025-11-23T18:39:38.944-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura' id=2
2025-11-23T18:39:38.944-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='laura' id=2 desde /192.168.40.12:52554
2025-11-23T18:39:38.945-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura (id=2) desde /192.168.40.12:52554
2025-11-23T18:39:38.945-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T18:39:38.945-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:39:38.946-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:39:38.949-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:39:38.963-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario laura id=ade6fccb-6727-4b76-891a-3ce57e5a3703
2025-11-23T18:39:38.963-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:39:38.975-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:40:03.058-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49672
2025-11-23T18:40:03.064-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49672
2025-11-23T18:40:05.090-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49672
2025-11-23T18:40:05.091-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49672
2025-11-23T18:40:05.092-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49672
2025-11-23T18:40:05.094-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49672 conectado y saludado.
2025-11-23T18:40:05.095-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|laura|1234'
2025-11-23T18:40:05.100-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura' id=2
2025-11-23T18:40:05.100-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='laura' id=2 desde /192.168.40.12:49672
2025-11-23T18:40:05.100-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura (id=2) desde /192.168.40.12:49672
2025-11-23T18:40:05.100-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'laura' desde la misma IP 192.168.40.12 (ya conectado)
2025-11-23T18:40:05.104-05:00  WARN 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'laura' desde 192.168.40.12 motivo=Error: Limite de ips excedido, no puede ingresar en este equipo
2025-11-23T18:40:17.477-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T18:40:17.480-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T18:40:17.481-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:49672
2025-11-23T18:40:17.481-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:49672
2025-11-23T18:40:17.482-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:40:17.482-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:40:17.483-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:40:17.486-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:40:17.509-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=a182664a-c166-4966-b406-42dfcf973f95
2025-11-23T18:40:17.509-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:40:17.513-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:40:28.714-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:54522
2025-11-23T18:40:28.731-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:54522
2025-11-23T18:40:31.151-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:54522
2025-11-23T18:40:31.152-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:54522
2025-11-23T18:40:31.152-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:54522
2025-11-23T18:40:31.154-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:54522 conectado y saludado.
2025-11-23T18:40:31.155-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 3|hector|1234'
2025-11-23T18:40:31.159-05:00  WARN 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='3' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:40:31.160-05:00  WARN 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 3
2025-11-23T18:40:31.160-05:00  WARN 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='3' desde /192.168.40.12:54522
2025-11-23T18:40:31.162-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 3 desde /192.168.40.12:54522
2025-11-23T18:40:34.952-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 3|hector|1234'
2025-11-23T18:40:34.953-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T18:40:34.955-05:00  WARN 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='hector' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-23T18:40:34.960-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Usuario 'hector' (id=3) registrado en DB
2025-11-23T18:40:34.960-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'hector' (id=3) desde /192.168.40.12:54522
2025-11-23T18:40:34.961-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: hector (id=3) desde /192.168.40.12:54522
2025-11-23T18:40:34.964-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 3
2025-11-23T18:40:34.964-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 3
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 3|hector|1234'
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='hector' id=3
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='hector' id=3 desde /192.168.40.12:54522
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: hector (id=3) desde /192.168.40.12:54522
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: hector (user-conns=1)
2025-11-23T18:40:43.419-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 3 clients: hector,laura,manuel
2025-11-23T18:40:43.419-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T18:40:43.432-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T18:40:43.451-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario hector id=b15f6d8e-ac21-4699-9ca0-fc8fb15b9dbd
2025-11-23T18:40:43.451-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='hector' usando columna='nombre_usuario'
2025-11-23T18:40:43.451-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='hector'
2025-11-23T18:41:01.900-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|hola manuek'
2025-11-23T18:41:01.900-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:41:01] Mensaje enviado por: laura Para manuel Contenido: hola manuek
2025-11-23T18:41:01.906-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:41:01 Mensaje enviado por: laura Para manuel Contenido: hola manuek (desde /192.168.40.12:52554)
2025-11-23T18:41:01.909-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:01.911-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:01.915-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:01.918-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:01.920-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=ade6fccb-6727-4b76-891a-3ce57e5a3703 contenido='hola manuek'
2025-11-23T18:41:01.926-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=ade6fccb-6727-4b76-891a-3ce57e5a3703
2025-11-23T18:41:07.988-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG manuel|voy a enviarle un archivo'
2025-11-23T18:41:07.988-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:41:07] Mensaje enviado por: laura Para manuel Contenido: voy a enviarle un archivo
2025-11-23T18:41:07.988-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:41:07 Mensaje enviado por: laura Para manuel Contenido: voy a enviarle un archivo (desde /192.168.40.12:52554)
2025-11-23T18:41:07.988-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:07.998-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:07.998-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:08.003-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:08.004-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=ade6fccb-6727-4b76-891a-3ce57e5a3703 contenido='voy a enviarle un archivo'
2025-11-23T18:41:08.004-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=ade6fccb-6727-4b76-891a-3ce57e5a3703
2025-11-23T18:41:12.537-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|hola laura'
2025-11-23T18:41:12.537-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:41:12] Mensaje enviado por: manuel Para laura Contenido: hola laura
2025-11-23T18:41:12.543-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:41:12 Mensaje enviado por: manuel Para laura Contenido: hola laura (desde /192.168.40.12:49672)
2025-11-23T18:41:12.545-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:12.549-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:12.551-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:12.555-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:12.555-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=a182664a-c166-4966-b406-42dfcf973f95 contenido='hola laura'
2025-11-23T18:41:12.557-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=a182664a-c166-4966-b406-42dfcf973f95
2025-11-23T18:41:13.336-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG laura|ok'
2025-11-23T18:41:13.336-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-23 18:41:13] Mensaje enviado por: manuel Para laura Contenido: ok
2025-11-23T18:41:13.336-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-23 18:41:13 Mensaje enviado por: manuel Para laura Contenido: ok (desde /192.168.40.12:49672)
2025-11-23T18:41:13.336-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:13.346-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:13.350-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:13.354-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:13.354-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=a182664a-c166-4966-b406-42dfcf973f95 contenido='ok'
2025-11-23T18:41:13.354-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=a182664a-c166-4966-b406-42dfcf973f95
2025-11-23T18:41:27.824-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR manuel|Tipos de mensaje avanzadas.txt|2038'
2025-11-23T18:41:27.824-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='manuel' filename='Tipos de mensaje avanzadas.txt' size='2038'
2025-11-23T18:41:27.824-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: Tipos de mensaje avanzadas.txt size=2038 desde /192.168.40.12:52554
2025-11-23T18:41:27.842-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA manuel|Tipos de mensaje avanzadas.txt|Ly8vLy8vLy8NCkFwbGljYWNpw7NuIGNsaWVudGUgc2Vydmlkb3IgcGFyYSBlbCBpbnRlcmNhbWJpbyBkZSBpbmZvcm1hY2nDs24gZW50cmUgdXN1YXJpb3MuIHB1ZWRlbiBpbnRlcmNhbWJpYXIgaW5mb3JtYWNpw7NuIGJhc2FkYSBlbiBtZW5zYWplcyBkZSB0ZXh0byB5IGFyY2hpdm9zICggdGV4dG8gbyBiaW5hcmlvICkNCkVsIHNlcnZpZG9yIHBvZHLDoSByZWNpYmlyIHZhcmlhcyBjb25leGlvbmVzIHNpbXVsdGFuZWFzIHBhcmEgZWwgcHJvY2VzYW1pZW50byBkZSBtZW5zYWplcywgZGViZXLDoW4gYXBsaWNhciBlbCBjb25jZXB0byBkZSBwcm9ncmFtYWNpw7NuIGNvbmN1cnJlbnRlIGNvbiBoaWxvcyBwYXJhIGdlc3Rpb25hciBsYXMgY29uZXhpb25lcw0KVG9kYSBsYSBpbmZvcm1hY2nDs24gZGVsIHNlcnZpZG9yIGRlYmUgc2VyIGFsbWFjZW5hZGEgZW4gbGEgYmFzZSBkZSBkYXRvcyByZWxhY2lvbmFsOyBlajogc3FsLCBPcmFjbGUNCkxvcyB1c3VhcmlvcyBzZSBkZWJlbiBjcmVhciBkZXNkZSBsYSBhcHAgZGUgY2xpZW50ZSwgcGVybyBzZSBhY2VwdGFuIGRlc2RlIGVsIHNlcnZpZG9yLCBzb2xvIHB1ZWRlbiBjb25lY3RhcnNlIGx1ZWdvIGRlIHNlciBhY2VwdGFkb3MNClVuIHVzdWFyaW8gcHVlZGUgdGVuZXIgbWFzIGRlIDEgY29uZXhpw7NuIGRlc2RlIG1hcyBkZSAxIGRpc3Bvc2l0aXZvDQpFbCBzZXJ2aWRvciBkZWJlIG1vc3RyYXIgcG9yIGNvbnNvbGEgdG9kYXMgbGFzIGFjY2lvbmVzIHF1ZSBzZSBlc3TDoW4gZWplY3V0YW5kbw0KRWwgc2Vydmlkb3IgbGltaXRhIGxhIGNhbnRpZGFkIGRlIGNvbmV4aW9uZXMgcG9yIHVzdWFyaW8NCkxhIGNvbmV4acOzbiBlbnRyZSBzZXJ2aWRvciBjbGllbnRlcyBzZSBoYWNlIGEgdHJhdsOpcyBkZSBwcm90b2NvbG8gdGNwIGlwDQpMb3MgdXN1YXJpb3MgcHVlZGVuIGRlc2NhcmdhciBsb3MgYXJjaGl2b3MgZW52aWFkb3MNCkxhIGFwbGljYWNpw7NuIGNsaWVudGUgaW1wbGVtZW50YXJhIGZvcm11bGFyaW9zIG1hZXN0cm8tZGV0YWxsZSBwYXJhIG1vc3RyYXIgbGEgaW5mb3JtYWNpw7NuIGFzb2NpYWRhIGFsIHVzdWFyaW8NCg0KVW5hIGFwbGljYWNpw7NuIHdlYiBtdmMgbXXDqXN0cmFsbyBzaWd1aWVudGUNCkxpc3RhZG8gZGUgdXN1YXJpb3MgcmVnaXN0cmFkb3MNCk1lbnNhamVzIGRlIGxvcyB1c3VhcmlvcywgY2xhc2lmaWNhZG9zIHBvciBlbCB0aXBvIGRlIG1lbnNhamUuIFZlciBkZXRhbGxlIGRlIG1lbnNhamUsIGluY2x1eWUgZGVzY2FyZ2FyIGFyY2hpdm9zLg0KTW9zdHJhciBsb3Mgc2lndWllbnRlcyBpbmZvcm1lcw0KVXN1YXJpbyBjb24gbWFzIG1lbnNhamVzIGVudmlhZG9zOiBtb3N0cmFyIGNhbnRpZGFkDQpBcmNoaXZvcyBlbnZpYWRvcywgbGlzdGFyIHBvciB0YW1hw7FvIHkgbW9zdHJhciBwcm9waWV0YXJpbw0KTGlzdGEgZGUgdXN1YXJpb3MgY29uZWN0YWRvcyB5IGluZm9ybWFjacOzbjogSXAsIGhvcmEgZGUgY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQpMaXN0YSBkZSB1c3VhcmlvcyBkZXNjb25lY3RhZG9zIHkgaW5mb3JtYWNpw7NuOiBJcCwgaG9yYSBkZSBjb25leGnDs24sIGhvcmEgZGUgZGVzY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQoNCg0KVW4gc2VydmljaW8gd2ViIGRlIGFwaSByZXN0IHBhcmEgbW9zdHJhciBsbyBzaWd1aWVudGU6DQpJbmZvcm1hY2nDs24gY29tcGxldGEgZGUgdXN1YXJpbzogTm9tYnJlLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcywgY2FudGlkYWQgZGUgbWVuc2FqZXMgcmVjaWJpZG9zLCBmZWNoYSB5IGhvcmEgZGUgdWx0aW1hIGNvbmV4acOzbiwgZXN0YWRvIChkZXNjb25lY3RhZG8vY29uZWN0YWRvKQ0KTGlzdGEgZGUgbWVuc2FqZXMgZW52aWFkb3MgKElwIHVzdWFyaW8saXAgdXN1YXJpbyByZW1vdG8sZmVjaGEsaG9yYSkNCkxpc3RhIGRlIG1lbnNhamVzIHJlY2liaWRvcyAoSXAgdXN1YXJpbyxpcCB1c3VhcmlvIHJlbW90byxmZWNoYSxob3JhKQ=='
2025-11-23T18:41:27.853-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: laura -> manuel : Tipos de mensaje avanzadas.txt (2038 bytes)
2025-11-23T18:41:27.860-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1763941287853_laura_Tipos de mensaje avanzadas.txt
2025-11-23T18:41:27.865-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:41:27.869-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:41:27.889-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'Tipos de mensaje avanzadas.txt' using columns nombre / ruta, id=1
2025-11-23T18:41:27.889-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:41:27.902-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:41:27.902-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=2 receptorId=1 archivoId=1
2025-11-23T18:41:27.902-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=ARCHIVO, sesionId=null
2025-11-23T18:41:38.573-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Usuario 'hector' desconectado.
2025-11-23T18:41:38.574-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario hector desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:41:38.575-05:00  INFO 12856 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:42:31.130-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T18:42:31.131-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:42:31.132-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: laura
2025-11-23T18:42:33.113-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:60857
2025-11-23T18:42:33.117-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:60857
2025-11-23T18:42:36.423-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:60857
2025-11-23T18:42:36.423-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:60857
2025-11-23T18:42:36.423-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:60857
2025-11-23T18:42:36.425-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:60857 conectado y saludado.
2025-11-23T18:42:36.426-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:60857
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:60857
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T18:42:36.430-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:42:36.433-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:42:36.435-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:42:36.461-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=68e02855-dbd2-421c-a20b-871a769af289
2025-11-23T18:42:36.462-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T18:42:36.465-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T18:42:36.469-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T18:42:36.532-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T18:44:17.437-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T18:44:17.438-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T18:44:17.439-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T18:44:19.054-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:60194
2025-11-23T18:44:19.060-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:60194
2025-11-23T18:44:21.772-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: RECHAZADA para /192.168.40.12:60194
2025-11-23T18:44:21.773-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión rechazada desde /192.168.40.12:60194
2025-11-23T18:44:21.773-05:00  WARN 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión rechazada manualmente desde /192.168.40.12:60194
2025-11-23T18:44:23.619-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:51925
2025-11-23T18:44:23.624-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:51925
2025-11-23T18:44:25.880-05:00  INFO 12856 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:51925
2025-11-23T18:44:25.880-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:51925
2025-11-23T18:44:25.880-05:00  INFO 12856 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:51925
2025-11-23T18:44:25.882-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:51925 conectado y saludado.
2025-11-23T18:44:25.882-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|laura|1234'
2025-11-23T18:44:25.886-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='laura' id=2
2025-11-23T18:44:25.886-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='laura' id=2 desde /192.168.40.12:51925
2025-11-23T18:44:25.887-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: laura (id=2) desde /192.168.40.12:51925
2025-11-23T18:44:25.888-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: laura (user-conns=1)
2025-11-23T18:44:25.890-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: laura,manuel
2025-11-23T18:44:25.892-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:44:25.898-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:44:25.921-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario laura id=3197853d-22b6-433f-9dc7-63cb0019aeb9
2025-11-23T18:44:25.921-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='laura' usando columna='nombre_usuario'
2025-11-23T18:44:25.924-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='laura'
2025-11-23T18:44:25.927-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a laura
2025-11-23T18:44:25.953-05:00 DEBUG 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T19:04:24.637-05:00 ERROR 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:51925: java.net.SocketException: Connection reset
2025-11-23T19:04:24.639-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'laura' desconectado.
2025-11-23T19:04:24.639-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario laura desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T19:04:24.639-05:00  INFO 12856 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T19:04:26.981-05:00 ERROR 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /192.168.40.12:60857: java.net.SocketException: Connection reset
2025-11-23T19:04:26.982-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T19:04:26.982-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T19:04:26.983-05:00  INFO 12856 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T19:59:47.097-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 16044 (C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal)
2025-11-23T19:59:47.097-05:00 DEBUG 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-23T19:59:47.097-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-23T19:59:48.836-05:00  INFO 16044 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-23T19:59:48.853-05:00  INFO 16044 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-23T19:59:48.853-05:00  INFO 16044 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-23T19:59:48.930-05:00  INFO 16044 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-23T19:59:48.931-05:00  INFO 16044 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1760 ms
2025-11-23T19:59:49.091-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-23T19:59:49.132-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-23T19:59:49.132-05:00  INFO 16044 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-23T19:59:49.535-05:00  INFO 16044 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4ed9f7b1
2025-11-23T19:59:49.546-05:00  INFO 16044 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-23T19:59:49.598-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-23T19:59:49.663-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 192.168.40.12:9001
2025-11-23T19:59:49.769-05:00  INFO 16044 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-23T19:59:50.187-05:00  INFO 16044 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-23T19:59:50.197-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.93 seconds (process running for 4.593)
2025-11-23T19:59:50.197-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=192.168.40.12, port=9010
2025-11-23T19:59:50.197-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-23T19:59:50.212-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-23T19:59:50.264-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-23T19:59:50.653-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-23T19:59:50.653-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-23T19:59:50.653-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-23T19:59:50.660-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-23T19:59:50.660-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-23T19:59:50.660-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-23T19:59:50.693-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-23T19:59:50.697-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-23T19:59:50.699-05:00  INFO 16044 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\avanzadasDevelop\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-23T20:00:12.608-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:64099
2025-11-23T20:00:12.620-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:64099
2025-11-23T20:00:14.962-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:64099
2025-11-23T20:00:14.962-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:64099
2025-11-23T20:00:14.962-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:64099
2025-11-23T20:00:14.990-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:64099 conectado y saludado.
2025-11-23T20:00:14.994-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T20:00:15.030-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T20:00:15.032-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:64099
2025-11-23T20:00:15.034-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:64099
2025-11-23T20:00:15.034-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T20:00:15.038-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T20:00:15.040-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T20:00:15.046-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T20:00:15.080-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=98ae76ca-62a9-4a1a-8c89-1b7fe806c8a9
2025-11-23T20:00:15.080-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T20:00:15.093-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T20:00:15.100-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T20:00:15.185-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T20:00:35.117-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-23T20:00:35.118-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario manuel desconectado desde 192.168.40.12 (user-conns=0)
2025-11-23T20:00:35.120-05:00  INFO 16044 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-23T20:02:56.927-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /192.168.40.12:49772
2025-11-23T20:02:56.933-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /192.168.40.12:49772
2025-11-23T20:02:59.059-05:00  INFO 16044 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /192.168.40.12:49772
2025-11-23T20:02:59.061-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /192.168.40.12:49772
2025-11-23T20:02:59.061-05:00  INFO 16044 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /192.168.40.12:49772
2025-11-23T20:02:59.065-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /192.168.40.12:49772 conectado y saludado.
2025-11-23T20:02:59.065-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|manuel|1234'
2025-11-23T20:02:59.083-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='manuel' id=1
2025-11-23T20:02:59.085-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='manuel' id=1 desde /192.168.40.12:49772
2025-11-23T20:02:59.087-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: manuel (id=1) desde /192.168.40.12:49772
2025-11-23T20:02:59.094-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: manuel (user-conns=1)
2025-11-23T20:02:59.096-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: manuel
2025-11-23T20:02:59.098-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T20:02:59.102-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T20:02:59.115-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario manuel id=a87518e8-7bc8-4f9a-a742-2d8d78aca148
2025-11-23T20:02:59.115-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='manuel' usando columna='nombre_usuario'
2025-11-23T20:02:59.121-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='manuel'
2025-11-23T20:02:59.125-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 5 mensajes históricos desde BD a manuel
2025-11-23T20:02:59.174-05:00 DEBUG 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-23T20:06:20.835-05:00  INFO 16044 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'manuel' desconectado.
2025-11-24T19:07:29.746-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 13104 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:07:29.749-05:00 DEBUG 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:07:29.750-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:07:32.089-05:00  INFO 13104 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:07:32.101-05:00  INFO 13104 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:07:32.101-05:00  INFO 13104 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:07:32.171-05:00  INFO 13104 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:07:32.172-05:00  INFO 13104 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2368 ms
2025-11-24T19:07:32.264-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:07:32.285-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:07:32.286-05:00  INFO 13104 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-24T19:07:34.291-05:00 ERROR 13104 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Exception during pool initialization.

com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:175) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:819) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:440) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:239) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:188) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112) ~[HikariCP-5.0.1.jar:na]
	at com.proyecto.demo.dao.JdbcMessageDao.detectColumns(JdbcMessageDao.java:65) ~[classes/:na]
	at com.proyecto.demo.dao.JdbcMessageDao.<init>(JdbcMessageDao.java:25) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstance(Unknown Source) ~[na:na]
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:210) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:111) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:319) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:310) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1193) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1441) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1348) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:911) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:789) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:241) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1193) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1441) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1348) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:769) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:752) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:493) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1420) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946) ~[spring-context-6.1.1.jar:6.1.1]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616) ~[spring-context-6.1.1.jar:6.1.1]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331) ~[spring-boot-3.2.0.jar:3.2.0]
	at com.proyecto.demo.DemoApplication.main(DemoApplication.java:73) ~[classes/:na]
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstance(Unknown Source) ~[na:na]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:62) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:150) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:166) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:582) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readServerCapabilities(NativeProtocol.java:537) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.beforeHandshake(NativeProtocol.java:424) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.connect(NativeProtocol.java:1428) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.NativeSession.connect(NativeSession.java:134) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:939) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:809) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	... 65 common frames omitted
Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:67) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeaderLocal(SimplePacketReader.java:81) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:576) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	... 71 common frames omitted

2025-11-24T19:07:34.296-05:00 DEBUG 13104 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : detectColumns mensajes failed: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
2025-11-24T19:07:34.298-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:07:34.298-05:00  INFO 13104 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-24T19:07:35.305-05:00 ERROR 13104 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Exception during pool initialization.

com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:175) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:819) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:440) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:239) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:188) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112) ~[HikariCP-5.0.1.jar:na]
	at com.proyecto.demo.dao.JdbcArchivoDao.detectColumns(JdbcArchivoDao.java:30) ~[classes/:na]
	at com.proyecto.demo.dao.JdbcArchivoDao.<init>(JdbcArchivoDao.java:21) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstance(Unknown Source) ~[na:na]
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:210) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:111) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:319) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:310) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1193) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1441) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1348) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:911) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:789) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:241) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1193) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1441) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1348) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:769) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:752) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:145) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:493) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1420) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:973) ~[spring-beans-6.1.1.jar:6.1.1]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:946) ~[spring-context-6.1.1.jar:6.1.1]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:616) ~[spring-context-6.1.1.jar:6.1.1]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:455) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:323) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331) ~[spring-boot-3.2.0.jar:3.2.0]
	at com.proyecto.demo.DemoApplication.main(DemoApplication.java:73) ~[classes/:na]
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstance(Unknown Source) ~[na:na]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:62) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:150) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:166) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:582) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readServerCapabilities(NativeProtocol.java:537) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.beforeHandshake(NativeProtocol.java:424) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.connect(NativeProtocol.java:1428) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.NativeSession.connect(NativeSession.java:134) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:939) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:809) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	... 65 common frames omitted
Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:67) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeaderLocal(SimplePacketReader.java:81) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:576) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	... 71 common frames omitted

2025-11-24T19:07:35.319-05:00  INFO 13104 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:07:35.388-05:00  INFO 13104 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:07:37.416-05:00  INFO 13104 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:07:37.430-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 8.138 seconds (process running for 8.577)
2025-11-24T19:07:37.433-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:07:37.435-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:07:37.443-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:07:46.799-05:00  INFO 13104 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:07:47.969-05:00  INFO 13104 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:07:47.971-05:00  INFO 13104 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:07:47.972-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:07:47.972-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:07:47.972-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:07:47.972-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:07:47.980-05:00  INFO 13104 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-24T19:07:49.001-05:00 ERROR 13104 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Exception during pool initialization.

com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:175) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:819) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:440) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:239) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:188) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.datasource.DataSourceUtils.fetchConnection(DataSourceUtils.java:160) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:118) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:81) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:388) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:476) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:486) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:519) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:526) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.DemoApplication.run(DemoApplication.java:132) ~[classes/:na]
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:786) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:770) ~[spring-boot-3.2.0.jar:3.2.0]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(Unknown Source) ~[na:na]
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(Unknown Source) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.copyInto(Unknown Source) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(Unknown Source) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(Unknown Source) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(Unknown Source) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.evaluate(Unknown Source) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline.forEach(Unknown Source) ~[na:na]
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:765) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:330) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331) ~[spring-boot-3.2.0.jar:3.2.0]
	at com.proyecto.demo.DemoApplication.main(DemoApplication.java:73) ~[classes/:na]
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstance(Unknown Source) ~[na:na]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:62) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:150) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:166) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:582) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readServerCapabilities(NativeProtocol.java:537) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.beforeHandshake(NativeProtocol.java:424) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.connect(NativeProtocol.java:1428) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.NativeSession.connect(NativeSession.java:134) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:939) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:809) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	... 34 common frames omitted
Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:67) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeaderLocal(SimplePacketReader.java:81) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:576) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	... 40 common frames omitted

2025-11-24T19:07:49.005-05:00 ERROR 13104 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check FAILED: CannotGetJdbcConnectionException - Failed to obtain JDBC Connection

org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:84) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:388) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:476) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:486) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:519) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:526) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.DemoApplication.run(DemoApplication.java:132) ~[classes/:na]
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:786) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:770) ~[spring-boot-3.2.0.jar:3.2.0]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(Unknown Source) ~[na:na]
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(Unknown Source) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.copyInto(Unknown Source) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(Unknown Source) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(Unknown Source) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(Unknown Source) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.evaluate(Unknown Source) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline.forEach(Unknown Source) ~[na:na]
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:765) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:330) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1342) ~[spring-boot-3.2.0.jar:3.2.0]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1331) ~[spring-boot-3.2.0.jar:3.2.0]
	at com.proyecto.demo.DemoApplication.main(DemoApplication.java:73) ~[classes/:na]
Caused by: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:175) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:819) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:440) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:239) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:188) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:359) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:201) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:470) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:100) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.datasource.DataSourceUtils.fetchConnection(DataSourceUtils.java:160) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:118) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:81) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 21 common frames omitted
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source) ~[na:na]
	at java.base/java.lang.reflect.Constructor.newInstance(Unknown Source) ~[na:na]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:62) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:150) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:166) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:582) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readServerCapabilities(NativeProtocol.java:537) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.beforeHandshake(NativeProtocol.java:424) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.connect(NativeProtocol.java:1428) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.NativeSession.connect(NativeSession.java:134) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:939) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:809) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	... 34 common frames omitted
Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:67) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeaderLocal(SimplePacketReader.java:81) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:576) ~[mysql-connector-j-8.1.0.jar:8.1.0]
	... 40 common frames omitted

2025-11-24T19:07:49.006-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check FAILED: CannotGetJdbcConnectionException - Failed to obtain JDBC Connection
2025-11-24T19:07:49.008-05:00  INFO 13104 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:09:01.380-05:00  INFO 13104 --- [servidor] [tcpserver-shutdown-hook] com.proyecto.demo.server.TcpServer       : Shutting down TcpServer...
2025-11-24T19:09:01.386-05:00  INFO 13104 --- [servidor] [tcpserver-shutdown-hook] com.proyecto.demo.server.TcpServer       : TcpServer shutdown complete
2025-11-24T19:27:45.390-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 15872 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:27:45.391-05:00 DEBUG 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:27:45.392-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:27:46.401-05:00  INFO 15872 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:27:46.412-05:00  INFO 15872 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:27:46.413-05:00  INFO 15872 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:27:46.541-05:00  INFO 15872 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:27:46.541-05:00  INFO 15872 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1098 ms
2025-11-24T19:27:46.623-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:27:46.643-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:27:46.644-05:00  INFO 15872 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-24T19:27:46.918-05:00  INFO 15872 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@63f855b
2025-11-24T19:27:46.920-05:00  INFO 15872 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-24T19:27:47.022-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:27:47.065-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:27:47.067-05:00  INFO 15872 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:27:47.088-05:00  INFO 15872 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:27:47.093-05:00  INFO 15872 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:27:48.321-05:00  INFO 15872 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:27:48
2025-11-24T19:27:48.375-05:00  INFO 15872 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:27:48.629-05:00  INFO 15872 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:27:48.635-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.648 seconds (process running for 3.92)
2025-11-24T19:27:48.637-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:27:48.637-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:27:48.646-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:27:48.682-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:27:48.922-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:27:48.922-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:27:48.922-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:27:48.922-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:27:48.922-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:27:48.923-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:27:48.957-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:27:48.957-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:27:48.958-05:00  INFO 15872 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:28:32.570-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:57341
2025-11-24T19:28:32.574-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:57341
2025-11-24T19:28:34.984-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:57341
2025-11-24T19:28:34.985-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:57341
2025-11-24T19:28:34.985-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:57341
2025-11-24T19:28:34.992-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:57341 conectado y saludado.
2025-11-24T19:28:34.993-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|mysql1|1234'
2025-11-24T19:28:35.001-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:28:35.005-05:00  WARN 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:28:35.033-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql1' (id=1) registrado en DB
2025-11-24T19:28:35.034-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql1' (id=1) desde /172.29.96.1:57341
2025-11-24T19:28:35.034-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql1 (id=1) desde /172.29.96.1:57341
2025-11-24T19:28:35.036-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T19:28:35.037-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T19:28:50.451-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T19:28:50.455-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T19:28:50.455-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:57341
2025-11-24T19:28:50.456-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:57341
2025-11-24T19:28:50.456-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T19:28:50.456-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T19:28:50.457-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:28:50.459-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:28:50.646-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=a191a63e-dd2f-4bca-ad2e-48a57272f6c7
2025-11-24T19:28:50.647-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:28:50.657-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:29:04.798-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:57344
2025-11-24T19:29:04.802-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:57344
2025-11-24T19:29:06.961-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:57344
2025-11-24T19:29:06.961-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:57344
2025-11-24T19:29:06.961-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:57344
2025-11-24T19:29:06.963-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:57344 conectado y saludado.
2025-11-24T19:29:06.964-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|mysql2|1234'
2025-11-24T19:29:06.964-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:29:06.971-05:00  WARN 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:29:07.012-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql2' (id=2) registrado en DB
2025-11-24T19:29:07.013-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql2' (id=2) desde /172.29.96.1:57344
2025-11-24T19:29:07.013-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql2 (id=2) desde /172.29.96.1:57344
2025-11-24T19:29:07.016-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-24T19:29:07.016-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-24T19:29:16.757-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|mysql2|1234'
2025-11-24T19:29:16.760-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql2' id=2
2025-11-24T19:29:16.760-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql2' id=2 desde /172.29.96.1:57344
2025-11-24T19:29:16.760-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql2 (id=2) desde /172.29.96.1:57344
2025-11-24T19:29:16.761-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql2 (user-conns=1)
2025-11-24T19:29:16.761-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql2
2025-11-24T19:29:16.761-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:29:16.765-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:29:16.869-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql2 id=9077c95a-d2ab-4446-8b89-9697f20d3673
2025-11-24T19:29:16.869-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:29:16.871-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:29:22.356-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql1|hola, testeo'
2025-11-24T19:29:22.356-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:29:22] Mensaje enviado por: mysql2 Para mysql1 Contenido: hola, testeo
2025-11-24T19:29:22.357-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:29:22 Mensaje enviado por: mysql2 Para mysql1 Contenido: hola, testeo (desde /172.29.96.1:57344)
2025-11-24T19:29:22.358-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:29:22.366-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:29:22.367-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:29:22.382-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:29:22.383-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=9077c95a-d2ab-4446-8b89-9697f20d3673 contenido='hola, testeo'
2025-11-24T19:29:22.383-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=9077c95a-d2ab-4446-8b89-9697f20d3673
2025-11-24T19:29:33.524-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql2|hola, respuesta a testeo'
2025-11-24T19:29:33.525-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:29:33] Mensaje enviado por: mysql1 Para mysql2 Contenido: hola, respuesta a testeo
2025-11-24T19:29:33.525-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:29:33 Mensaje enviado por: mysql1 Para mysql2 Contenido: hola, respuesta a testeo (desde /172.29.96.1:57341)
2025-11-24T19:29:33.526-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:29:33.536-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:29:33.538-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:29:33.541-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:29:33.542-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=a191a63e-dd2f-4bca-ad2e-48a57272f6c7 contenido='hola, respuesta a testeo'
2025-11-24T19:29:33.542-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=a191a63e-dd2f-4bca-ad2e-48a57272f6c7
2025-11-24T19:29:54.085-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR mysql2|notas avanz.txt|1603'
2025-11-24T19:29:54.086-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='mysql2' filename='notas avanz.txt' size='1603'
2025-11-24T19:29:54.086-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: notas avanz.txt size=1603 desde /172.29.96.1:57341
2025-11-24T19:29:54.108-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA mysql2|notas avanz.txt|Tm8gZGlzZcOxYXIgZGVzZGUgMCwgcmV1c2FyIHBhcmEgcXVlIHNlYSBtYXMgZsOhY2lsIG1hbnRlbmVyIGEgZnV0dXJvDQpDYWRhIHBhdHJvbiBkZXNjcmliZSB1biBwcm9ibGVtYSB5IHVuYSBzb2x1Y2nDs24sIGFwbGljYWJsZSBpbmZpbml0YXMgdmVjZXMNClBhcnRlcyBkZSB1biBwYXRyb24NCgkuTm9tYnJlOiBDb3J0bywgZGVzY3JpcHRpdm8geSBmw6FjaWwNCgkuUHJvYmxlbWE6IEN1YW5kbyBzZSBhcGxpY2EsIGNvbmRpY2lvbmVzIHNpIHRpZW5lDQoJLlNvbHVjacOzbjogRWxlbWVudG9zIHF1ZSBoYWNlbiBsYSBwbGFudGlsbGEgDQoJLkNvbnNlY3VlbmNpYXM6IHJlc3VsdGFkb3MsIHZlbnRhamFzIHkgZGVzdmVudGFqYXMNCg0KTVZDOiBBY29wbGFjaW9uZXMgeSBzdWJjbGFzZXMNCg0KTW90aXZhY2nDs246IGVzY2VuYXJpbyBxdWUgaWx1c3RyYSB1biBwcm9ibGVtYSBkZSBkaXNlw7FvIHkgY29tbyBzZSByZXN1ZWx2ZQ0KQXBsaWNhYmlsaWRhZDogQ3VhbmRvIHNlIHB1ZWRlIHVzYXINCkVzdHJ1Y3R1cmE6IFJlcHJlc2VudGFjacOzbiBncmFmaWNhIGRlIGxhcyBjbGFzZXMgdXNhbmRvIGVsIHBhdHJvbg0KUGFydGljaXBhbnRlczogQ2xhc2VzIHkgb2JqZXRvcyBxdWUgcGFydGljaXBhbiBlbiBlbCBkaXNlw7FvDQpDb2xhYm9yYWNpb25lczogQ29tbyBzZSByZWxhY2lvbmFuIGxvcyBwYXJ0aWNpcGFudGVzDQpJbXBsZW1lbnRhY2nDs246IERpZmljdWx0YWRlcw0KDQpDYXRhbG9nbw0KDQoNCkNvbnN0cnVjdG9yDQpTZXBhcmEgbGEgY29uc3RydWNjacOzbiBkZSBvYmpldG9zIGRlIGxhcyByZXByZXNlbnRhY2lvbmVzDQoNCnNlIHVzYSBjdWFuZG8NCmVsIGFsZ29yaXRtbyBwYXJhIGNyZWFyIHVuIG9iamV0byBjb21wbGVqbyBkZWJhIHNlciBpbmRlcGVuZGllbnRlIGRlIGxhcyBwYXJ0ZXMgcXVlIHNlIGNvbXBvbmUgZGljaG8gb2JqZXRvDQplbCBwcm9jZXNvIGRlIGNvbnN0cnVjY2lvbiBkZWJlIHBlcm1pdGlyIGRpZmVyZW50ZXMgcmVwcmVzZW50YWNpb25lcyBkZWwgb2JqZXRvDQoNCmVzdG95IDEzMQ0KDQpQcm94eQ0KU3VzdGl0dXRvIGRlIG9iamV0byBxdWUgYWN0w7phIGNvbW8gZWxsb3MsIHBhcmEgZXZpdGFyIHNvYnJlIGNhcmdhcyBvIG1hbmVqYXIgY3VhbmRvIHNlIGxsYW1hIGFsIG9iamV0byByZWFsL29iamV0aXZvDQpTZSBhcGxpY2EgY3VhbmRvIHNlIG5lY2VzaXRhIGNyZWFyIHVuIG9iamV0byBtYXMgdmVyc8OhdGlsIHF1ZSB1biBwdW50ZXJvDQoNClByZWd1bnRhcywgcG9ycXVlIGNvbiBsYSBjbGFzZSBhYnN0cmFjdGEgZXMgZXh0ZW5kcyB5IHBvcnF1ZSBjb24gbGEgaW50ZXJmYXogZXMgaW1wbGVtZW50cw0KUGFyYSBxdWUgc2UgdXNhIGVsIG92ZXJyaWRlPyBFcyBwYXJhIHVzYXIgbGEgZnVuY2nDs24gZGUgZGUgbGEgaW50ZXJmYXogcXVlIHNlIGVzdGEgaW1wbGVtZW50YW5kbz8NCg0KQ29tbWFuZA0KRW5jYXBzdWxhIHBldGljaW9uZXMgZW4gb2JqZXRvcywgZGVqYSBjcmVhciBjb2xhcyB5IHJlZ2lzdHJvcw0KU2UgZGVjbGFyYSB1bmEgY2xhc2UgYWJzdHIgb3JkZW4gcXVlIGRlY2xhcmEgdW5hIGludGVyZmF6IHBhcmEgcXVlIHNlIHB1ZWRhbiBlamVjdXRhciBvcGVyYWNpb25lcw=='
2025-11-24T19:29:54.112-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: mysql1 -> mysql2 : notas avanz.txt (1603 bytes)
2025-11-24T19:29:54.116-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1764030594113_mysql1_notas avanz.txt
2025-11-24T19:29:54.117-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:29:54.124-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:29:54.144-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'notas avanz.txt' using columns nombre / ruta, id=1
2025-11-24T19:29:54.145-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:29:54.147-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:29:54.147-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=1 receptorId=2 archivoId=1
2025-11-24T19:29:54.147-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=ARCHIVO, sesionId=null
2025-11-24T19:30:00.421-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql2' desconectado.
2025-11-24T19:30:00.422-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario mysql2 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:30:00.422-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T19:30:01.193-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:57345
2025-11-24T19:30:01.198-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:57345
2025-11-24T19:30:02.485-05:00  INFO 15872 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:57345
2025-11-24T19:30:02.486-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:57345
2025-11-24T19:30:02.486-05:00  INFO 15872 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:57345
2025-11-24T19:30:02.486-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:57345 conectado y saludado.
2025-11-24T19:30:02.487-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|mysql2|1234'
2025-11-24T19:30:02.494-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql2' id=2
2025-11-24T19:30:02.494-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql2' id=2 desde /172.29.96.1:57345
2025-11-24T19:30:02.495-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql2 (id=2) desde /172.29.96.1:57345
2025-11-24T19:30:02.495-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql2 (user-conns=1)
2025-11-24T19:30:02.495-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql2
2025-11-24T19:30:02.495-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:30:02.502-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:30:02.642-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql2 id=ce575451-f5db-428e-9bd6-9c16bea393f6
2025-11-24T19:30:02.643-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:30:02.645-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:30:02.648-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 3 mensajes históricos desde BD a mysql2
2025-11-24T19:30:02.686-05:00 DEBUG 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-24T19:30:23.241-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql2' desconectado.
2025-11-24T19:30:23.247-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario mysql2 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:30:23.247-05:00  INFO 15872 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T19:30:25.378-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql1' desconectado.
2025-11-24T19:30:25.378-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario mysql1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:30:25.378-05:00  INFO 15872 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T19:30:53.419-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 22804 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:30:53.420-05:00 DEBUG 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:30:53.421-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:30:54.352-05:00  INFO 22804 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:30:54.360-05:00  INFO 22804 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:30:54.360-05:00  INFO 22804 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:30:54.406-05:00  INFO 22804 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:30:54.407-05:00  INFO 22804 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 941 ms
2025-11-24T19:30:54.485-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:30:54.505-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:30:54.506-05:00  INFO 22804 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-24T19:30:54.791-05:00  INFO 22804 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@78d9f51b
2025-11-24T19:30:54.792-05:00  INFO 22804 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-24T19:30:54.824-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:30:54.863-05:00  INFO 22804 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:30:54.866-05:00  INFO 22804 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:30:54.946-05:00  INFO 22804 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Postgres connection failed: FATAL: password authentication failed for user "root"
2025-11-24T19:30:54.947-05:00 ERROR 22804 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : No DatabaseAdapter available at startup
2025-11-24T19:30:55.040-05:00  INFO 22804 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:30:55.256-05:00  INFO 22804 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:30:55.261-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.239 seconds (process running for 2.496)
2025-11-24T19:30:55.262-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:30:55.263-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:30:55.271-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:30:55.305-05:00  INFO 22804 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:30:55.530-05:00  INFO 22804 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:30:55.530-05:00  INFO 22804 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:30:55.530-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:30:55.530-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:30:55.531-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:30:55.531-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:30:55.554-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-24T19:30:55.554-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-24T19:30:55.555-05:00  INFO 22804 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:31:03.131-05:00  INFO 22804 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:55412
2025-11-24T19:31:03.134-05:00  INFO 22804 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:55412
2025-11-24T19:31:04.256-05:00  INFO 22804 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:55412
2025-11-24T19:31:04.257-05:00  INFO 22804 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:55412
2025-11-24T19:31:04.257-05:00  INFO 22804 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:55412
2025-11-24T19:31:04.265-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:55412 conectado y saludado.
2025-11-24T19:31:04.265-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T19:31:04.282-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T19:31:04.282-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:55412
2025-11-24T19:31:04.283-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:55412
2025-11-24T19:31:04.283-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T19:31:04.284-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T19:31:04.284-05:00 DEBUG 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:31:04.287-05:00 DEBUG 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:31:04.444-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=938370e1-0845-40a9-b2f9-3ab13b28cc99
2025-11-24T19:31:04.444-05:00 DEBUG 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:31:04.448-05:00 DEBUG 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:31:04.451-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 3 mensajes históricos desde BD a mysql1
2025-11-24T19:31:04.510-05:00 DEBUG 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-24T19:31:08.177-05:00 ERROR 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /172.29.96.1:55412: java.net.SocketException: Connection reset
2025-11-24T19:31:08.178-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql1' desconectado.
2025-11-24T19:31:08.178-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario mysql1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:31:08.178-05:00  INFO 22804 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T19:31:32.559-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 21128 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:31:32.561-05:00 DEBUG 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:31:32.561-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:31:33.478-05:00  INFO 21128 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:31:33.488-05:00  INFO 21128 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:31:33.488-05:00  INFO 21128 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:31:33.538-05:00  INFO 21128 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:31:33.539-05:00  INFO 21128 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 938 ms
2025-11-24T19:31:33.619-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:31:33.639-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:31:33.640-05:00  INFO 21128 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-24T19:31:33.939-05:00  INFO 21128 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4c5a2baf
2025-11-24T19:31:33.941-05:00  INFO 21128 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-24T19:31:33.971-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:31:34.017-05:00  INFO 21128 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:31:34.019-05:00  INFO 21128 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:31:34.112-05:00  INFO 21128 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Postgres connection failed: FATAL: password authentication failed for user "root"
2025-11-24T19:31:34.113-05:00 ERROR 21128 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : No DatabaseAdapter available at startup
2025-11-24T19:31:34.174-05:00  INFO 21128 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:31:34.384-05:00  INFO 21128 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:31:34.390-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.215 seconds (process running for 2.484)
2025-11-24T19:31:34.392-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:31:34.392-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:31:34.402-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:31:34.448-05:00  INFO 21128 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:31:34.661-05:00  INFO 21128 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:31:34.661-05:00  INFO 21128 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:31:34.662-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:31:34.662-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:31:34.662-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:31:34.662-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:31:34.678-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-24T19:31:34.678-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-24T19:31:34.679-05:00  INFO 21128 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:31:37.465-05:00  INFO 21128 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Usuarios conectados: 
2025-11-24T19:32:01.162-05:00  INFO 21128 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:55435
2025-11-24T19:32:01.166-05:00  INFO 21128 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:55435
2025-11-24T19:32:02.912-05:00  INFO 21128 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:55435
2025-11-24T19:32:02.914-05:00  INFO 21128 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:55435
2025-11-24T19:32:02.914-05:00  INFO 21128 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:55435
2025-11-24T19:32:02.922-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:55435 conectado y saludado.
2025-11-24T19:32:02.923-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T19:32:02.941-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T19:32:02.942-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:55435
2025-11-24T19:32:02.942-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:55435
2025-11-24T19:32:02.943-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T19:32:02.943-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T19:32:02.944-05:00 DEBUG 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:32:02.947-05:00 DEBUG 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:32:03.016-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=8427b8ee-814e-499b-ab52-79842e4cad38
2025-11-24T19:32:03.016-05:00 DEBUG 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:32:03.029-05:00 DEBUG 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:32:03.039-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 3 mensajes históricos desde BD a mysql1
2025-11-24T19:32:03.095-05:00 DEBUG 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-24T19:32:06.436-05:00 ERROR 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /172.29.96.1:55435: java.net.SocketException: Connection reset
2025-11-24T19:32:06.437-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql1' desconectado.
2025-11-24T19:32:06.438-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario mysql1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:32:06.438-05:00  INFO 21128 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T19:38:55.195-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 20380 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:38:55.195-05:00 DEBUG 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:38:55.197-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:38:56.198-05:00  INFO 20380 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:38:56.209-05:00  INFO 20380 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:38:56.209-05:00  INFO 20380 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:38:56.258-05:00  INFO 20380 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:38:56.258-05:00  INFO 20380 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1012 ms
2025-11-24T19:38:56.312-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T19:38:56.593-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:38:56.594-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T19:38:56.610-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:38:56.610-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T19:38:57.874-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T19:38:57.874-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:38:58.134-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:38:58.142-05:00  INFO 20380 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:38:58.179-05:00  INFO 20380 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@9c93d16
2025-11-24T19:38:58.180-05:00  INFO 20380 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:38:58.181-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:38:58.204-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:38:58.227-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:38:58.265-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:38:58.305-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:38:58.307-05:00  INFO 20380 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:38:58.320-05:00  INFO 20380 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Postgres connection failed: FATAL: password authentication failed for user "root"
2025-11-24T19:38:58.325-05:00  INFO 20380 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DataSource reports product='MySQL' url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:38:58.330-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:38:59.765-05:00  INFO 20380 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:38:59
2025-11-24T19:38:59.825-05:00  INFO 20380 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:39:00.070-05:00  INFO 20380 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:39:00.076-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.265 seconds (process running for 5.539)
2025-11-24T19:39:00.079-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:39:00.079-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:39:00.089-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:39:00.124-05:00  INFO 20380 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:39:00.345-05:00  INFO 20380 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:39:00.346-05:00  INFO 20380 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:39:00.346-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:39:00.346-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:39:00.346-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:39:00.346-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:39:00.359-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:39:00.359-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:39:00.360-05:00  INFO 20380 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:39:22.300-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:60387
2025-11-24T19:39:22.304-05:00  INFO 20380 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:60387
2025-11-24T19:39:24.152-05:00  INFO 20380 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:60387
2025-11-24T19:39:24.152-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:60387
2025-11-24T19:39:24.153-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:60387
2025-11-24T19:39:24.159-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:60387 conectado y saludado.
2025-11-24T19:39:24.160-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|postgres1|1234'
2025-11-24T19:39:24.169-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:39:24.173-05:00  WARN 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:39:24.195-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres1' (id=1) registrado en DB
2025-11-24T19:39:24.196-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres1' (id=1) desde /172.29.96.1:60387
2025-11-24T19:39:24.197-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres1 (id=1) desde /172.29.96.1:60387
2025-11-24T19:39:24.199-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T19:39:24.199-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T19:39:31.491-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T19:39:31.501-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T19:39:31.501-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:60387
2025-11-24T19:39:31.501-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:60387
2025-11-24T19:39:31.501-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T19:39:31.501-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-24T19:39:31.503-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:39:31.512-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:39:32.250-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=b59c7475-f448-49c2-ac6f-8dc869fd50ab
2025-11-24T19:39:32.250-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:39:32.252-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:39:40.741-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:49250
2025-11-24T19:39:40.744-05:00  INFO 20380 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:49250
2025-11-24T19:39:41.739-05:00  INFO 20380 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:49250
2025-11-24T19:39:41.739-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:49250
2025-11-24T19:39:41.739-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:49250
2025-11-24T19:39:41.741-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:49250 conectado y saludado.
2025-11-24T19:39:41.741-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|postgres2|1234'
2025-11-24T19:39:41.741-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:39:41.745-05:00  WARN 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:39:41.779-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres2' (id=2) registrado en DB
2025-11-24T19:39:41.779-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres2' (id=2) desde /172.29.96.1:49250
2025-11-24T19:39:41.780-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres2 (id=2) desde /172.29.96.1:49250
2025-11-24T19:39:41.781-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-24T19:39:41.781-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-24T19:39:49.420-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|postgres2|1234'
2025-11-24T19:39:49.424-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres2' id=2
2025-11-24T19:39:49.424-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres2' id=2 desde /172.29.96.1:49250
2025-11-24T19:39:49.424-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres2 (id=2) desde /172.29.96.1:49250
2025-11-24T19:39:49.424-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres2 (user-conns=1)
2025-11-24T19:39:49.425-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: postgres1,postgres2
2025-11-24T19:39:49.425-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:39:49.429-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T19:39:49.468-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres2 id=a4fa2027-7ff0-408b-b623-98f5e972d975
2025-11-24T19:39:49.468-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:39:49.470-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T19:39:55.799-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres1|mensaje en bd postgres'
2025-11-24T19:39:55.799-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:39:55] Mensaje enviado por: postgres2 Para postgres1 Contenido: mensaje en bd postgres
2025-11-24T19:39:55.800-05:00  INFO 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:39:55 Mensaje enviado por: postgres2 Para postgres1 Contenido: mensaje en bd postgres (desde /172.29.96.1:49250)
2025-11-24T19:39:55.801-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:39:55.813-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T19:39:55.825-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:39:55.841-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:39:55.841-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=a4fa2027-7ff0-408b-b623-98f5e972d975 contenido='mensaje en bd postgres'
2025-11-24T19:39:55.844-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=a4fa2027-7ff0-408b-b623-98f5e972d975
2025-11-24T19:40:02.671-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres2|respuesta en bd postgers'
2025-11-24T19:40:02.673-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:40:02] Mensaje enviado por: postgres1 Para postgres2 Contenido: respuesta en bd postgers
2025-11-24T19:40:02.673-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:40:02 Mensaje enviado por: postgres1 Para postgres2 Contenido: respuesta en bd postgers (desde /172.29.96.1:60387)
2025-11-24T19:40:02.673-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:40:02.681-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:40:02.683-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:40:02.689-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T19:40:02.691-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=b59c7475-f448-49c2-ac6f-8dc869fd50ab contenido='respuesta en bd postgers'
2025-11-24T19:40:02.691-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=b59c7475-f448-49c2-ac6f-8dc869fd50ab
2025-11-24T19:40:05.751-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres1' desconectado.
2025-11-24T19:40:05.752-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:40:05.753-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres2
2025-11-24T19:40:06.993-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:53611
2025-11-24T19:40:06.998-05:00  INFO 20380 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:53611
2025-11-24T19:40:07.729-05:00  INFO 20380 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:53611
2025-11-24T19:40:07.729-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:53611
2025-11-24T19:40:07.730-05:00  INFO 20380 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:53611
2025-11-24T19:40:07.731-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:53611 conectado y saludado.
2025-11-24T19:40:07.731-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T19:40:07.740-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T19:40:07.740-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:53611
2025-11-24T19:40:07.741-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:53611
2025-11-24T19:40:07.741-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T19:40:07.742-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: postgres1,postgres2
2025-11-24T19:40:07.743-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:40:07.748-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:40:09.230-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=1a963657-e7cf-4508-9c66-c73ed46a4e20
2025-11-24T19:40:09.231-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:40:09.233-05:00 DEBUG 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:40:09.235-05:00  INFO 20380 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a postgres1
2025-11-24T19:44:11.853-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 21912 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:44:11.855-05:00 DEBUG 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:44:11.855-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:44:12.891-05:00  INFO 21912 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:44:12.906-05:00  INFO 21912 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:44:12.906-05:00  INFO 21912 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:44:12.981-05:00  INFO 21912 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:44:12.981-05:00  INFO 21912 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1074 ms
2025-11-24T19:44:13.028-05:00  INFO 21912 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:44:13.314-05:00  INFO 21912 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:44:13.322-05:00  INFO 21912 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:44:13.356-05:00  INFO 21912 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@39f5b723
2025-11-24T19:44:13.358-05:00  INFO 21912 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:44:13.358-05:00  INFO 21912 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:44:13.381-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:44:13.400-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:44:13.429-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:44:13.459-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:44:13.461-05:00  INFO 21912 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:44:13.474-05:00  INFO 21912 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:44:13.475-05:00  INFO 21912 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:44:14.949-05:00  INFO 21912 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:44:14
2025-11-24T19:44:14.992-05:00  INFO 21912 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:44:15.239-05:00  INFO 21912 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:44:15.246-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.926 seconds (process running for 4.187)
2025-11-24T19:44:15.249-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:44:15.250-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:44:15.258-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:44:15.297-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:44:15.515-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:44:15.515-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:44:15.515-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:44:15.515-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:44:15.515-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:44:15.515-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:44:15.532-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:44:15.533-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:44:15.534-05:00  INFO 21912 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:44:31.083-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:64861
2025-11-24T19:44:31.087-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:64861
2025-11-24T19:44:31.870-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:64861
2025-11-24T19:44:31.871-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:64861
2025-11-24T19:44:31.871-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:64861
2025-11-24T19:44:31.881-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:64861 conectado y saludado.
2025-11-24T19:44:31.883-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|mysql1|1234'
2025-11-24T19:44:31.895-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:44:31.900-05:00  WARN 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:44:31.949-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql1' (id=1) registrado en DB
2025-11-24T19:44:31.949-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql1' (id=1) desde /172.29.96.1:64861
2025-11-24T19:44:31.950-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql1 (id=1) desde /172.29.96.1:64861
2025-11-24T19:44:31.951-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T19:44:31.951-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T19:44:38.319-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T19:44:38.323-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T19:44:38.323-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:64861
2025-11-24T19:44:38.324-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:64861
2025-11-24T19:44:38.324-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T19:44:38.325-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T19:44:38.326-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:44:38.328-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:44:38.357-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=28c6ec78-d428-48dd-b415-8aee15bff1e2
2025-11-24T19:44:38.357-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:44:38.360-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:44:46.491-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:64862
2025-11-24T19:44:46.495-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:64862
2025-11-24T19:44:47.233-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:64862
2025-11-24T19:44:47.233-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:64862
2025-11-24T19:44:47.233-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:64862
2025-11-24T19:44:47.235-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:64862 conectado y saludado.
2025-11-24T19:44:47.235-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|mysql2|1234'
2025-11-24T19:44:47.235-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:44:47.241-05:00  WARN 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:44:47.401-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql2' (id=2) registrado en DB
2025-11-24T19:44:47.402-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql2' (id=2) desde /172.29.96.1:64862
2025-11-24T19:44:47.402-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql2 (id=2) desde /172.29.96.1:64862
2025-11-24T19:44:47.404-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-24T19:44:47.404-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-24T19:44:54.300-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|mysql2|1234'
2025-11-24T19:44:54.304-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql2' id=2
2025-11-24T19:44:54.304-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql2' id=2 desde /172.29.96.1:64862
2025-11-24T19:44:54.304-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql2 (id=2) desde /172.29.96.1:64862
2025-11-24T19:44:54.304-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql2 (user-conns=1)
2025-11-24T19:44:54.305-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql2
2025-11-24T19:44:54.305-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:44:54.309-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:44:54.384-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql2 id=88007619-6320-4413-9602-00a8d34416cf
2025-11-24T19:44:54.385-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:44:54.387-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:45:02.463-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql2|mensaje entre mysql'
2025-11-24T19:45:02.464-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:45:02] Mensaje enviado por: mysql1 Para mysql2 Contenido: mensaje entre mysql
2025-11-24T19:45:02.465-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:45:02 Mensaje enviado por: mysql1 Para mysql2 Contenido: mensaje entre mysql (desde /172.29.96.1:64861)
2025-11-24T19:45:02.466-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:45:02.486-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:45:02.498-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:45:02.501-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:45:02.505-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=28c6ec78-d428-48dd-b415-8aee15bff1e2 contenido='mensaje entre mysql'
2025-11-24T19:45:02.506-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=28c6ec78-d428-48dd-b415-8aee15bff1e2
2025-11-24T19:45:13.679-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql1|respuestas entre mysql'
2025-11-24T19:45:13.680-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:45:13] Mensaje enviado por: mysql2 Para mysql1 Contenido: respuestas entre mysql
2025-11-24T19:45:13.681-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:45:13 Mensaje enviado por: mysql2 Para mysql1 Contenido: respuestas entre mysql (desde /172.29.96.1:64862)
2025-11-24T19:45:13.682-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:45:13.693-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:45:13.695-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:45:13.697-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:45:13.697-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=88007619-6320-4413-9602-00a8d34416cf contenido='respuestas entre mysql'
2025-11-24T19:45:13.698-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=88007619-6320-4413-9602-00a8d34416cf
2025-11-24T19:45:16.557-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql2' desconectado.
2025-11-24T19:45:16.557-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario mysql2 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:45:16.558-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T19:45:17.783-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:55917
2025-11-24T19:45:17.786-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:55917
2025-11-24T19:45:19.092-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:55917
2025-11-24T19:45:19.092-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:55917
2025-11-24T19:45:19.092-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:55917
2025-11-24T19:45:19.093-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:55917 conectado y saludado.
2025-11-24T19:45:19.094-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|mysql2|1234'
2025-11-24T19:45:19.100-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql2' id=2
2025-11-24T19:45:19.100-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql2' id=2 desde /172.29.96.1:55917
2025-11-24T19:45:19.101-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql2 (id=2) desde /172.29.96.1:55917
2025-11-24T19:45:19.101-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql2 (user-conns=1)
2025-11-24T19:45:19.101-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql2
2025-11-24T19:45:19.102-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:45:19.106-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:45:19.127-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql2 id=eed3fff2-8fb4-4af4-a788-8af103efe780
2025-11-24T19:45:19.128-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:45:19.129-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:45:19.131-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a mysql2
2025-11-24T19:45:19.134-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T19:45:16.558091 para evitar duplicados al usuario mysql2
2025-11-24T19:45:45.693-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR mysql1|notas avanz.txt|1603'
2025-11-24T19:45:45.696-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='mysql1' filename='notas avanz.txt' size='1603'
2025-11-24T19:45:45.699-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: notas avanz.txt size=1603 desde /172.29.96.1:55917
2025-11-24T19:45:45.704-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA mysql1|notas avanz.txt|Tm8gZGlzZcOxYXIgZGVzZGUgMCwgcmV1c2FyIHBhcmEgcXVlIHNlYSBtYXMgZsOhY2lsIG1hbnRlbmVyIGEgZnV0dXJvDQpDYWRhIHBhdHJvbiBkZXNjcmliZSB1biBwcm9ibGVtYSB5IHVuYSBzb2x1Y2nDs24sIGFwbGljYWJsZSBpbmZpbml0YXMgdmVjZXMNClBhcnRlcyBkZSB1biBwYXRyb24NCgkuTm9tYnJlOiBDb3J0bywgZGVzY3JpcHRpdm8geSBmw6FjaWwNCgkuUHJvYmxlbWE6IEN1YW5kbyBzZSBhcGxpY2EsIGNvbmRpY2lvbmVzIHNpIHRpZW5lDQoJLlNvbHVjacOzbjogRWxlbWVudG9zIHF1ZSBoYWNlbiBsYSBwbGFudGlsbGEgDQoJLkNvbnNlY3VlbmNpYXM6IHJlc3VsdGFkb3MsIHZlbnRhamFzIHkgZGVzdmVudGFqYXMNCg0KTVZDOiBBY29wbGFjaW9uZXMgeSBzdWJjbGFzZXMNCg0KTW90aXZhY2nDs246IGVzY2VuYXJpbyBxdWUgaWx1c3RyYSB1biBwcm9ibGVtYSBkZSBkaXNlw7FvIHkgY29tbyBzZSByZXN1ZWx2ZQ0KQXBsaWNhYmlsaWRhZDogQ3VhbmRvIHNlIHB1ZWRlIHVzYXINCkVzdHJ1Y3R1cmE6IFJlcHJlc2VudGFjacOzbiBncmFmaWNhIGRlIGxhcyBjbGFzZXMgdXNhbmRvIGVsIHBhdHJvbg0KUGFydGljaXBhbnRlczogQ2xhc2VzIHkgb2JqZXRvcyBxdWUgcGFydGljaXBhbiBlbiBlbCBkaXNlw7FvDQpDb2xhYm9yYWNpb25lczogQ29tbyBzZSByZWxhY2lvbmFuIGxvcyBwYXJ0aWNpcGFudGVzDQpJbXBsZW1lbnRhY2nDs246IERpZmljdWx0YWRlcw0KDQpDYXRhbG9nbw0KDQoNCkNvbnN0cnVjdG9yDQpTZXBhcmEgbGEgY29uc3RydWNjacOzbiBkZSBvYmpldG9zIGRlIGxhcyByZXByZXNlbnRhY2lvbmVzDQoNCnNlIHVzYSBjdWFuZG8NCmVsIGFsZ29yaXRtbyBwYXJhIGNyZWFyIHVuIG9iamV0byBjb21wbGVqbyBkZWJhIHNlciBpbmRlcGVuZGllbnRlIGRlIGxhcyBwYXJ0ZXMgcXVlIHNlIGNvbXBvbmUgZGljaG8gb2JqZXRvDQplbCBwcm9jZXNvIGRlIGNvbnN0cnVjY2lvbiBkZWJlIHBlcm1pdGlyIGRpZmVyZW50ZXMgcmVwcmVzZW50YWNpb25lcyBkZWwgb2JqZXRvDQoNCmVzdG95IDEzMQ0KDQpQcm94eQ0KU3VzdGl0dXRvIGRlIG9iamV0byBxdWUgYWN0w7phIGNvbW8gZWxsb3MsIHBhcmEgZXZpdGFyIHNvYnJlIGNhcmdhcyBvIG1hbmVqYXIgY3VhbmRvIHNlIGxsYW1hIGFsIG9iamV0byByZWFsL29iamV0aXZvDQpTZSBhcGxpY2EgY3VhbmRvIHNlIG5lY2VzaXRhIGNyZWFyIHVuIG9iamV0byBtYXMgdmVyc8OhdGlsIHF1ZSB1biBwdW50ZXJvDQoNClByZWd1bnRhcywgcG9ycXVlIGNvbiBsYSBjbGFzZSBhYnN0cmFjdGEgZXMgZXh0ZW5kcyB5IHBvcnF1ZSBjb24gbGEgaW50ZXJmYXogZXMgaW1wbGVtZW50cw0KUGFyYSBxdWUgc2UgdXNhIGVsIG92ZXJyaWRlPyBFcyBwYXJhIHVzYXIgbGEgZnVuY2nDs24gZGUgZGUgbGEgaW50ZXJmYXogcXVlIHNlIGVzdGEgaW1wbGVtZW50YW5kbz8NCg0KQ29tbWFuZA0KRW5jYXBzdWxhIHBldGljaW9uZXMgZW4gb2JqZXRvcywgZGVqYSBjcmVhciBjb2xhcyB5IHJlZ2lzdHJvcw0KU2UgZGVjbGFyYSB1bmEgY2xhc2UgYWJzdHIgb3JkZW4gcXVlIGRlY2xhcmEgdW5hIGludGVyZmF6IHBhcmEgcXVlIHNlIHB1ZWRhbiBlamVjdXRhciBvcGVyYWNpb25lcw=='
2025-11-24T19:45:45.714-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: mysql2 -> mysql1 : notas avanz.txt (1603 bytes)
2025-11-24T19:45:45.724-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1764031545716_mysql2_notas avanz.txt
2025-11-24T19:45:45.726-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:45:45.736-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:45:45.817-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'notas avanz.txt' using columns nombre / ruta, id=1
2025-11-24T19:45:45.818-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:45:45.820-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:45:45.820-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=2 receptorId=1 archivoId=1
2025-11-24T19:45:45.820-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=ARCHIVO, sesionId=null
2025-11-24T19:45:50.403-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql1' desconectado.
2025-11-24T19:45:50.404-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario mysql1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:45:50.405-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql2
2025-11-24T19:45:51.800-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:59921
2025-11-24T19:45:51.804-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:59921
2025-11-24T19:45:54.300-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:59921
2025-11-24T19:45:54.300-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:59921
2025-11-24T19:45:54.300-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:59921
2025-11-24T19:45:54.302-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:59921 conectado y saludado.
2025-11-24T19:45:54.302-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T19:45:54.307-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T19:45:54.307-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:59921
2025-11-24T19:45:54.307-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:59921
2025-11-24T19:45:54.307-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T19:45:54.307-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql2
2025-11-24T19:45:54.308-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:45:54.313-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:45:54.365-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=b5742cb9-e1a9-469f-83b2-65a2b8b30224
2025-11-24T19:45:54.366-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:45:54.368-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:45:54.370-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 3 mensajes históricos desde BD a mysql1
2025-11-24T19:45:54.373-05:00  INFO 21912 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T19:45:50.412587 para evitar duplicados al usuario mysql1
2025-11-24T19:45:58.613-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql2' desconectado.
2025-11-24T19:45:58.614-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario mysql2 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:45:58.614-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T19:45:59.566-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:59922
2025-11-24T19:45:59.570-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:59922
2025-11-24T19:46:00.781-05:00  INFO 21912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:59922
2025-11-24T19:46:00.781-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:59922
2025-11-24T19:46:00.782-05:00  INFO 21912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:59922
2025-11-24T19:46:00.783-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:59922 conectado y saludado.
2025-11-24T19:46:00.783-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|mysql2|1234'
2025-11-24T19:46:00.786-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql2' id=2
2025-11-24T19:46:00.786-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql2' id=2 desde /172.29.96.1:59922
2025-11-24T19:46:00.789-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql2 (id=2) desde /172.29.96.1:59922
2025-11-24T19:46:00.789-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql2 (user-conns=1)
2025-11-24T19:46:00.789-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql2
2025-11-24T19:46:00.789-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:46:00.794-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:46:00.906-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql2 id=a7d3460e-78f4-4e6b-b413-2324a9cf9264
2025-11-24T19:46:00.906-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:46:00.908-05:00 DEBUG 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:46:00.911-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 3 mensajes históricos desde BD a mysql2
2025-11-24T19:46:00.913-05:00  INFO 21912 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T19:45:58.615479 para evitar duplicados al usuario mysql2
2025-11-24T19:47:35.275-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 8284 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:47:35.277-05:00 DEBUG 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:47:35.278-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:47:36.211-05:00  INFO 8284 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:47:36.220-05:00  INFO 8284 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:47:36.221-05:00  INFO 8284 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:47:36.273-05:00  INFO 8284 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:47:36.273-05:00  INFO 8284 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 952 ms
2025-11-24T19:47:36.328-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T19:47:36.573-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:47:36.573-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T19:47:36.582-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:47:36.583-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T19:47:37.839-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T19:47:37.840-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:47:38.143-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:47:38.152-05:00  INFO 8284 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:47:38.193-05:00  INFO 8284 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@5b40de43
2025-11-24T19:47:38.195-05:00  INFO 8284 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:47:38.195-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:47:38.233-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:47:38.260-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:47:38.310-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:47:38.361-05:00  INFO 8284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:47:38.365-05:00  INFO 8284 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:47:38.385-05:00  INFO 8284 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Postgres connection failed: FATAL: password authentication failed for user "root"
2025-11-24T19:47:38.386-05:00  INFO 8284 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DataSource reports product='MySQL' url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:47:38.392-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:47:39.648-05:00  INFO 8284 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:47:39
2025-11-24T19:47:39.692-05:00  INFO 8284 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:47:39.967-05:00  INFO 8284 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:47:39.973-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.153 seconds (process running for 5.446)
2025-11-24T19:47:39.974-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:47:39.974-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:47:39.983-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:47:40.021-05:00  INFO 8284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:47:40.252-05:00  INFO 8284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:47:40.252-05:00  INFO 8284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:47:40.253-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:47:40.253-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:47:40.253-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:47:40.253-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:47:40.266-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:47:40.266-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:47:40.268-05:00  INFO 8284 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:47:54.968-05:00  INFO 8284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:51560
2025-11-24T19:47:54.971-05:00  INFO 8284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:51560
2025-11-24T19:47:55.804-05:00  INFO 8284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:51560
2025-11-24T19:47:55.805-05:00  INFO 8284 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:51560
2025-11-24T19:47:55.805-05:00  INFO 8284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:51560
2025-11-24T19:47:55.812-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:51560 conectado y saludado.
2025-11-24T19:47:55.813-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T19:47:55.828-05:00  WARN 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:47:55.828-05:00  WARN 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 1
2025-11-24T19:47:55.828-05:00  WARN 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='1' desde /172.29.96.1:51560
2025-11-24T19:47:55.828-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 1 desde /172.29.96.1:51560
2025-11-24T19:48:01.600-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|postgres1|1234'
2025-11-24T19:48:01.601-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:48:01.631-05:00  WARN 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:48:01.700-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres1' (id=1) registrado en DB
2025-11-24T19:48:01.700-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres1' (id=1) desde /172.29.96.1:51560
2025-11-24T19:48:01.702-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres1 (id=1) desde /172.29.96.1:51560
2025-11-24T19:48:01.711-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T19:48:01.712-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T19:48:09.307-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T19:48:09.312-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T19:48:09.312-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:51560
2025-11-24T19:48:09.312-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:51560
2025-11-24T19:48:09.313-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T19:48:09.313-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-24T19:48:09.313-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:48:09.315-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:48:09.345-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=74976191-ae2a-40aa-9cb9-4f4403aca181
2025-11-24T19:48:09.345-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:48:09.347-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:48:19.979-05:00  INFO 8284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:51564
2025-11-24T19:48:19.983-05:00  INFO 8284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:51564
2025-11-24T19:48:20.664-05:00  INFO 8284 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:51564
2025-11-24T19:48:20.664-05:00  INFO 8284 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:51564
2025-11-24T19:48:20.664-05:00  INFO 8284 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:51564
2025-11-24T19:48:20.666-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:51564 conectado y saludado.
2025-11-24T19:48:20.666-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|postgres2|1234'
2025-11-24T19:48:20.666-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:48:20.670-05:00  WARN 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:48:20.756-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres2' (id=2) registrado en DB
2025-11-24T19:48:20.757-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres2' (id=2) desde /172.29.96.1:51564
2025-11-24T19:48:20.757-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres2 (id=2) desde /172.29.96.1:51564
2025-11-24T19:48:20.758-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-24T19:48:20.758-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-24T19:48:28.098-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|postgres2|1234'
2025-11-24T19:48:28.101-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres2' id=2
2025-11-24T19:48:28.101-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres2' id=2 desde /172.29.96.1:51564
2025-11-24T19:48:28.101-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres2 (id=2) desde /172.29.96.1:51564
2025-11-24T19:48:28.101-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres2 (user-conns=1)
2025-11-24T19:48:28.102-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: postgres1,postgres2
2025-11-24T19:48:28.102-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:48:28.104-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T19:48:28.153-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres2 id=f06f347f-8ba1-4c33-a858-908069988071
2025-11-24T19:48:28.154-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:48:28.156-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T19:48:37.930-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres2|mensajes entre postgres'
2025-11-24T19:48:37.932-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:48:37] Mensaje enviado por: postgres1 Para postgres2 Contenido: mensajes entre postgres
2025-11-24T19:48:37.933-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:48:37 Mensaje enviado por: postgres1 Para postgres2 Contenido: mensajes entre postgres (desde /172.29.96.1:51560)
2025-11-24T19:48:37.933-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:48:37.937-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:48:37.938-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:48:37.946-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T19:48:37.951-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=74976191-ae2a-40aa-9cb9-4f4403aca181 contenido='mensajes entre postgres'
2025-11-24T19:48:37.953-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=74976191-ae2a-40aa-9cb9-4f4403aca181
2025-11-24T19:48:44.892-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres1|respuestas entre postgres'
2025-11-24T19:48:44.894-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:48:44] Mensaje enviado por: postgres2 Para postgres1 Contenido: respuestas entre postgres
2025-11-24T19:48:44.894-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:48:44 Mensaje enviado por: postgres2 Para postgres1 Contenido: respuestas entre postgres (desde /172.29.96.1:51564)
2025-11-24T19:48:44.894-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T19:48:44.898-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T19:48:44.898-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T19:48:44.900-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T19:48:44.900-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=f06f347f-8ba1-4c33-a858-908069988071 contenido='respuestas entre postgres'
2025-11-24T19:48:44.900-05:00 DEBUG 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=f06f347f-8ba1-4c33-a858-908069988071
2025-11-24T19:48:48.442-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres2' desconectado.
2025-11-24T19:48:48.443-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario postgres2 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:48:48.444-05:00  INFO 8284 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-24T19:48:50.115-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres1' desconectado.
2025-11-24T19:48:50.116-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:48:50.117-05:00  INFO 8284 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T19:51:55.350-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 18120 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:51:55.352-05:00 DEBUG 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:51:55.353-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:51:56.358-05:00  INFO 18120 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:51:56.369-05:00  INFO 18120 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:51:56.369-05:00  INFO 18120 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:51:56.432-05:00  INFO 18120 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:51:56.432-05:00  INFO 18120 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1041 ms
2025-11-24T19:51:56.486-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T19:51:56.608-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:51:56.609-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T19:51:56.626-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:51:56.626-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T19:51:57.892-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T19:51:57.892-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:51:58.202-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:51:58.211-05:00  INFO 18120 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:51:58.259-05:00  INFO 18120 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@671ea6ff
2025-11-24T19:51:58.261-05:00  INFO 18120 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:51:58.262-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:51:58.297-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:51:58.324-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:51:58.370-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:51:58.411-05:00  INFO 18120 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:51:58.415-05:00  INFO 18120 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:51:58.425-05:00  INFO 18120 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Postgres connection failed: FATAL: password authentication failed for user "root"
2025-11-24T19:51:58.433-05:00  INFO 18120 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DataSource reports product='MySQL' url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:51:58.441-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:52:00.144-05:00  INFO 18120 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:52:00
2025-11-24T19:52:00.188-05:00  INFO 18120 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:52:00.468-05:00  INFO 18120 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:52:00.475-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.507 seconds (process running for 5.795)
2025-11-24T19:52:00.476-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:52:00.477-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:52:00.486-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:52:00.523-05:00  INFO 18120 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:52:00.774-05:00  INFO 18120 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:52:00.775-05:00  INFO 18120 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:52:00.775-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:52:00.775-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:52:00.775-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:52:00.775-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:52:00.787-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:52:00.788-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:52:00.790-05:00  INFO 18120 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:52:18.431-05:00  INFO 18120 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:52527
2025-11-24T19:52:18.434-05:00  INFO 18120 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:52527
2025-11-24T19:52:19.308-05:00  INFO 18120 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:52527
2025-11-24T19:52:19.309-05:00  INFO 18120 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:52527
2025-11-24T19:52:19.309-05:00  INFO 18120 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:52527
2025-11-24T19:52:19.313-05:00  INFO 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:52527 conectado y saludado.
2025-11-24T19:52:19.314-05:00  INFO 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T19:52:19.328-05:00  WARN 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:52:19.329-05:00  WARN 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 1
2025-11-24T19:52:19.329-05:00  WARN 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='1' desde /172.29.96.1:52527
2025-11-24T19:52:19.329-05:00  INFO 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 1 desde /172.29.96.1:52527
2025-11-24T19:52:32.167-05:00  INFO 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T19:52:32.170-05:00  WARN 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:52:32.170-05:00  WARN 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 1
2025-11-24T19:52:32.170-05:00  WARN 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='1' desde /172.29.96.1:52527
2025-11-24T19:52:32.171-05:00  INFO 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 1 desde /172.29.96.1:52527
2025-11-24T19:52:46.778-05:00  INFO 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T19:52:46.782-05:00  WARN 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:52:46.782-05:00  WARN 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 1
2025-11-24T19:52:46.782-05:00  WARN 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='1' desde /172.29.96.1:52527
2025-11-24T19:52:46.782-05:00  INFO 18120 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 1 desde /172.29.96.1:52527
2025-11-24T19:52:55.501-05:00  INFO 18120 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:50515
2025-11-24T19:52:55.504-05:00  INFO 18120 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:50515
2025-11-24T19:52:56.729-05:00  INFO 18120 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:50515
2025-11-24T19:52:56.729-05:00  INFO 18120 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:50515
2025-11-24T19:52:56.729-05:00  INFO 18120 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:50515
2025-11-24T19:52:56.731-05:00  INFO 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:50515 conectado y saludado.
2025-11-24T19:52:56.731-05:00  INFO 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|postgres2|1234'
2025-11-24T19:52:56.740-05:00  WARN 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:52:56.740-05:00  WARN 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 2
2025-11-24T19:52:56.740-05:00  WARN 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='2' desde /172.29.96.1:50515
2025-11-24T19:52:56.740-05:00  INFO 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 2 desde /172.29.96.1:50515
2025-11-24T19:53:04.790-05:00  INFO 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|mysql2|1234'
2025-11-24T19:53:04.794-05:00  WARN 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:53:04.794-05:00  WARN 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 2
2025-11-24T19:53:04.794-05:00  WARN 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='2' desde /172.29.96.1:50515
2025-11-24T19:53:04.795-05:00  INFO 18120 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 2 desde /172.29.96.1:50515
2025-11-24T19:53:19.113-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 23484 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:53:19.115-05:00 DEBUG 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:53:19.115-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:53:20.055-05:00  INFO 23484 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:53:20.066-05:00  INFO 23484 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:53:20.066-05:00  INFO 23484 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:53:20.114-05:00  INFO 23484 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:53:20.115-05:00  INFO 23484 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 962 ms
2025-11-24T19:53:20.162-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T19:53:20.276-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:53:20.276-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T19:53:20.291-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:53:20.291-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T19:53:21.566-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T19:53:21.566-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:53:21.917-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:53:21.928-05:00  INFO 23484 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:53:22.048-05:00  INFO 23484 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@ef718de
2025-11-24T19:53:22.051-05:00  INFO 23484 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:53:22.051-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:53:22.083-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:53:22.115-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:53:22.163-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:53:22.242-05:00  INFO 23484 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:53:22.244-05:00  INFO 23484 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:53:22.272-05:00  INFO 23484 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Postgres connection failed: FATAL: password authentication failed for user "root"
2025-11-24T19:53:22.280-05:00  INFO 23484 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DataSource reports product='MySQL' url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:53:22.286-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:53:25.361-05:00  INFO 23484 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:53:25
2025-11-24T19:53:25.402-05:00  INFO 23484 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:53:25.606-05:00  INFO 23484 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:53:25.611-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 6.912 seconds (process running for 7.18)
2025-11-24T19:53:25.612-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:53:25.613-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:53:25.620-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:53:25.656-05:00  INFO 23484 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:53:25.888-05:00  INFO 23484 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:53:25.888-05:00  INFO 23484 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:53:25.888-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:53:25.888-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:53:25.888-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:53:25.888-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:53:25.902-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:53:25.903-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:53:25.904-05:00  INFO 23484 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:55:34.029-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 22844 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:55:34.030-05:00 DEBUG 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:55:34.030-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:55:34.946-05:00  INFO 22844 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:55:34.957-05:00  INFO 22844 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:55:34.957-05:00  INFO 22844 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:55:35.004-05:00  INFO 22844 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:55:35.005-05:00  INFO 22844 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 934 ms
2025-11-24T19:55:35.054-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T19:55:35.165-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:55:35.166-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T19:55:35.174-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:55:35.176-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T19:55:36.441-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T19:55:36.441-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:55:36.715-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:55:36.723-05:00  INFO 22844 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:55:36.758-05:00  INFO 22844 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@61ae0d43
2025-11-24T19:55:36.759-05:00  INFO 22844 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:55:36.760-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:55:36.785-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:55:36.808-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:55:36.842-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:55:36.874-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:55:36.877-05:00  INFO 22844 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:55:36.890-05:00  INFO 22844 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Postgres connection failed: FATAL: password authentication failed for user "root"
2025-11-24T19:55:36.893-05:00  INFO 22844 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DataSource reports product='MySQL' url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:55:36.897-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:55:38.391-05:00  INFO 22844 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:55:38
2025-11-24T19:55:38.414-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:55:38.455-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:55:38.699-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:55:38.700-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:55:38.700-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T19:55:38.752-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T19:55:38.756-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:55:38.756-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T19:55:38.758-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:55:38.758-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T19:55:38.760-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:55:38.760-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T19:55:38.762-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:55:38.762-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T19:55:38.790-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T19:55:38.854-05:00  INFO 22844 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:55:39.188-05:00  INFO 22844 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:55:39.195-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.581 seconds (process running for 5.86)
2025-11-24T19:55:39.198-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:55:39.199-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:55:39.199-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:55:39.199-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:55:39.199-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:55:39.199-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:55:39.212-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:55:39.212-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:55:39.213-05:00  INFO 22844 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:56:06.679-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:50422
2025-11-24T19:56:06.683-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:50422
2025-11-24T19:56:07.524-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:50422
2025-11-24T19:56:07.525-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:50422
2025-11-24T19:56:07.525-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:50422
2025-11-24T19:56:07.532-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:50422 conectado y saludado.
2025-11-24T19:56:07.532-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|mysql1|1234'
2025-11-24T19:56:07.541-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:56:07.546-05:00  WARN 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:56:07.571-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql1' (id=1) registrado en DB
2025-11-24T19:56:07.571-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql1' (id=1) desde /172.29.96.1:50422
2025-11-24T19:56:07.571-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql1 (id=1) desde /172.29.96.1:50422
2025-11-24T19:56:07.578-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T19:56:07.589-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T19:56:14.631-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T19:56:14.635-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T19:56:14.635-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:50422
2025-11-24T19:56:14.635-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:50422
2025-11-24T19:56:14.635-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T19:56:14.636-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T19:56:14.636-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:56:14.640-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:56:14.659-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=73e65ed6-0727-4309-acde-7623bd7612ba
2025-11-24T19:56:14.660-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:56:14.662-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:56:22.932-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:50423
2025-11-24T19:56:22.937-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:50423
2025-11-24T19:56:24.042-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:50423
2025-11-24T19:56:24.042-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:50423
2025-11-24T19:56:24.042-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:50423
2025-11-24T19:56:24.044-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:50423 conectado y saludado.
2025-11-24T19:56:24.045-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|mysql2|1234'
2025-11-24T19:56:24.047-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:56:24.056-05:00  WARN 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:56:25.197-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql2' (id=2) registrado en DB
2025-11-24T19:56:25.198-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql2' (id=2) desde /172.29.96.1:50423
2025-11-24T19:56:25.198-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql2 (id=2) desde /172.29.96.1:50423
2025-11-24T19:56:25.200-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-24T19:56:25.200-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-24T19:56:32.897-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|mysql2|1234'
2025-11-24T19:56:32.900-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql2' id=2
2025-11-24T19:56:32.900-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql2' id=2 desde /172.29.96.1:50423
2025-11-24T19:56:32.900-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql2 (id=2) desde /172.29.96.1:50423
2025-11-24T19:56:32.900-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql2 (user-conns=1)
2025-11-24T19:56:32.900-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql2
2025-11-24T19:56:32.901-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:56:32.905-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:56:33.025-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql2 id=c2ddddad-9ad9-413a-b68b-52545bbfe6ac
2025-11-24T19:56:33.025-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:56:33.028-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:56:39.904-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql1|mensajes entre mysql'
2025-11-24T19:56:39.904-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:56:39] Mensaje enviado por: mysql2 Para mysql1 Contenido: mensajes entre mysql
2025-11-24T19:56:39.905-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:56:39 Mensaje enviado por: mysql2 Para mysql1 Contenido: mensajes entre mysql (desde /172.29.96.1:50423)
2025-11-24T19:56:39.905-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:56:39.915-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:56:39.923-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:56:39.937-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:56:39.944-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=c2ddddad-9ad9-413a-b68b-52545bbfe6ac contenido='mensajes entre mysql'
2025-11-24T19:56:39.945-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=c2ddddad-9ad9-413a-b68b-52545bbfe6ac
2025-11-24T19:56:47.281-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql2|respuesta entre mysql'
2025-11-24T19:56:47.281-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-24 19:56:47] Mensaje enviado por: mysql1 Para mysql2 Contenido: respuesta entre mysql
2025-11-24T19:56:47.282-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 19:56:47 Mensaje enviado por: mysql1 Para mysql2 Contenido: respuesta entre mysql (desde /172.29.96.1:50422)
2025-11-24T19:56:47.282-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:56:47.298-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:56:47.298-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:56:47.299-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:56:47.300-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=73e65ed6-0727-4309-acde-7623bd7612ba contenido='respuesta entre mysql'
2025-11-24T19:56:47.301-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=73e65ed6-0727-4309-acde-7623bd7612ba
2025-11-24T19:56:50.309-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql1' desconectado.
2025-11-24T19:56:50.309-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario mysql1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:56:50.310-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql2
2025-11-24T19:56:51.344-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:56239
2025-11-24T19:56:51.351-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:56239
2025-11-24T19:56:52.262-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:56239
2025-11-24T19:56:52.272-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:56239
2025-11-24T19:56:52.273-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:56239
2025-11-24T19:56:52.274-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:56239 conectado y saludado.
2025-11-24T19:56:52.277-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T19:56:52.295-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T19:56:52.296-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:56239
2025-11-24T19:56:52.296-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:56239
2025-11-24T19:56:52.296-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T19:56:52.296-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql2
2025-11-24T19:56:52.296-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:56:52.309-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:56:52.480-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=78140931-9abb-40a2-970d-6d0438dda25f
2025-11-24T19:56:52.482-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:56:52.485-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:56:52.488-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a mysql1
2025-11-24T19:56:52.495-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T19:56:50.311672 para evitar duplicados al usuario mysql1
2025-11-24T19:57:05.308-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR mysql2|notas avanz.txt|1603'
2025-11-24T19:57:05.309-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='mysql2' filename='notas avanz.txt' size='1603'
2025-11-24T19:57:05.310-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: notas avanz.txt size=1603 desde /172.29.96.1:56239
2025-11-24T19:57:05.314-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA mysql2|notas avanz.txt|Tm8gZGlzZcOxYXIgZGVzZGUgMCwgcmV1c2FyIHBhcmEgcXVlIHNlYSBtYXMgZsOhY2lsIG1hbnRlbmVyIGEgZnV0dXJvDQpDYWRhIHBhdHJvbiBkZXNjcmliZSB1biBwcm9ibGVtYSB5IHVuYSBzb2x1Y2nDs24sIGFwbGljYWJsZSBpbmZpbml0YXMgdmVjZXMNClBhcnRlcyBkZSB1biBwYXRyb24NCgkuTm9tYnJlOiBDb3J0bywgZGVzY3JpcHRpdm8geSBmw6FjaWwNCgkuUHJvYmxlbWE6IEN1YW5kbyBzZSBhcGxpY2EsIGNvbmRpY2lvbmVzIHNpIHRpZW5lDQoJLlNvbHVjacOzbjogRWxlbWVudG9zIHF1ZSBoYWNlbiBsYSBwbGFudGlsbGEgDQoJLkNvbnNlY3VlbmNpYXM6IHJlc3VsdGFkb3MsIHZlbnRhamFzIHkgZGVzdmVudGFqYXMNCg0KTVZDOiBBY29wbGFjaW9uZXMgeSBzdWJjbGFzZXMNCg0KTW90aXZhY2nDs246IGVzY2VuYXJpbyBxdWUgaWx1c3RyYSB1biBwcm9ibGVtYSBkZSBkaXNlw7FvIHkgY29tbyBzZSByZXN1ZWx2ZQ0KQXBsaWNhYmlsaWRhZDogQ3VhbmRvIHNlIHB1ZWRlIHVzYXINCkVzdHJ1Y3R1cmE6IFJlcHJlc2VudGFjacOzbiBncmFmaWNhIGRlIGxhcyBjbGFzZXMgdXNhbmRvIGVsIHBhdHJvbg0KUGFydGljaXBhbnRlczogQ2xhc2VzIHkgb2JqZXRvcyBxdWUgcGFydGljaXBhbiBlbiBlbCBkaXNlw7FvDQpDb2xhYm9yYWNpb25lczogQ29tbyBzZSByZWxhY2lvbmFuIGxvcyBwYXJ0aWNpcGFudGVzDQpJbXBsZW1lbnRhY2nDs246IERpZmljdWx0YWRlcw0KDQpDYXRhbG9nbw0KDQoNCkNvbnN0cnVjdG9yDQpTZXBhcmEgbGEgY29uc3RydWNjacOzbiBkZSBvYmpldG9zIGRlIGxhcyByZXByZXNlbnRhY2lvbmVzDQoNCnNlIHVzYSBjdWFuZG8NCmVsIGFsZ29yaXRtbyBwYXJhIGNyZWFyIHVuIG9iamV0byBjb21wbGVqbyBkZWJhIHNlciBpbmRlcGVuZGllbnRlIGRlIGxhcyBwYXJ0ZXMgcXVlIHNlIGNvbXBvbmUgZGljaG8gb2JqZXRvDQplbCBwcm9jZXNvIGRlIGNvbnN0cnVjY2lvbiBkZWJlIHBlcm1pdGlyIGRpZmVyZW50ZXMgcmVwcmVzZW50YWNpb25lcyBkZWwgb2JqZXRvDQoNCmVzdG95IDEzMQ0KDQpQcm94eQ0KU3VzdGl0dXRvIGRlIG9iamV0byBxdWUgYWN0w7phIGNvbW8gZWxsb3MsIHBhcmEgZXZpdGFyIHNvYnJlIGNhcmdhcyBvIG1hbmVqYXIgY3VhbmRvIHNlIGxsYW1hIGFsIG9iamV0byByZWFsL29iamV0aXZvDQpTZSBhcGxpY2EgY3VhbmRvIHNlIG5lY2VzaXRhIGNyZWFyIHVuIG9iamV0byBtYXMgdmVyc8OhdGlsIHF1ZSB1biBwdW50ZXJvDQoNClByZWd1bnRhcywgcG9ycXVlIGNvbiBsYSBjbGFzZSBhYnN0cmFjdGEgZXMgZXh0ZW5kcyB5IHBvcnF1ZSBjb24gbGEgaW50ZXJmYXogZXMgaW1wbGVtZW50cw0KUGFyYSBxdWUgc2UgdXNhIGVsIG92ZXJyaWRlPyBFcyBwYXJhIHVzYXIgbGEgZnVuY2nDs24gZGUgZGUgbGEgaW50ZXJmYXogcXVlIHNlIGVzdGEgaW1wbGVtZW50YW5kbz8NCg0KQ29tbWFuZA0KRW5jYXBzdWxhIHBldGljaW9uZXMgZW4gb2JqZXRvcywgZGVqYSBjcmVhciBjb2xhcyB5IHJlZ2lzdHJvcw0KU2UgZGVjbGFyYSB1bmEgY2xhc2UgYWJzdHIgb3JkZW4gcXVlIGRlY2xhcmEgdW5hIGludGVyZmF6IHBhcmEgcXVlIHNlIHB1ZWRhbiBlamVjdXRhciBvcGVyYWNpb25lcw=='
2025-11-24T19:57:05.318-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: mysql1 -> mysql2 : notas avanz.txt (1603 bytes)
2025-11-24T19:57:05.322-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1764032225318_mysql1_notas avanz.txt
2025-11-24T19:57:05.322-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T19:57:05.328-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T19:57:05.359-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'notas avanz.txt' using columns nombre / ruta, id=1
2025-11-24T19:57:05.360-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T19:57:05.361-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T19:57:05.361-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=1 receptorId=2 archivoId=1
2025-11-24T19:57:05.361-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=ARCHIVO, sesionId=null
2025-11-24T19:57:23.906-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:56246
2025-11-24T19:57:23.911-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:56246
2025-11-24T19:57:25.865-05:00  INFO 22844 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:56246
2025-11-24T19:57:25.865-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:56246
2025-11-24T19:57:25.865-05:00  INFO 22844 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:56246
2025-11-24T19:57:25.866-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:56246 conectado y saludado.
2025-11-24T19:57:25.867-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 3|mysql3|1234'
2025-11-24T19:57:25.867-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-24T19:57:25.870-05:00  WARN 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql3' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T19:57:25.900-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql3' (id=3) registrado en DB
2025-11-24T19:57:25.901-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql3' (id=3) desde /172.29.96.1:56246
2025-11-24T19:57:25.901-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql3 (id=3) desde /172.29.96.1:56246
2025-11-24T19:57:25.903-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 3
2025-11-24T19:57:25.903-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 3
2025-11-24T19:57:32.920-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 3|mysql3|1234'
2025-11-24T19:57:32.924-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql3' id=3
2025-11-24T19:57:32.924-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql3' id=3 desde /172.29.96.1:56246
2025-11-24T19:57:32.924-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql3 (id=3) desde /172.29.96.1:56246
2025-11-24T19:57:32.924-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql3 (user-conns=1)
2025-11-24T19:57:32.924-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 3 clients: mysql1,mysql2,mysql3
2025-11-24T19:57:32.925-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-24T19:57:32.933-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='mysql3'
2025-11-24T19:57:33.015-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql3 id=14a88649-3ed1-47eb-8431-6821bae9265d
2025-11-24T19:57:33.015-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-24T19:57:33.017-05:00 DEBUG 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='mysql3'
2025-11-24T19:57:46.732-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql1' desconectado.
2025-11-24T19:57:46.732-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario mysql1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:57:46.733-05:00  INFO 22844 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql2,mysql3
2025-11-24T19:57:49.285-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql3' desconectado.
2025-11-24T19:57:49.286-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario mysql3 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:57:49.287-05:00  INFO 22844 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql2
2025-11-24T19:57:54.245-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql2' desconectado.
2025-11-24T19:57:54.245-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario mysql2 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T19:57:54.246-05:00  INFO 22844 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T19:58:14.748-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 2268 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:58:14.749-05:00 DEBUG 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:58:14.749-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:58:15.712-05:00  INFO 2268 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:58:15.723-05:00  INFO 2268 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:58:15.724-05:00  INFO 2268 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:58:15.774-05:00  INFO 2268 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:58:15.774-05:00  INFO 2268 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 981 ms
2025-11-24T19:58:15.823-05:00  INFO 2268 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:58:16.121-05:00  INFO 2268 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:58:16.129-05:00  INFO 2268 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:58:16.159-05:00  INFO 2268 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@46dcbeab
2025-11-24T19:58:16.161-05:00  INFO 2268 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:58:16.161-05:00  INFO 2268 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:58:16.184-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:58:16.205-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:58:16.234-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:58:16.266-05:00  INFO 2268 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:58:16.269-05:00  INFO 2268 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql1' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:58:16.284-05:00  INFO 2268 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:58:16.286-05:00  INFO 2268 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:58:17.740-05:00  INFO 2268 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:58:17
2025-11-24T19:58:17.760-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:58:17.806-05:00  INFO 2268 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:58:18.044-05:00  INFO 2268 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:58:18.044-05:00  INFO 2268 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:58:18.044-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T19:58:18.050-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T19:58:18.054-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:18.055-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T19:58:18.057-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:18.057-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T19:58:18.059-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:18.059-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T19:58:18.061-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:18.062-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T19:58:18.088-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T19:58:18.149-05:00  INFO 2268 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:58:18.410-05:00  INFO 2268 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:58:18.415-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.071 seconds (process running for 4.37)
2025-11-24T19:58:18.417-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:58:18.418-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:58:18.418-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:58:18.418-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:58:18.418-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:58:18.418-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:58:18.432-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:58:18.432-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:58:18.433-05:00  INFO 2268 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:58:33.066-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 24316 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:58:33.067-05:00 DEBUG 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:58:33.068-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:58:33.931-05:00  INFO 24316 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:58:33.941-05:00  INFO 24316 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:58:33.941-05:00  INFO 24316 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:58:33.986-05:00  INFO 24316 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:58:33.987-05:00  INFO 24316 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 882 ms
2025-11-24T19:58:34.032-05:00  INFO 24316 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:58:34.322-05:00  INFO 24316 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:58:34.330-05:00  INFO 24316 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:58:34.364-05:00  INFO 24316 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@68dd39d2
2025-11-24T19:58:34.366-05:00  INFO 24316 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:58:34.366-05:00  INFO 24316 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:58:34.388-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:58:34.406-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:58:34.434-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:58:34.468-05:00  INFO 24316 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:58:34.471-05:00  INFO 24316 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:58:34.486-05:00  INFO 24316 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:58:34.488-05:00  INFO 24316 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:58:35.835-05:00  INFO 24316 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:58:35
2025-11-24T19:58:35.855-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:58:35.907-05:00  INFO 24316 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:58:36.149-05:00  INFO 24316 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:58:36.149-05:00  INFO 24316 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:58:36.150-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T19:58:36.157-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T19:58:36.161-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:36.161-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T19:58:36.167-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:36.168-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T19:58:36.174-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:36.176-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T19:58:36.179-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:36.179-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T19:58:36.212-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T19:58:36.285-05:00  INFO 24316 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:58:36.558-05:00  INFO 24316 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:58:36.564-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.883 seconds (process running for 4.197)
2025-11-24T19:58:36.566-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:58:36.567-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:58:36.567-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:58:36.567-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:58:36.567-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:58:36.567-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:58:36.587-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:58:36.587-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:58:36.589-05:00  INFO 24316 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:58:44.223-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 10140 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:58:44.225-05:00 DEBUG 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:58:44.226-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:58:45.106-05:00  INFO 10140 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:58:45.116-05:00  INFO 10140 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:58:45.116-05:00  INFO 10140 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:58:45.191-05:00  INFO 10140 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:58:45.192-05:00  INFO 10140 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 921 ms
2025-11-24T19:58:45.241-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T19:58:45.433-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:58:45.433-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T19:58:45.458-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:58:45.458-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T19:58:46.725-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T19:58:46.725-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:58:47.025-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:58:47.037-05:00  INFO 10140 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:58:47.085-05:00  INFO 10140 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@63f9b562
2025-11-24T19:58:47.088-05:00  INFO 10140 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:58:47.088-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:58:47.114-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:58:47.135-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:58:47.177-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:58:47.212-05:00  INFO 10140 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:58:47.215-05:00  INFO 10140 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:58:47.226-05:00  INFO 10140 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Postgres connection failed: FATAL: password authentication failed for user "root"
2025-11-24T19:58:47.237-05:00  INFO 10140 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DataSource reports product='MySQL' url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:58:47.241-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:58:48.857-05:00  INFO 10140 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:58:48
2025-11-24T19:58:48.879-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:58:48.912-05:00  INFO 10140 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:58:49.132-05:00  INFO 10140 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:58:49.133-05:00  INFO 10140 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:58:49.133-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T19:58:49.140-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T19:58:49.143-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:49.143-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T19:58:49.146-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:49.146-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T19:58:49.148-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:49.148-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T19:58:49.150-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:58:49.150-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T19:58:49.178-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T19:58:49.240-05:00  INFO 10140 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:58:49.500-05:00  INFO 10140 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:58:49.505-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.657 seconds (process running for 5.951)
2025-11-24T19:58:49.508-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:58:49.508-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:58:49.508-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:58:49.508-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:58:49.508-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:58:49.508-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:58:49.519-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:58:49.519-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:58:49.520-05:00  INFO 10140 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T19:59:07.464-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 10404 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T19:59:07.465-05:00 DEBUG 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T19:59:07.466-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T19:59:08.343-05:00  INFO 10404 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T19:59:08.350-05:00  INFO 10404 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T19:59:08.352-05:00  INFO 10404 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T19:59:08.397-05:00  INFO 10404 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T19:59:08.397-05:00  INFO 10404 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 891 ms
2025-11-24T19:59:08.444-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T19:59:08.548-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:59:08.549-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T19:59:08.567-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T19:59:08.567-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T19:59:09.842-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T19:59:09.843-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T19:59:10.138-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:59:10.146-05:00  INFO 10404 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T19:59:10.183-05:00  INFO 10404 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@2b4d4327
2025-11-24T19:59:10.184-05:00  INFO 10404 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T19:59:10.185-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T19:59:10.222-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T19:59:10.244-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T19:59:10.288-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T19:59:10.320-05:00  INFO 10404 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T19:59:10.323-05:00  INFO 10404 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:59:10.332-05:00  INFO 10404 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Postgres connection failed: FATAL: password authentication failed for user "root"
2025-11-24T19:59:10.335-05:00  INFO 10404 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DataSource reports product='MySQL' url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T19:59:10.345-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T19:59:11.905-05:00  INFO 10404 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 00:59:11
2025-11-24T19:59:11.930-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T19:59:11.965-05:00  INFO 10404 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T19:59:12.293-05:00  INFO 10404 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T19:59:12.295-05:00  INFO 10404 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T19:59:12.295-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T19:59:12.306-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T19:59:12.318-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:59:12.319-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T19:59:12.325-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:59:12.325-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T19:59:12.331-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:59:12.331-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T19:59:12.336-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T19:59:12.336-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T19:59:12.376-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T19:59:12.445-05:00  INFO 10404 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T19:59:12.744-05:00  INFO 10404 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T19:59:12.751-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.693 seconds (process running for 5.96)
2025-11-24T19:59:12.752-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T19:59:12.752-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T19:59:12.753-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T19:59:12.753-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T19:59:12.754-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T19:59:12.754-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T19:59:12.765-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T19:59:12.765-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T19:59:12.767-05:00  INFO 10404 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:02:24.863-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 612 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:02:24.865-05:00 DEBUG 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:02:24.865-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:02:25.776-05:00  INFO 612 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:02:25.785-05:00  INFO 612 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:02:25.785-05:00  INFO 612 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:02:25.851-05:00  INFO 612 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:02:25.851-05:00  INFO 612 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 947 ms
2025-11-24T20:02:25.898-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T20:02:26.041-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:02:26.041-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T20:02:26.061-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:02:26.061-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T20:02:27.323-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T20:02:27.324-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:02:27.607-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:02:27.614-05:00  INFO 612 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:02:27.652-05:00  INFO 612 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@61ae0d43
2025-11-24T20:02:27.653-05:00  INFO 612 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:02:27.654-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:02:27.680-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:02:27.703-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:02:27.736-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:02:27.766-05:00  INFO 612 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:02:27.768-05:00  INFO 612 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:02:28.401-05:00  INFO 612 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:02:28.402-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:02:28.673-05:00  INFO 612 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for Postgres. Server time: 2025-11-24 20:02:28.665947-05
2025-11-24T20:02:28.712-05:00  INFO 612 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:02:28.898-05:00  INFO 612 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:02:28.903-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.445 seconds (process running for 4.729)
2025-11-24T20:02:28.906-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:02:28.906-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:02:28.915-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:02:28.950-05:00  INFO 612 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:02:29.177-05:00  INFO 612 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:02:29.178-05:00  INFO 612 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:02:29.179-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:02:29.180-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:02:29.180-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:02:29.180-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:02:29.206-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:02:29.208-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:02:29.209-05:00  INFO 612 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:02:47.611-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 22896 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:02:47.612-05:00 DEBUG 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:02:47.613-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:02:48.474-05:00  INFO 22896 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:02:48.482-05:00  INFO 22896 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:02:48.482-05:00  INFO 22896 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:02:48.650-05:00  INFO 22896 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:02:48.650-05:00  INFO 22896 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 996 ms
2025-11-24T20:02:48.699-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T20:02:48.812-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:02:48.813-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T20:02:48.827-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:02:48.828-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T20:02:50.088-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T20:02:50.088-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:02:50.346-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:02:50.355-05:00  INFO 22896 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:02:50.393-05:00  INFO 22896 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@671ea6ff
2025-11-24T20:02:50.394-05:00  INFO 22896 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:02:50.394-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:02:50.421-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:02:50.445-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:02:50.484-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:02:50.521-05:00  INFO 22896 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:02:50.523-05:00  INFO 22896 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:02:50.586-05:00  INFO 22896 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:02:50.587-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:02:51.134-05:00  INFO 22896 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for Postgres. Server time: 2025-11-24 20:02:51.129965-05
2025-11-24T20:02:51.177-05:00  INFO 22896 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:02:51.405-05:00  INFO 22896 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:02:51.411-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.168 seconds (process running for 4.419)
2025-11-24T20:02:51.416-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:02:51.418-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:02:51.426-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:02:51.464-05:00  INFO 22896 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:02:51.700-05:00  INFO 22896 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:02:51.700-05:00  INFO 22896 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:02:51.701-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:02:51.701-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:02:51.701-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:02:51.701-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:02:51.723-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:02:51.724-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:02:51.725-05:00  INFO 22896 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:03:06.450-05:00  INFO 22896 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:50768
2025-11-24T20:03:06.455-05:00  INFO 22896 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:50768
2025-11-24T20:03:07.377-05:00  INFO 22896 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:50768
2025-11-24T20:03:07.377-05:00  INFO 22896 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:50768
2025-11-24T20:03:07.377-05:00  INFO 22896 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:50768
2025-11-24T20:03:07.384-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:50768 conectado y saludado.
2025-11-24T20:03:07.385-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|mysql1|1234'
2025-11-24T20:03:07.396-05:00 DEBUG 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T20:03:07.399-05:00  WARN 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T20:03:07.432-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql1' (id=1) registrado en DB
2025-11-24T20:03:07.432-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql1' (id=1) desde /172.29.96.1:50768
2025-11-24T20:03:07.433-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql1 (id=1) desde /172.29.96.1:50768
2025-11-24T20:03:07.435-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T20:03:07.435-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T20:03:14.788-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T20:03:14.792-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T20:03:14.793-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:50768
2025-11-24T20:03:14.793-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:50768
2025-11-24T20:03:14.793-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T20:03:14.794-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T20:03:14.794-05:00 DEBUG 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T20:03:14.796-05:00 DEBUG 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T20:03:14.895-05:00  INFO 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=b494cd2b-74c7-4a52-8be2-1868dba7f3dc
2025-11-24T20:03:14.897-05:00 DEBUG 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T20:03:14.898-05:00 DEBUG 22896 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T20:03:26.603-05:00  INFO 22896 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Usuarios conectados: mysql1
2025-11-24T20:03:33.363-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 24088 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:03:33.364-05:00 DEBUG 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:03:33.365-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:03:34.414-05:00  INFO 24088 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:03:34.422-05:00  INFO 24088 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:03:34.422-05:00  INFO 24088 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:03:34.550-05:00  INFO 24088 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:03:34.551-05:00  INFO 24088 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1134 ms
2025-11-24T20:03:34.615-05:00  INFO 24088 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:03:34.964-05:00  INFO 24088 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:03:34.973-05:00  INFO 24088 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:03:35.012-05:00  INFO 24088 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@60e3c26e
2025-11-24T20:03:35.015-05:00  INFO 24088 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:03:35.015-05:00  INFO 24088 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:03:35.040-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:03:35.063-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:03:35.099-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:03:35.135-05:00  INFO 24088 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:03:35.137-05:00  INFO 24088 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:03:35.152-05:00  INFO 24088 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:03:35.154-05:00  INFO 24088 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T20:03:36.547-05:00  INFO 24088 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Database init completed for MySQL. Server time: 2025-11-25 01:03:36
2025-11-24T20:03:36.596-05:00  INFO 24088 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:03:36.892-05:00  INFO 24088 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:03:36.900-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.995 seconds (process running for 4.356)
2025-11-24T20:03:36.902-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:03:36.902-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:03:36.910-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:03:36.948-05:00  INFO 24088 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:03:37.181-05:00  INFO 24088 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:03:37.181-05:00  INFO 24088 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:03:37.204-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:03:37.205-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:03:37.206-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:03:37.206-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:03:37.222-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:03:37.223-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:03:37.224-05:00  INFO 24088 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:03:39.956-05:00  INFO 24088 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:50786
2025-11-24T20:03:39.964-05:00  INFO 24088 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:50786
2025-11-24T20:03:40.812-05:00  INFO 24088 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:50786
2025-11-24T20:03:40.813-05:00  INFO 24088 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:50786
2025-11-24T20:03:40.814-05:00  INFO 24088 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:50786
2025-11-24T20:03:40.823-05:00  INFO 24088 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:50786 conectado y saludado.
2025-11-24T20:03:40.825-05:00  INFO 24088 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T20:03:40.834-05:00  WARN 24088 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findById: fallo buscando id='1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T20:03:40.835-05:00  WARN 24088 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login intento para id desconocido: 1
2025-11-24T20:03:40.836-05:00  WARN 24088 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='1' desde /172.29.96.1:50786
2025-11-24T20:03:40.836-05:00  INFO 24088 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 1 desde /172.29.96.1:50786
2025-11-24T20:03:44.439-05:00 ERROR 24088 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /172.29.96.1:50786: java.net.SocketException: Connection reset
2025-11-24T20:03:44.440-05:00  INFO 24088 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:50786 desconectado sin autenticarse.
2025-11-24T20:14:07.514-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 13896 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:14:07.517-05:00 DEBUG 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:14:07.517-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:14:08.562-05:00  INFO 13896 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:14:08.571-05:00  INFO 13896 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:14:08.571-05:00  INFO 13896 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:14:08.615-05:00  INFO 13896 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:14:08.617-05:00  INFO 13896 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1054 ms
2025-11-24T20:14:08.667-05:00  INFO 13896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:14:08.959-05:00  INFO 13896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:14:08.967-05:00  INFO 13896 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:14:08.999-05:00  INFO 13896 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@46dcbeab
2025-11-24T20:14:09.001-05:00  INFO 13896 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:14:09.001-05:00  INFO 13896 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:14:09.028-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:14:09.052-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:14:09.082-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:14:09.115-05:00  INFO 13896 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:14:09.120-05:00  INFO 13896 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:14:09.135-05:00  INFO 13896 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:14:09.137-05:00  INFO 13896 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T20:14:09.160-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:14:09.213-05:00  INFO 13896 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:14:09.455-05:00  INFO 13896 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:14:09.455-05:00  INFO 13896 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:14:09.455-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-24T20:14:09.460-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T20:14:09.466-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:14:09.469-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:14:09.470-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:14:09.473-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:14:09.474-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:14:09.476-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:14:09.476-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:14:09.479-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:14:09.479-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T20:14:09.508-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T20:14:09.509-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:14:09.568-05:00  INFO 13896 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:14:09.816-05:00  INFO 13896 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:14:09.823-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.698 seconds (process running for 2.957)
2025-11-24T20:14:09.825-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:14:09.826-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:14:09.826-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:14:09.826-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:14:09.826-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:14:09.826-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:14:09.843-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:14:09.843-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:14:09.845-05:00  INFO 13896 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:14:29.217-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 24496 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:14:29.218-05:00 DEBUG 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:14:29.219-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:14:30.139-05:00  INFO 24496 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:14:30.152-05:00  INFO 24496 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:14:30.153-05:00  INFO 24496 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:14:30.200-05:00  INFO 24496 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:14:30.200-05:00  INFO 24496 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 939 ms
2025-11-24T20:14:30.248-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T20:14:30.357-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:14:30.357-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T20:14:30.371-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:14:30.371-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T20:14:31.635-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T20:14:31.636-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:14:31.970-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:14:31.980-05:00  INFO 24496 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:14:32.017-05:00  INFO 24496 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@20ead579
2025-11-24T20:14:32.019-05:00  INFO 24496 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:14:32.019-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:14:32.058-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:14:32.091-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:14:32.131-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:14:32.166-05:00  INFO 24496 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:14:32.169-05:00  INFO 24496 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:14:32.237-05:00  INFO 24496 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:14:32.240-05:00  INFO 24496 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:14:32.260-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:14:32.301-05:00  INFO 24496 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:14:32.554-05:00  INFO 24496 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:14:32.554-05:00  INFO 24496 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:14:32.555-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:14:32.558-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:14:32.657-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:14:32.670-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:14:32.670-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:14:32.674-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:14:32.675-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:14:32.678-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:14:32.679-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:14:32.681-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:14:32.681-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:14:32.737-05:00  INFO 24496 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:14:33.009-05:00  INFO 24496 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:14:33.019-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.166 seconds (process running for 4.424)
2025-11-24T20:14:33.020-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:14:33.021-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:14:33.021-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:14:33.021-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:14:33.022-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:14:33.022-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:14:33.049-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:14:33.050-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:14:33.052-05:00  INFO 24496 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:26:35.172-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 23984 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:26:35.173-05:00 DEBUG 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:26:35.174-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:26:36.061-05:00  INFO 23984 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:26:36.072-05:00  INFO 23984 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:26:36.073-05:00  INFO 23984 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:26:36.121-05:00  INFO 23984 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:26:36.122-05:00  INFO 23984 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 906 ms
2025-11-24T20:26:36.179-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T20:26:36.298-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:26:36.298-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T20:26:36.307-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:26:36.308-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T20:26:37.579-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T20:26:37.579-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:26:37.873-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:26:37.883-05:00  INFO 23984 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:26:37.922-05:00  INFO 23984 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@3fcee3d9
2025-11-24T20:26:37.923-05:00  INFO 23984 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:26:37.924-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:26:37.949-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:26:37.975-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:26:38.014-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:26:38.057-05:00  INFO 23984 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:26:38.063-05:00  INFO 23984 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:26:38.116-05:00  INFO 23984 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:26:38.118-05:00  INFO 23984 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:26:38.138-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:26:38.189-05:00  INFO 23984 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:26:38.450-05:00  INFO 23984 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:26:38.450-05:00  INFO 23984 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:26:38.451-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:26:38.454-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:26:38.469-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:26:38.473-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:26:38.474-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:26:38.478-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:26:38.478-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:26:38.480-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:26:38.481-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:26:38.482-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:26:38.482-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:26:38.576-05:00  INFO 23984 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:26:38.849-05:00  INFO 23984 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:26:38.857-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.044 seconds (process running for 4.311)
2025-11-24T20:26:38.858-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:26:38.859-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:26:38.859-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:26:38.859-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:26:38.859-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:26:38.859-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:26:38.876-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:26:38.876-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:26:38.879-05:00  INFO 23984 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:27:13.946-05:00  INFO 23984 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:62223
2025-11-24T20:27:13.950-05:00  INFO 23984 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:62223
2025-11-24T20:27:16.385-05:00  INFO 23984 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:62223
2025-11-24T20:27:16.385-05:00  INFO 23984 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:62223
2025-11-24T20:27:16.386-05:00  INFO 23984 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:62223
2025-11-24T20:27:16.393-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:62223 conectado y saludado.
2025-11-24T20:27:16.393-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|postgres1|1234'
2025-11-24T20:27:16.418-05:00 DEBUG 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:27:16.423-05:00  WARN 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T20:27:16.473-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres1' (id=1) registrado en DB
2025-11-24T20:27:16.473-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres1' (id=1) desde /172.29.96.1:62223
2025-11-24T20:27:16.474-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres1 (id=1) desde /172.29.96.1:62223
2025-11-24T20:27:16.478-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T20:27:16.481-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T20:27:25.196-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T20:27:25.200-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T20:27:25.200-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:62223
2025-11-24T20:27:25.201-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:62223
2025-11-24T20:27:25.201-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T20:27:25.201-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-24T20:27:25.201-05:00 DEBUG 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:27:25.206-05:00 DEBUG 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:27:25.241-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=1cecd869-00a9-4d05-ba59-984d6e5f042f
2025-11-24T20:27:25.242-05:00 DEBUG 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:27:25.244-05:00 DEBUG 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:27:27.832-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres1' desconectado.
2025-11-24T20:27:27.833-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T20:27:27.833-05:00  INFO 23984 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T20:27:31.294-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 11444 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:27:31.296-05:00 DEBUG 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:27:31.297-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:27:32.348-05:00  INFO 11444 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:27:32.359-05:00  INFO 11444 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:27:32.359-05:00  INFO 11444 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:27:32.415-05:00  INFO 11444 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:27:32.416-05:00  INFO 11444 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1070 ms
2025-11-24T20:27:32.475-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=root)
2025-11-24T20:27:32.606-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://localhost:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:27:32.607-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://127.0.0.1:5433/mensajeria (user=root)
2025-11-24T20:27:32.629-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://127.0.0.1:5433/mensajeria: FATAL: password authentication failed for user "root"
2025-11-24T20:27:32.629-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://universidad-postgres:5432/mensajeria (user=root)
2025-11-24T20:27:33.903-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connect test failed for jdbc:postgresql://universidad-postgres:5432/mensajeria: El intento de conexión falló.
2025-11-24T20:27:33.903-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:27:34.198-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:27:34.207-05:00  INFO 11444 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:27:34.243-05:00  INFO 11444 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@760487aa
2025-11-24T20:27:34.244-05:00  INFO 11444 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:27:34.244-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:27:34.268-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:27:34.294-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:27:34.341-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:27:34.379-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:27:34.384-05:00  INFO 11444 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:27:34.444-05:00  INFO 11444 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:27:34.447-05:00  INFO 11444 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:27:34.467-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:27:34.512-05:00  INFO 11444 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:27:34.782-05:00  INFO 11444 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:27:34.782-05:00  INFO 11444 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:27:34.783-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:27:34.786-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:27:34.800-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:27:34.802-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:27:34.803-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:27:34.804-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:27:34.804-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:27:34.805-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:27:34.806-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:27:34.807-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:27:34.807-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:27:34.870-05:00  INFO 11444 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:27:35.124-05:00  INFO 11444 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:27:35.130-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.334 seconds (process running for 4.604)
2025-11-24T20:27:35.132-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:27:35.133-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:27:35.133-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:27:35.133-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:27:35.133-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:27:35.133-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:27:35.152-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T20:27:35.153-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T20:27:35.155-05:00  INFO 11444 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:27:36.387-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:62240
2025-11-24T20:27:36.389-05:00  INFO 11444 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:62240
2025-11-24T20:27:37.240-05:00  INFO 11444 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:62240
2025-11-24T20:27:37.241-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:62240
2025-11-24T20:27:37.241-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:62240
2025-11-24T20:27:37.246-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:62240 conectado y saludado.
2025-11-24T20:27:37.247-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T20:27:37.267-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T20:27:37.268-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:62240
2025-11-24T20:27:37.269-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:62240
2025-11-24T20:27:37.269-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T20:27:37.270-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-24T20:27:37.270-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:27:37.276-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:27:37.304-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=e3cdac39-b887-4ddb-abea-5cc174c24bda
2025-11-24T20:27:37.306-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:27:37.308-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:27:54.225-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:56773
2025-11-24T20:27:54.228-05:00  INFO 11444 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:56773
2025-11-24T20:27:55.863-05:00  INFO 11444 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:56773
2025-11-24T20:27:55.863-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:56773
2025-11-24T20:27:55.863-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:56773
2025-11-24T20:27:55.865-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:56773 conectado y saludado.
2025-11-24T20:27:55.865-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|postgres2|1234'
2025-11-24T20:27:55.865-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T20:27:55.869-05:00  WARN 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T20:27:55.991-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres2' (id=2) registrado en DB
2025-11-24T20:27:55.992-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres2' (id=2) desde /172.29.96.1:56773
2025-11-24T20:27:55.992-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres2 (id=2) desde /172.29.96.1:56773
2025-11-24T20:27:55.993-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-24T20:27:55.994-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-24T20:28:02.169-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|postgres2|1234'
2025-11-24T20:28:02.171-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres2' id=2
2025-11-24T20:28:02.172-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres2' id=2 desde /172.29.96.1:56773
2025-11-24T20:28:02.172-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres2 (id=2) desde /172.29.96.1:56773
2025-11-24T20:28:02.172-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres2 (user-conns=1)
2025-11-24T20:28:02.172-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: postgres1,postgres2
2025-11-24T20:28:02.172-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T20:28:02.176-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T20:28:02.303-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres2 id=2add61b3-f0d8-4cbb-9105-66b696e357d5
2025-11-24T20:28:02.304-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T20:28:02.306-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T20:28:08.487-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres1|mensajes en postgres'
2025-11-24T20:28:08.489-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-24 20:28:08] Mensaje enviado por: postgres2 Para postgres1 Contenido: mensajes en postgres
2025-11-24T20:28:08.490-05:00  INFO 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 20:28:08 Mensaje enviado por: postgres2 Para postgres1 Contenido: mensajes en postgres (desde /172.29.96.1:56773)
2025-11-24T20:28:08.490-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T20:28:08.501-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T20:28:08.501-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:28:08.509-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:28:08.512-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=2add61b3-f0d8-4cbb-9105-66b696e357d5 contenido='mensajes en postgres'
2025-11-24T20:28:08.514-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=2add61b3-f0d8-4cbb-9105-66b696e357d5
2025-11-24T20:28:15.523-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres2|respuestas en postgres'
2025-11-24T20:28:15.523-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-24 20:28:15] Mensaje enviado por: postgres1 Para postgres2 Contenido: respuestas en postgres
2025-11-24T20:28:15.524-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 20:28:15 Mensaje enviado por: postgres1 Para postgres2 Contenido: respuestas en postgres (desde /172.29.96.1:62240)
2025-11-24T20:28:15.525-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:28:15.529-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:28:15.530-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T20:28:15.531-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T20:28:15.531-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=e3cdac39-b887-4ddb-abea-5cc174c24bda contenido='respuestas en postgres'
2025-11-24T20:28:15.532-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=e3cdac39-b887-4ddb-abea-5cc174c24bda
2025-11-24T20:28:18.095-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres1' desconectado.
2025-11-24T20:28:18.096-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T20:28:18.097-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres2
2025-11-24T20:28:19.123-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:49418
2025-11-24T20:28:19.124-05:00  INFO 11444 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:49418
2025-11-24T20:28:21.494-05:00  INFO 11444 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:49418
2025-11-24T20:28:21.495-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:49418
2025-11-24T20:28:21.496-05:00  INFO 11444 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:49418
2025-11-24T20:28:21.496-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:49418 conectado y saludado.
2025-11-24T20:28:21.496-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T20:28:21.503-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T20:28:21.504-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:49418
2025-11-24T20:28:21.504-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:49418
2025-11-24T20:28:21.505-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T20:28:21.506-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: postgres1,postgres2
2025-11-24T20:28:21.506-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:28:21.510-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:28:21.547-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=f258afd3-360a-4634-a7d8-0725231658c1
2025-11-24T20:28:21.548-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:28:21.553-05:00 DEBUG 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:28:21.559-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a postgres1
2025-11-24T20:28:21.561-05:00  INFO 11444 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T20:28:18.098166 para evitar duplicados al usuario postgres1
2025-11-24T20:28:38.793-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 13116 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:28:38.795-05:00 DEBUG 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:28:38.795-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:28:39.854-05:00  INFO 13116 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:28:39.863-05:00  INFO 13116 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:28:39.863-05:00  INFO 13116 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:28:39.920-05:00  INFO 13116 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:28:39.921-05:00  INFO 13116 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1079 ms
2025-11-24T20:28:39.975-05:00  INFO 13116 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:28:40.300-05:00  INFO 13116 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:28:40.310-05:00  INFO 13116 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:28:40.345-05:00  INFO 13116 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@5ec1963c
2025-11-24T20:28:40.347-05:00  INFO 13116 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:28:40.347-05:00  INFO 13116 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:28:40.371-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:28:40.395-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:28:40.433-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:28:40.474-05:00  INFO 13116 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:28:40.480-05:00  INFO 13116 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:28:40.502-05:00  INFO 13116 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:28:40.504-05:00  INFO 13116 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T20:28:40.532-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:28:40.586-05:00  INFO 13116 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:28:40.835-05:00  INFO 13116 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:28:40.836-05:00  INFO 13116 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:28:40.836-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-24T20:28:40.839-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T20:28:40.844-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:28:40.847-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:28:40.848-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:28:40.852-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensajes en postgres; archivo_id=null; sesion_id=2add61b3-f0d8-4cbb-9105-66b696e357d5; creado_en=2025-11-25 01:28:08.517646; 
2025-11-24T20:28:40.853-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuestas en postgres; archivo_id=null; sesion_id=e3cdac39-b887-4ddb-abea-5cc174c24bda; creado_en=2025-11-25 01:28:15.534560; 
2025-11-24T20:28:40.853-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:28:40.856-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1cecd869-00a9-4d05-ba59-984d6e5f042f; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:27:25.211511; fecha_fin=2025-11-25 01:27:27.833726; estado=CERRADA; 
2025-11-24T20:28:40.856-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2add61b3-f0d8-4cbb-9105-66b696e357d5; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:28:02.178050; fecha_fin=null; estado=ACTIVA; 
2025-11-24T20:28:40.856-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=e3cdac39-b887-4ddb-abea-5cc174c24bda; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:27:37.286021; fecha_fin=2025-11-25 01:28:18.098166; estado=CERRADA; 
2025-11-24T20:28:40.857-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=f258afd3-360a-4634-a7d8-0725231658c1; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:28:21.515694; fecha_fin=null; estado=ACTIVA; 
2025-11-24T20:28:40.857-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:28:40.858-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:28:40.859-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:28:40.859-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T20:28:40.887-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T20:28:40.887-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:28:40.954-05:00  INFO 13116 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:28:41.210-05:00  INFO 13116 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:28:41.216-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.926 seconds (process running for 3.254)
2025-11-24T20:28:41.218-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:28:41.218-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:28:41.218-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:28:41.219-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:28:41.219-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:28:41.219-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:28:41.235-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-24T20:28:41.236-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-24T20:28:41.237-05:00  INFO 13116 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:28:59.354-05:00  INFO 13116 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:54976
2025-11-24T20:28:59.358-05:00  INFO 13116 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:54976
2025-11-24T20:29:00.120-05:00  INFO 13116 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:54976
2025-11-24T20:29:00.120-05:00  INFO 13116 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:54976
2025-11-24T20:29:00.120-05:00  INFO 13116 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:54976
2025-11-24T20:29:00.127-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:54976 conectado y saludado.
2025-11-24T20:29:00.128-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T20:29:00.143-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T20:29:00.143-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:54976
2025-11-24T20:29:00.143-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:54976
2025-11-24T20:29:00.144-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T20:29:00.144-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-24T20:29:00.145-05:00 DEBUG 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:29:00.149-05:00 DEBUG 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:29:00.282-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=812ea9c5-aab7-43cc-81ea-e3554ff0bf39
2025-11-24T20:29:00.283-05:00 DEBUG 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:29:00.285-05:00 DEBUG 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:29:00.288-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a postgres1
2025-11-24T20:29:00.291-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T20:28:18.098166 para evitar duplicados al usuario postgres1
2025-11-24T20:29:11.207-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres1' desconectado.
2025-11-24T20:29:11.208-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T20:29:11.208-05:00  INFO 13116 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T20:31:18.976-05:00  INFO 14828 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 14828 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:31:18.978-05:00 DEBUG 14828 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:31:18.978-05:00  INFO 14828 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:31:19.376-05:00  WARN 14828 --- [servidor] [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.support.BeanDefinitionOverrideException: Invalid bean definition with name 'dataSource' defined in class path resource [com/proyecto/demo/config/DataSourceConfig.class]: Cannot register bean definition [Root bean: class [null]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=true; factoryBeanName=dataSourceConfig; factoryMethodName=dataSource; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/proyecto/demo/config/DataSourceConfig.class]] for bean 'dataSource' since there is already [Root bean: class [null]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=true; factoryBeanName=databaseConfig; factoryMethodName=dataSource; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/proyecto/demo/config/DatabaseConfig.class]] bound.
2025-11-24T20:31:19.386-05:00  INFO 14828 --- [servidor] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-11-24T20:31:19.403-05:00 ERROR 14828 --- [servidor] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

The bean 'dataSource', defined in class path resource [com/proyecto/demo/config/DataSourceConfig.class], could not be registered. A bean with that name has already been defined in class path resource [com/proyecto/demo/config/DatabaseConfig.class] and overriding is disabled.

Action:

Consider renaming one of the beans or enabling overriding by setting spring.main.allow-bean-definition-overriding=true

2025-11-24T20:31:36.274-05:00  INFO 23580 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 23580 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:31:36.276-05:00 DEBUG 23580 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:31:36.276-05:00  INFO 23580 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:31:36.676-05:00  WARN 23580 --- [servidor] [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.support.BeanDefinitionOverrideException: Invalid bean definition with name 'dataSource' defined in class path resource [com/proyecto/demo/config/DataSourceConfig.class]: Cannot register bean definition [Root bean: class [null]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=true; factoryBeanName=dataSourceConfig; factoryMethodName=dataSource; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/proyecto/demo/config/DataSourceConfig.class]] for bean 'dataSource' since there is already [Root bean: class [null]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=true; factoryBeanName=databaseConfig; factoryMethodName=dataSource; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [com/proyecto/demo/config/DatabaseConfig.class]] bound.
2025-11-24T20:31:36.686-05:00  INFO 23580 --- [servidor] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-11-24T20:31:36.716-05:00 ERROR 23580 --- [servidor] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

The bean 'dataSource', defined in class path resource [com/proyecto/demo/config/DataSourceConfig.class], could not be registered. A bean with that name has already been defined in class path resource [com/proyecto/demo/config/DatabaseConfig.class] and overriding is disabled.

Action:

Consider renaming one of the beans or enabling overriding by setting spring.main.allow-bean-definition-overriding=true

2025-11-24T20:33:35.352-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 21004 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:33:35.353-05:00 DEBUG 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:33:35.354-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:33:36.310-05:00  INFO 21004 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:33:36.320-05:00  INFO 21004 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:33:36.320-05:00  INFO 21004 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:33:36.367-05:00  INFO 21004 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:33:36.367-05:00  INFO 21004 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 972 ms
2025-11-24T20:33:36.420-05:00  INFO 21004 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:33:36.719-05:00  INFO 21004 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:33:36.728-05:00  INFO 21004 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:33:36.776-05:00  INFO 21004 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@4a44cfc0
2025-11-24T20:33:36.778-05:00  INFO 21004 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:33:36.779-05:00  INFO 21004 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:33:36.809-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:33:36.830-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:33:36.861-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:33:36.892-05:00  INFO 21004 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:33:36.898-05:00  INFO 21004 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:33:36.913-05:00  INFO 21004 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:33:36.914-05:00  INFO 21004 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T20:33:36.937-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:33:36.985-05:00  INFO 21004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:33:37.210-05:00  INFO 21004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:33:37.211-05:00  INFO 21004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:33:37.211-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-24T20:33:37.213-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T20:33:37.221-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:33:37.223-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:33:37.223-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:33:37.229-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensajes en postgres; archivo_id=null; sesion_id=2add61b3-f0d8-4cbb-9105-66b696e357d5; creado_en=2025-11-25 01:28:08.517646; 
2025-11-24T20:33:37.229-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuestas en postgres; archivo_id=null; sesion_id=e3cdac39-b887-4ddb-abea-5cc174c24bda; creado_en=2025-11-25 01:28:15.534560; 
2025-11-24T20:33:37.230-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:33:37.232-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1cecd869-00a9-4d05-ba59-984d6e5f042f; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:27:25.211511; fecha_fin=2025-11-25 01:27:27.833726; estado=CERRADA; 
2025-11-24T20:33:37.233-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2add61b3-f0d8-4cbb-9105-66b696e357d5; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:28:02.178050; fecha_fin=null; estado=ACTIVA; 
2025-11-24T20:33:37.233-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=812ea9c5-aab7-43cc-81ea-e3554ff0bf39; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:29:00.152503; fecha_fin=2025-11-25 01:29:11.209394; estado=CERRADA; 
2025-11-24T20:33:37.233-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=e3cdac39-b887-4ddb-abea-5cc174c24bda; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:27:37.286021; fecha_fin=2025-11-25 01:28:18.098166; estado=CERRADA; 
2025-11-24T20:33:37.233-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=f258afd3-360a-4634-a7d8-0725231658c1; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:28:21.515694; fecha_fin=null; estado=ACTIVA; 
2025-11-24T20:33:37.233-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:33:37.235-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:33:37.236-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:33:37.236-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T20:33:37.263-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T20:33:37.264-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:33:37.271-05:00  INFO 21004 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-24T20:33:37.272-05:00  INFO 21004 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:33:37.288-05:00  INFO 21004 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@1f87607c
2025-11-24T20:33:37.289-05:00  INFO 21004 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:33:37.338-05:00  INFO 21004 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:33:37.612-05:00  INFO 21004 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:33:37.617-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.658 seconds (process running for 2.925)
2025-11-24T20:33:37.620-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:33:37.620-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:33:37.620-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:33:37.620-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:33:37.620-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:33:37.621-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:33:37.640-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-24T20:33:37.640-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-24T20:33:37.641-05:00  INFO 21004 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:33:57.346-05:00  INFO 21004 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:51724
2025-11-24T20:33:57.350-05:00  INFO 21004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:51724
2025-11-24T20:33:58.400-05:00  INFO 21004 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:51724
2025-11-24T20:33:58.400-05:00  INFO 21004 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:51724
2025-11-24T20:33:58.400-05:00  INFO 21004 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:51724
2025-11-24T20:33:58.405-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:51724 conectado y saludado.
2025-11-24T20:33:58.406-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|postgres2|1234'
2025-11-24T20:33:58.419-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres2' id=2
2025-11-24T20:33:58.420-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres2' id=2 desde /172.29.96.1:51724
2025-11-24T20:33:58.420-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres2 (id=2) desde /172.29.96.1:51724
2025-11-24T20:33:58.420-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres2 (user-conns=1)
2025-11-24T20:33:58.421-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres2
2025-11-24T20:33:58.421-05:00 DEBUG 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T20:33:58.423-05:00 DEBUG 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T20:33:58.500-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres2 id=c1b1077e-26f6-4cae-8882-e6b72b3af5cc
2025-11-24T20:33:58.500-05:00 DEBUG 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T20:33:58.502-05:00 DEBUG 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T20:33:58.504-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a postgres2
2025-11-24T20:37:50.757-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres2' desconectado.
2025-11-24T20:37:50.757-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres2 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T20:37:50.757-05:00  INFO 21004 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T20:38:17.292-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 24240 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:38:17.294-05:00 DEBUG 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:38:17.295-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:38:18.283-05:00  INFO 24240 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:38:18.291-05:00  INFO 24240 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:38:18.291-05:00  INFO 24240 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:38:18.343-05:00  INFO 24240 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:38:18.343-05:00  INFO 24240 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 998 ms
2025-11-24T20:38:18.399-05:00  INFO 24240 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:38:18.692-05:00  INFO 24240 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:38:18.700-05:00  INFO 24240 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:38:18.732-05:00  INFO 24240 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@f9cab00
2025-11-24T20:38:18.734-05:00  INFO 24240 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:38:18.735-05:00  INFO 24240 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:38:18.760-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:38:18.781-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:38:18.813-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:38:18.843-05:00  INFO 24240 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:38:18.849-05:00  INFO 24240 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:38:18.865-05:00  INFO 24240 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:38:18.867-05:00  INFO 24240 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T20:38:18.891-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:38:18.945-05:00  INFO 24240 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:38:19.183-05:00  INFO 24240 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:38:19.184-05:00  INFO 24240 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:38:19.184-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-24T20:38:19.186-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T20:38:19.191-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:38:19.194-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:38:19.194-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:38:19.201-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensajes en postgres; archivo_id=null; sesion_id=2add61b3-f0d8-4cbb-9105-66b696e357d5; creado_en=2025-11-25 01:28:08.517646; 
2025-11-24T20:38:19.201-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuestas en postgres; archivo_id=null; sesion_id=e3cdac39-b887-4ddb-abea-5cc174c24bda; creado_en=2025-11-25 01:28:15.534560; 
2025-11-24T20:38:19.201-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:38:19.204-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1cecd869-00a9-4d05-ba59-984d6e5f042f; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:27:25.211511; fecha_fin=2025-11-25 01:27:27.833726; estado=CERRADA; 
2025-11-24T20:38:19.204-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2add61b3-f0d8-4cbb-9105-66b696e357d5; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:28:02.178050; fecha_fin=null; estado=ACTIVA; 
2025-11-24T20:38:19.204-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=812ea9c5-aab7-43cc-81ea-e3554ff0bf39; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:29:00.152503; fecha_fin=2025-11-25 01:29:11.209394; estado=CERRADA; 
2025-11-24T20:38:19.205-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=c1b1077e-26f6-4cae-8882-e6b72b3af5cc; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:33:58.425507; fecha_fin=2025-11-25 01:37:50.758406; estado=CERRADA; 
2025-11-24T20:38:19.205-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=e3cdac39-b887-4ddb-abea-5cc174c24bda; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:27:37.286021; fecha_fin=2025-11-25 01:28:18.098166; estado=CERRADA; 
2025-11-24T20:38:19.206-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:38:19.208-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:38:19.208-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:38:19.208-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T20:38:19.235-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T20:38:19.236-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:38:19.244-05:00  INFO 24240 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-24T20:38:19.245-05:00  INFO 24240 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:38:19.263-05:00  INFO 24240 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@307e4c44
2025-11-24T20:38:19.263-05:00  INFO 24240 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:38:19.313-05:00  INFO 24240 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:38:19.572-05:00  INFO 24240 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:38:19.577-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.662 seconds (process running for 2.941)
2025-11-24T20:38:19.579-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:38:19.579-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:38:19.579-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:38:19.580-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:38:19.580-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:38:19.580-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:38:19.598-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-24T20:38:19.599-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-24T20:38:19.601-05:00  INFO 24240 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:38:45.488-05:00  INFO 24240 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:49404
2025-11-24T20:38:45.493-05:00  INFO 24240 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:49404
2025-11-24T20:38:46.231-05:00  INFO 24240 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:49404
2025-11-24T20:38:46.232-05:00  INFO 24240 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:49404
2025-11-24T20:38:46.233-05:00  INFO 24240 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:49404
2025-11-24T20:38:46.240-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:49404 conectado y saludado.
2025-11-24T20:38:46.241-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T20:38:46.262-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T20:38:46.263-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:49404
2025-11-24T20:38:46.263-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:49404
2025-11-24T20:38:46.263-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T20:38:46.263-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-24T20:38:46.264-05:00 DEBUG 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:38:46.267-05:00 DEBUG 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:38:46.327-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=3366f817-a855-4495-a4c2-1a33566003f4
2025-11-24T20:38:46.328-05:00 DEBUG 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:38:46.330-05:00 DEBUG 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:38:46.333-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a postgres1
2025-11-24T20:38:46.336-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T20:29:11.209394 para evitar duplicados al usuario postgres1
2025-11-24T20:38:48.654-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres1' desconectado.
2025-11-24T20:38:48.654-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T20:38:48.654-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T20:38:52.432-05:00  INFO 24240 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:49405
2025-11-24T20:38:52.435-05:00  INFO 24240 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:49405
2025-11-24T20:38:53.271-05:00  INFO 24240 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:49405
2025-11-24T20:38:53.272-05:00  INFO 24240 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:49405
2025-11-24T20:38:53.272-05:00  INFO 24240 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:49405
2025-11-24T20:38:53.273-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:49405 conectado y saludado.
2025-11-24T20:38:53.274-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T20:38:53.279-05:00  WARN 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login fallo: usuario proporcionado no coincide con BD (proporcionado='mysql1' vs bd='postgres1') for id=1
2025-11-24T20:38:53.279-05:00  WARN 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='1' desde /172.29.96.1:49405
2025-11-24T20:38:53.280-05:00  INFO 24240 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 1 desde /172.29.96.1:49405
2025-11-24T20:39:18.744-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 20640 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:39:18.745-05:00 DEBUG 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:39:18.745-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:39:19.700-05:00  INFO 20640 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:39:19.710-05:00  INFO 20640 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:39:19.710-05:00  INFO 20640 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:39:19.757-05:00  INFO 20640 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:39:19.757-05:00  INFO 20640 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 964 ms
2025-11-24T20:39:19.809-05:00  INFO 20640 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:39:19.941-05:00  INFO 20640 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:39:19.949-05:00  INFO 20640 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:39:19.987-05:00  INFO 20640 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@3a2d3909
2025-11-24T20:39:19.989-05:00  INFO 20640 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:39:19.989-05:00  INFO 20640 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:39:20.011-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:39:20.031-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:39:20.053-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:39:20.086-05:00  INFO 20640 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:39:20.093-05:00  INFO 20640 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:39:20.104-05:00  INFO 20640 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:39:20.106-05:00  INFO 20640 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:39:20.125-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:39:20.164-05:00  INFO 20640 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:39:20.447-05:00  INFO 20640 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:39:20.448-05:00  INFO 20640 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:39:20.448-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:39:20.448-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:39:20.453-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:39:20.456-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:39:20.456-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:39:20.458-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:39:20.458-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:39:20.459-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:39:20.459-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:39:20.460-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:39:20.460-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:39:20.468-05:00  INFO 20640 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T20:39:20.469-05:00  INFO 20640 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:39:20.482-05:00  INFO 20640 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@3451f01d
2025-11-24T20:39:20.483-05:00  INFO 20640 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:39:20.539-05:00  INFO 20640 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:39:20.824-05:00  INFO 20640 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:39:20.832-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.496 seconds (process running for 2.77)
2025-11-24T20:39:20.835-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:39:20.836-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:39:20.836-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:39:20.836-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:39:20.836-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:39:20.836-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:39:20.865-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:39:20.865-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:39:20.868-05:00  INFO 20640 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:39:31.853-05:00  INFO 20640 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:49434
2025-11-24T20:39:31.857-05:00  INFO 20640 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:49434
2025-11-24T20:39:32.859-05:00  INFO 20640 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:49434
2025-11-24T20:39:32.861-05:00  INFO 20640 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:49434
2025-11-24T20:39:32.862-05:00  INFO 20640 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:49434
2025-11-24T20:39:32.869-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:49434 conectado y saludado.
2025-11-24T20:39:32.912-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|mysql1|1234'
2025-11-24T20:39:32.959-05:00 DEBUG 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T20:39:32.965-05:00  WARN 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T20:39:32.997-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql1' (id=1) registrado en DB
2025-11-24T20:39:32.998-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql1' (id=1) desde /172.29.96.1:49434
2025-11-24T20:39:32.998-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql1 (id=1) desde /172.29.96.1:49434
2025-11-24T20:39:33.001-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T20:39:33.001-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T20:39:43.987-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|postgres1|1234'
2025-11-24T20:39:43.988-05:00 DEBUG 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:39:44.001-05:00  WARN 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T20:39:44.016-05:00  WARN 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Fallo al insertar usuario 'postgres1' en DB
2025-11-24T20:39:44.017-05:00  WARN 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro fallido (usuario existente o error): 'postgres1' (id=1) desde /172.29.96.1:49434
2025-11-24T20:39:44.017-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro fallido (usuario existente o error): postgres1 (id=1) desde /172.29.96.1:49434
2025-11-24T20:40:01.475-05:00 ERROR 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /172.29.96.1:49434: java.net.SocketException: Connection reset
2025-11-24T20:40:01.476-05:00  INFO 20640 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:49434 desconectado sin autenticarse.
2025-11-24T20:40:20.891-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 23256 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:40:20.893-05:00 DEBUG 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:40:20.894-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:40:21.719-05:00  INFO 23256 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:40:21.728-05:00  INFO 23256 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:40:21.728-05:00  INFO 23256 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:40:21.775-05:00  INFO 23256 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:40:21.775-05:00  INFO 23256 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 842 ms
2025-11-24T20:40:21.826-05:00  INFO 23256 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:40:21.973-05:00  INFO 23256 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:40:21.980-05:00  INFO 23256 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:40:22.015-05:00  INFO 23256 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@414f13fc
2025-11-24T20:40:22.017-05:00  INFO 23256 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:40:22.017-05:00  INFO 23256 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:40:22.037-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:40:22.059-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:40:22.076-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:40:22.113-05:00  INFO 23256 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:40:22.118-05:00  INFO 23256 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:40:22.127-05:00  INFO 23256 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:40:22.129-05:00  INFO 23256 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:40:22.145-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:40:22.182-05:00  INFO 23256 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:40:22.418-05:00  INFO 23256 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:40:22.418-05:00  INFO 23256 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:40:22.418-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:40:22.418-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:40:22.424-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:40:22.426-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:40:22.427-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:40:22.428-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:40:22.428-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:40:22.429-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:40:22.430-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:40:22.431-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=mysql1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:40:22.834-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Database init completed for Postgres (initOnStartup=true)
2025-11-24T20:40:22.841-05:00  INFO 23256 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T20:40:22.842-05:00  INFO 23256 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:40:22.853-05:00  INFO 23256 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@47768e74
2025-11-24T20:40:22.853-05:00  INFO 23256 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:40:22.891-05:00  INFO 23256 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:40:23.135-05:00  INFO 23256 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:40:23.142-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.653 seconds (process running for 2.907)
2025-11-24T20:40:23.144-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:40:23.145-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:40:23.145-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:40:23.145-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:40:23.145-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:40:23.146-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:40:23.165-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:40:23.165-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:40:23.167-05:00  INFO 23256 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:40:30.240-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 3436 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:40:30.241-05:00 DEBUG 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:40:30.242-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:40:31.135-05:00  INFO 3436 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:40:31.145-05:00  INFO 3436 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:40:31.146-05:00  INFO 3436 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:40:31.196-05:00  INFO 3436 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:40:31.196-05:00  INFO 3436 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 914 ms
2025-11-24T20:40:31.243-05:00  INFO 3436 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:40:31.524-05:00  INFO 3436 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:40:31.532-05:00  INFO 3436 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:40:31.563-05:00  INFO 3436 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@1f2f0109
2025-11-24T20:40:31.566-05:00  INFO 3436 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:40:31.566-05:00  INFO 3436 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:40:31.585-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:40:31.606-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:40:31.633-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:40:31.663-05:00  INFO 3436 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:40:31.668-05:00  INFO 3436 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:40:31.682-05:00  INFO 3436 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:40:31.684-05:00  INFO 3436 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T20:40:31.706-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:40:31.750-05:00  INFO 3436 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:40:31.979-05:00  INFO 3436 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:40:31.980-05:00  INFO 3436 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:40:31.980-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-24T20:40:31.982-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T20:40:31.987-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:40:31.990-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:40:31.991-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:40:31.996-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensajes en postgres; archivo_id=null; sesion_id=2add61b3-f0d8-4cbb-9105-66b696e357d5; creado_en=2025-11-25 01:28:08.517646; 
2025-11-24T20:40:31.996-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuestas en postgres; archivo_id=null; sesion_id=e3cdac39-b887-4ddb-abea-5cc174c24bda; creado_en=2025-11-25 01:28:15.534560; 
2025-11-24T20:40:31.997-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:40:32.000-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1cecd869-00a9-4d05-ba59-984d6e5f042f; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:27:25.211511; fecha_fin=2025-11-25 01:27:27.833726; estado=CERRADA; 
2025-11-24T20:40:32.000-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2add61b3-f0d8-4cbb-9105-66b696e357d5; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:28:02.178050; fecha_fin=null; estado=ACTIVA; 
2025-11-24T20:40:32.000-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3366f817-a855-4495-a4c2-1a33566003f4; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:38:46.271296; fecha_fin=2025-11-25 01:38:48.654629; estado=CERRADA; 
2025-11-24T20:40:32.000-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=812ea9c5-aab7-43cc-81ea-e3554ff0bf39; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:29:00.152503; fecha_fin=2025-11-25 01:29:11.209394; estado=CERRADA; 
2025-11-24T20:40:32.001-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=c1b1077e-26f6-4cae-8882-e6b72b3af5cc; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:33:58.425507; fecha_fin=2025-11-25 01:37:50.758406; estado=CERRADA; 
2025-11-24T20:40:32.001-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:40:32.003-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:40:32.004-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:40:32.004-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T20:40:32.029-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T20:40:33.584-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Database init completed for MySQL (initOnStartup=true)
2025-11-24T20:40:33.592-05:00  INFO 3436 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-24T20:40:33.592-05:00  INFO 3436 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:40:33.610-05:00  INFO 3436 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@33bb3f86
2025-11-24T20:40:33.610-05:00  INFO 3436 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:40:33.654-05:00  INFO 3436 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:40:33.891-05:00  INFO 3436 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:40:33.897-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 4.038 seconds (process running for 4.301)
2025-11-24T20:40:33.899-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:40:33.900-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:40:33.900-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:40:33.900-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:40:33.900-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:40:33.900-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:40:33.919-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:40:33.919-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:40:33.921-05:00  INFO 3436 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:40:42.274-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 24384 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:40:42.275-05:00 DEBUG 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:40:42.276-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:40:43.372-05:00  INFO 24384 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:40:43.812-05:00  INFO 24384 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:40:43.812-05:00  INFO 24384 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:40:43.863-05:00  INFO 24384 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:40:43.863-05:00  INFO 24384 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1532 ms
2025-11-24T20:40:43.917-05:00  INFO 24384 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T20:40:44.305-05:00  INFO 24384 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:40:44.315-05:00  INFO 24384 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:40:44.352-05:00  INFO 24384 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@4fa4f485
2025-11-24T20:40:44.354-05:00  INFO 24384 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:40:44.354-05:00  INFO 24384 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:40:44.448-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:40:44.476-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:40:44.522-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:40:44.538-05:00  INFO 24384 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:40:44.546-05:00  INFO 24384 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:40:44.564-05:00  INFO 24384 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T20:40:44.565-05:00  INFO 24384 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T20:40:44.589-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:40:44.652-05:00  INFO 24384 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:40:44.905-05:00  INFO 24384 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:40:44.906-05:00  INFO 24384 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:40:44.906-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-24T20:40:44.908-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T20:40:44.913-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:40:44.917-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:40:44.917-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:40:44.919-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:40:44.919-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:40:44.921-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:40:44.921-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:40:44.923-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:40:44.923-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T20:40:44.947-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T20:40:44.948-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:40:44.956-05:00  INFO 24384 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-24T20:40:44.975-05:00  INFO 24384 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:40:44.996-05:00  INFO 24384 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@1da1380b
2025-11-24T20:40:44.996-05:00  INFO 24384 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:40:45.057-05:00  INFO 24384 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:40:45.353-05:00  INFO 24384 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:40:45.363-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 3.527 seconds (process running for 3.802)
2025-11-24T20:40:45.365-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:40:45.365-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:40:45.365-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:40:45.365-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:40:45.366-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:40:45.366-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:40:45.383-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:40:45.383-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:40:45.385-05:00  INFO 24384 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:40:55.311-05:00  INFO 24384 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:53150
2025-11-24T20:40:55.315-05:00  INFO 24384 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:53150
2025-11-24T20:40:56.587-05:00  INFO 24384 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:53150
2025-11-24T20:40:56.587-05:00  INFO 24384 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:53150
2025-11-24T20:40:56.588-05:00  INFO 24384 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:53150
2025-11-24T20:40:56.595-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:53150 conectado y saludado.
2025-11-24T20:40:56.596-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|mysql1|1234'
2025-11-24T20:40:56.603-05:00 DEBUG 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T20:40:56.608-05:00  WARN 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T20:40:56.701-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql1' (id=1) registrado en DB
2025-11-24T20:40:56.701-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql1' (id=1) desde /172.29.96.1:53150
2025-11-24T20:40:56.702-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql1 (id=1) desde /172.29.96.1:53150
2025-11-24T20:40:56.704-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T20:40:56.704-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T20:41:02.347-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T20:41:02.351-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T20:41:02.351-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:53150
2025-11-24T20:41:02.351-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:53150
2025-11-24T20:41:02.352-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T20:41:02.353-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T20:41:02.353-05:00 DEBUG 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T20:41:02.356-05:00 DEBUG 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T20:41:02.388-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=45f77ac4-2eb2-49b2-8558-7385f6b1c554
2025-11-24T20:41:02.388-05:00 DEBUG 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T20:41:02.391-05:00 DEBUG 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T20:41:04.806-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql1' desconectado.
2025-11-24T20:41:04.808-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario mysql1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T20:41:04.808-05:00  INFO 24384 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T20:41:14.583-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 23136 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:41:14.585-05:00 DEBUG 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:41:14.585-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:41:15.489-05:00  INFO 23136 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:41:15.500-05:00  INFO 23136 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:41:15.500-05:00  INFO 23136 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:41:15.546-05:00  INFO 23136 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:41:15.547-05:00  INFO 23136 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 919 ms
2025-11-24T20:41:15.596-05:00  INFO 23136 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:41:15.738-05:00  INFO 23136 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:41:15.749-05:00  INFO 23136 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:41:15.787-05:00  INFO 23136 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@3a2d3909
2025-11-24T20:41:15.789-05:00  INFO 23136 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:41:15.789-05:00  INFO 23136 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:41:15.811-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:41:15.828-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:41:15.847-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:41:15.878-05:00  INFO 23136 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:41:15.883-05:00  INFO 23136 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:41:15.900-05:00  INFO 23136 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:41:15.901-05:00  INFO 23136 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:41:15.920-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:41:15.966-05:00  INFO 23136 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:41:16.216-05:00  INFO 23136 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:41:16.216-05:00  INFO 23136 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:41:16.216-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:41:16.217-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:41:16.222-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:41:16.225-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:41:16.226-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:41:16.227-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:41:16.227-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:41:16.229-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:41:16.229-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:41:16.231-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:41:16.231-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:41:16.239-05:00  INFO 23136 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T20:41:16.240-05:00  INFO 23136 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:41:16.253-05:00  INFO 23136 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@1cfc2538
2025-11-24T20:41:16.254-05:00  INFO 23136 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:41:16.310-05:00  INFO 23136 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:41:16.561-05:00  INFO 23136 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:41:16.568-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.438 seconds (process running for 2.699)
2025-11-24T20:41:16.570-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:41:16.571-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:41:16.571-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:41:16.571-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:41:16.571-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:41:16.572-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:41:16.589-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 0
2025-11-24T20:41:16.590-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 0
2025-11-24T20:41:16.591-05:00  INFO 23136 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:41:27.440-05:00  INFO 23136 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:58984
2025-11-24T20:41:27.447-05:00  INFO 23136 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:58984
2025-11-24T20:41:28.232-05:00  INFO 23136 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:58984
2025-11-24T20:41:28.232-05:00  INFO 23136 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:58984
2025-11-24T20:41:28.232-05:00  INFO 23136 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:58984
2025-11-24T20:41:28.253-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:58984 conectado y saludado.
2025-11-24T20:41:28.255-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 1|postgres1|1234'
2025-11-24T20:41:28.271-05:00 DEBUG 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:41:28.287-05:00  WARN 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres1' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T20:41:28.357-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres1' (id=1) registrado en DB
2025-11-24T20:41:28.357-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres1' (id=1) desde /172.29.96.1:58984
2025-11-24T20:41:28.358-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres1 (id=1) desde /172.29.96.1:58984
2025-11-24T20:41:28.359-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 1
2025-11-24T20:41:28.359-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 1
2025-11-24T20:41:35.395-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T20:41:35.398-05:00  WARN 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login fallo: usuario proporcionado no coincide con BD (proporcionado='mysql1' vs bd='postgres1') for id=1
2025-11-24T20:41:35.398-05:00  WARN 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login fallido: usuario='1' desde /172.29.96.1:58984
2025-11-24T20:41:35.398-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login fallido: 1 desde /172.29.96.1:58984
2025-11-24T20:41:40.369-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T20:41:40.373-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T20:41:40.373-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:58984
2025-11-24T20:41:40.374-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:58984
2025-11-24T20:41:40.374-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T20:41:40.374-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-24T20:41:40.375-05:00 DEBUG 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:41:40.375-05:00 DEBUG 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:41:40.389-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=37f675ce-dc30-4bb6-98b0-24de85a380a6
2025-11-24T20:41:40.390-05:00 DEBUG 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T20:41:40.391-05:00 DEBUG 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T20:41:46.266-05:00 ERROR 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /172.29.96.1:58984: java.net.SocketException: Connection reset
2025-11-24T20:41:46.266-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres1' desconectado.
2025-11-24T20:41:46.266-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T20:41:46.266-05:00  INFO 23136 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T20:47:12.895-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 16176 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:47:12.897-05:00 DEBUG 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:47:12.898-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:47:13.821-05:00  INFO 16176 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:47:13.832-05:00  INFO 16176 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:47:13.833-05:00  INFO 16176 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:47:13.878-05:00  INFO 16176 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:47:13.878-05:00  INFO 16176 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 931 ms
2025-11-24T20:47:13.925-05:00  INFO 16176 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:47:14.071-05:00  INFO 16176 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:47:14.082-05:00  INFO 16176 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:47:14.118-05:00  INFO 16176 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@37637a24
2025-11-24T20:47:14.120-05:00  INFO 16176 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:47:14.120-05:00  INFO 16176 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:47:14.141-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:47:14.158-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:47:14.175-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:47:14.202-05:00  INFO 16176 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:47:14.209-05:00  INFO 16176 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:47:14.222-05:00  INFO 16176 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:47:14.223-05:00  INFO 16176 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:47:14.242-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:47:14.277-05:00  INFO 16176 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:47:14.564-05:00  INFO 16176 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:47:14.565-05:00  INFO 16176 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:47:14.565-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:47:14.565-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:47:14.572-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:47:14.575-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:47:14.575-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:47:14.577-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:47:14.578-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:47:14.579-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T20:47:14.579-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:47:14.581-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:47:14.582-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:47:14.590-05:00  INFO 16176 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T20:47:14.591-05:00  INFO 16176 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:47:14.605-05:00  INFO 16176 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@77dba4cd
2025-11-24T20:47:14.605-05:00  INFO 16176 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:47:14.676-05:00  INFO 16176 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:47:14.933-05:00  INFO 16176 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:47:14.939-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.408 seconds (process running for 2.674)
2025-11-24T20:47:14.940-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:47:14.940-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:47:14.941-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:47:14.941-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:47:14.941-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:47:14.941-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:47:14.954-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T20:47:14.955-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T20:47:14.956-05:00  INFO 16176 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:47:36.372-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 22976 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:47:36.373-05:00 DEBUG 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:47:36.374-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:47:37.247-05:00  INFO 22976 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:47:37.256-05:00  INFO 22976 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:47:37.256-05:00  INFO 22976 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:47:37.301-05:00  INFO 22976 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:47:37.301-05:00  INFO 22976 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 885 ms
2025-11-24T20:47:37.348-05:00  INFO 22976 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:47:37.492-05:00  INFO 22976 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:47:37.497-05:00  INFO 22976 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:47:37.527-05:00  INFO 22976 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@194d329e
2025-11-24T20:47:37.531-05:00  INFO 22976 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:47:37.532-05:00  INFO 22976 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:47:37.554-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:47:37.576-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:47:37.592-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:47:37.619-05:00  INFO 22976 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:47:37.624-05:00  INFO 22976 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:47:37.634-05:00  INFO 22976 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:47:37.635-05:00  INFO 22976 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:47:37.651-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:47:37.685-05:00  INFO 22976 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:47:37.910-05:00  INFO 22976 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:47:37.910-05:00  INFO 22976 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:47:37.910-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:47:37.911-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:47:37.916-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:47:37.919-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:47:37.919-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:47:37.921-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:47:37.921-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:47:37.922-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T20:47:37.922-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:47:37.924-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:47:37.924-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:47:37.931-05:00  INFO 22976 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T20:47:37.932-05:00  INFO 22976 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:47:37.944-05:00  INFO 22976 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@5d342959
2025-11-24T20:47:37.944-05:00  INFO 22976 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:47:37.989-05:00  INFO 22976 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:47:38.239-05:00  INFO 22976 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:47:38.245-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.265 seconds (process running for 2.519)
2025-11-24T20:47:38.247-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:47:38.248-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:47:38.248-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:47:38.248-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:47:38.248-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:47:38.248-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:47:38.266-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T20:47:38.266-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T20:47:38.267-05:00  INFO 22976 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:52:32.841-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 24468 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:52:32.843-05:00 DEBUG 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:52:32.843-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:52:33.758-05:00  INFO 24468 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:52:33.767-05:00  INFO 24468 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:52:33.767-05:00  INFO 24468 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:52:33.812-05:00  INFO 24468 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:52:33.813-05:00  INFO 24468 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 929 ms
2025-11-24T20:52:33.862-05:00  INFO 24468 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:52:34.012-05:00  INFO 24468 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:52:34.019-05:00  INFO 24468 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:52:34.077-05:00  INFO 24468 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@6dab01d9
2025-11-24T20:52:34.079-05:00  INFO 24468 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:52:34.079-05:00  INFO 24468 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:52:34.105-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:52:34.126-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:52:34.143-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:52:34.189-05:00  INFO 24468 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:52:34.198-05:00  INFO 24468 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:52:34.210-05:00  INFO 24468 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:52:34.212-05:00  INFO 24468 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:52:34.233-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:52:34.274-05:00  INFO 24468 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:52:34.509-05:00  INFO 24468 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:52:34.509-05:00  INFO 24468 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:52:34.510-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:52:34.511-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:52:34.515-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:52:34.519-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:52:34.519-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:52:34.520-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:52:34.520-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:52:34.522-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T20:52:34.522-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:52:34.523-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:52:34.524-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:52:34.533-05:00  INFO 24468 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T20:52:34.534-05:00  INFO 24468 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:52:34.547-05:00  INFO 24468 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@7d979d34
2025-11-24T20:52:34.547-05:00  INFO 24468 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:52:34.604-05:00  INFO 24468 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:52:34.980-05:00  INFO 24468 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:52:34.987-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.557 seconds (process running for 2.841)
2025-11-24T20:52:34.991-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:52:34.991-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:52:34.991-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:52:34.991-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:52:34.992-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:52:34.992-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:52:35.006-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T20:52:35.007-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T20:52:35.008-05:00  INFO 24468 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T20:58:13.129-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 17460 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T20:58:13.130-05:00 DEBUG 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T20:58:13.131-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T20:58:14.045-05:00  INFO 17460 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T20:58:14.055-05:00  INFO 17460 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T20:58:14.055-05:00  INFO 17460 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T20:58:14.106-05:00  INFO 17460 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T20:58:14.107-05:00  INFO 17460 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 936 ms
2025-11-24T20:58:14.163-05:00  INFO 17460 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:58:14.304-05:00  INFO 17460 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:58:14.310-05:00  INFO 17460 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T20:58:14.343-05:00  INFO 17460 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@36327cec
2025-11-24T20:58:14.344-05:00  INFO 17460 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T20:58:14.345-05:00  INFO 17460 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T20:58:14.369-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T20:58:14.388-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T20:58:14.407-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T20:58:14.440-05:00  INFO 17460 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T20:58:14.447-05:00  INFO 17460 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T20:58:14.459-05:00  INFO 17460 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T20:58:14.460-05:00  INFO 17460 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T20:58:14.478-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T20:58:14.518-05:00  INFO 17460 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T20:58:14.796-05:00  INFO 17460 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T20:58:14.796-05:00  INFO 17460 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T20:58:14.796-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T20:58:14.797-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T20:58:14.802-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T20:58:14.805-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:58:14.805-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T20:58:14.807-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T20:58:14.807-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T20:58:14.808-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T20:58:14.808-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T20:58:14.810-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T20:58:14.811-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T20:58:14.820-05:00  INFO 17460 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T20:58:14.821-05:00  INFO 17460 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T20:58:14.834-05:00  INFO 17460 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@3451f01d
2025-11-24T20:58:14.834-05:00  INFO 17460 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T20:58:14.893-05:00  INFO 17460 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T20:58:15.190-05:00  INFO 17460 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T20:58:15.198-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.476 seconds (process running for 2.735)
2025-11-24T20:58:15.200-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T20:58:15.200-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T20:58:15.200-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T20:58:15.200-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T20:58:15.201-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T20:58:15.201-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T20:58:15.219-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T20:58:15.219-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T20:58:15.222-05:00  INFO 17460 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:02:55.180-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 20356 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:02:55.181-05:00 DEBUG 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:02:55.182-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:02:56.276-05:00  INFO 20356 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:02:56.288-05:00  INFO 20356 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:02:56.288-05:00  INFO 20356 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:02:56.336-05:00  INFO 20356 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:02:56.337-05:00  INFO 20356 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1102 ms
2025-11-24T21:02:56.388-05:00  INFO 20356 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:02:56.596-05:00  INFO 20356 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:02:56.607-05:00  INFO 20356 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:02:56.637-05:00  INFO 20356 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@310aee0b
2025-11-24T21:02:56.639-05:00  INFO 20356 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:02:56.640-05:00  INFO 20356 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:02:56.660-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:02:56.679-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:02:56.701-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:02:56.734-05:00  INFO 20356 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 172.29.96.1:9001
2025-11-24T21:02:56.740-05:00  INFO 20356 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:02:56.752-05:00  INFO 20356 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:02:56.753-05:00  INFO 20356 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:02:56.771-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:02:56.812-05:00  INFO 20356 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:02:57.057-05:00  INFO 20356 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:02:57.058-05:00  INFO 20356 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:02:57.058-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:02:57.058-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:02:57.090-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:02:57.094-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:02:57.094-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:02:57.096-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:02:57.096-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:02:57.097-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:02:57.097-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:02:57.098-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:02:57.099-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:02:57.109-05:00  INFO 20356 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:02:57.109-05:00  INFO 20356 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:02:57.122-05:00  INFO 20356 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@2c991465
2025-11-24T21:02:57.122-05:00  INFO 20356 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:02:57.175-05:00  INFO 20356 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:02:57.426-05:00  INFO 20356 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:02:57.434-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.726 seconds (process running for 2.989)
2025-11-24T21:02:57.435-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=172.29.96.1, port=9010
2025-11-24T21:02:57.436-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:02:57.436-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:02:57.436-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:02:57.436-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:02:57.436-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:02:57.454-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T21:02:57.454-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T21:02:57.456-05:00  INFO 20356 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:07:35.054-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 780 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:07:35.057-05:00 DEBUG 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:07:35.058-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:07:36.152-05:00  INFO 780 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:07:36.161-05:00  INFO 780 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:07:36.163-05:00  INFO 780 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:07:36.207-05:00  INFO 780 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:07:36.207-05:00  INFO 780 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1104 ms
2025-11-24T21:07:36.254-05:00  INFO 780 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:07:36.395-05:00  INFO 780 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:07:36.407-05:00  INFO 780 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:07:36.451-05:00  INFO 780 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@24386839
2025-11-24T21:07:36.454-05:00  INFO 780 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:07:36.454-05:00  INFO 780 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:07:36.478-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:07:36.499-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:07:36.521-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:07:36.562-05:00  INFO 780 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:07:36.568-05:00  INFO 780 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:07:36.582-05:00  INFO 780 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:07:36.584-05:00  INFO 780 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:07:36.600-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:07:36.644-05:00  INFO 780 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:07:36.909-05:00  INFO 780 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:07:36.909-05:00  INFO 780 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:07:36.910-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:07:36.910-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:07:36.917-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:07:36.920-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:07:36.921-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:07:36.922-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:07:36.923-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:07:36.925-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:07:36.925-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:07:36.926-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:07:36.926-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:07:36.936-05:00  INFO 780 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:07:36.937-05:00  INFO 780 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:07:36.955-05:00  INFO 780 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@205df5dc
2025-11-24T21:07:36.955-05:00  INFO 780 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:07:37.016-05:00  INFO 780 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:07:37.306-05:00  INFO 780 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:07:37.313-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.758 seconds (process running for 3.043)
2025-11-24T21:07:37.316-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:07:37.316-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:07:37.316-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:07:37.317-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:07:37.317-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:07:37.317-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:07:37.331-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T21:07:37.331-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T21:07:37.332-05:00  INFO 780 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:07:42.620-05:00  INFO 780 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-24T21:07:42.620-05:00  INFO 780 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-24T21:07:42.621-05:00  INFO 780 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-11-24T21:08:40.706-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 12520 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:08:40.708-05:00 DEBUG 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:08:40.709-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:08:41.636-05:00  INFO 12520 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:08:41.646-05:00  INFO 12520 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:08:41.646-05:00  INFO 12520 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:08:41.705-05:00  INFO 12520 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:08:41.705-05:00  INFO 12520 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 954 ms
2025-11-24T21:08:41.760-05:00  INFO 12520 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:08:41.895-05:00  INFO 12520 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:08:41.906-05:00  INFO 12520 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:08:41.937-05:00  INFO 12520 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@3a2d3909
2025-11-24T21:08:41.939-05:00  INFO 12520 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:08:41.939-05:00  INFO 12520 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:08:41.961-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:08:41.982-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:08:42.005-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:08:42.036-05:00  INFO 12520 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:08:42.042-05:00  INFO 12520 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:08:42.057-05:00  INFO 12520 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:08:42.059-05:00  INFO 12520 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:08:42.077-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:08:42.123-05:00  INFO 12520 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:08:42.368-05:00  INFO 12520 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:08:42.369-05:00  INFO 12520 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:08:42.369-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:08:42.369-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:08:42.374-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:08:42.377-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:08:42.377-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:08:42.378-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:08:42.378-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:08:42.380-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:08:42.380-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:08:42.381-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:08:42.381-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:08:42.390-05:00  INFO 12520 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:08:42.391-05:00  INFO 12520 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:08:42.403-05:00  INFO 12520 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@2ecf5915
2025-11-24T21:08:42.403-05:00  INFO 12520 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:08:42.454-05:00  INFO 12520 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:08:42.714-05:00  INFO 12520 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:08:42.721-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.415 seconds (process running for 2.682)
2025-11-24T21:08:42.722-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:08:42.722-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:08:42.724-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:08:42.724-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:08:42.724-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:08:42.724-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:08:42.744-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T21:08:42.745-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T21:08:42.747-05:00  INFO 12520 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:08:47.738-05:00  INFO 12520 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-24T21:08:47.738-05:00  INFO 12520 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-24T21:08:47.739-05:00  INFO 12520 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-11-24T21:19:41.419-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 23912 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:19:41.476-05:00 DEBUG 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:19:41.478-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:19:42.396-05:00  INFO 23912 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:19:42.408-05:00  INFO 23912 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:19:42.408-05:00  INFO 23912 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:19:42.457-05:00  INFO 23912 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:19:42.458-05:00  INFO 23912 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 939 ms
2025-11-24T21:19:42.508-05:00  INFO 23912 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:19:42.642-05:00  INFO 23912 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:19:42.648-05:00  INFO 23912 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:19:42.682-05:00  INFO 23912 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@36327cec
2025-11-24T21:19:42.684-05:00  INFO 23912 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:19:42.684-05:00  INFO 23912 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:19:42.706-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:19:42.727-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:19:42.745-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:19:42.773-05:00  INFO 23912 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:19:42.779-05:00  INFO 23912 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:19:42.789-05:00  INFO 23912 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:19:42.791-05:00  INFO 23912 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:19:42.807-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:19:42.840-05:00  INFO 23912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:19:43.070-05:00  INFO 23912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:19:43.070-05:00  INFO 23912 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:19:43.070-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:19:43.071-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:19:43.076-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:19:43.079-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:19:43.079-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:19:43.081-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:19:43.081-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:19:43.082-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:19:43.083-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:19:43.083-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:19:43.084-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:19:43.094-05:00  INFO 23912 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:19:43.094-05:00  INFO 23912 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:19:43.107-05:00  INFO 23912 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@5fef2aac
2025-11-24T21:19:43.107-05:00  INFO 23912 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:19:43.157-05:00  INFO 23912 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:19:43.422-05:00  INFO 23912 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:19:43.429-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.42 seconds (process running for 2.674)
2025-11-24T21:19:43.432-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:19:43.432-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:19:43.432-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:19:43.432-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:19:43.433-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:19:43.433-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:19:43.450-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T21:19:43.450-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T21:19:43.451-05:00  INFO 23912 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:19:50.055-05:00  INFO 23912 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-24T21:19:50.055-05:00  INFO 23912 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-24T21:19:50.055-05:00  INFO 23912 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2025-11-24T21:22:11.830-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 21888 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:22:11.832-05:00 DEBUG 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:22:11.832-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:22:12.784-05:00  INFO 21888 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:22:12.795-05:00  INFO 21888 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:22:12.795-05:00  INFO 21888 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:22:12.840-05:00  INFO 21888 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:22:12.840-05:00  INFO 21888 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 962 ms
2025-11-24T21:22:12.890-05:00  INFO 21888 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T21:22:13.192-05:00  INFO 21888 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T21:22:13.201-05:00  INFO 21888 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:22:13.238-05:00  INFO 21888 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@32eae6f2
2025-11-24T21:22:13.241-05:00  INFO 21888 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:22:13.241-05:00  INFO 21888 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T21:22:13.268-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:22:13.288-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:22:13.325-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:22:13.361-05:00  INFO 21888 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:22:13.372-05:00  INFO 21888 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:22:13.389-05:00  INFO 21888 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T21:22:13.392-05:00  INFO 21888 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T21:22:13.415-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:22:13.510-05:00  INFO 21888 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:22:13.761-05:00  INFO 21888 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:22:13.762-05:00  INFO 21888 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:22:13.762-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-24T21:22:13.764-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T21:22:13.770-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:22:13.774-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:22:13.774-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:22:13.776-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:22:13.776-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:22:13.782-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=45f77ac4-2eb2-49b2-8558-7385f6b1c554; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:41:02.358329; fecha_fin=2025-11-25 01:41:04.808483; estado=CERRADA; 
2025-11-24T21:22:13.782-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:22:13.784-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=mysql1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:22:13.784-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T21:22:13.810-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T21:22:13.810-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:22:13.821-05:00  INFO 21888 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-24T21:22:13.822-05:00  INFO 21888 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:22:13.838-05:00  INFO 21888 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@65629ac6
2025-11-24T21:22:13.838-05:00  INFO 21888 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:22:13.888-05:00  INFO 21888 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:22:14.144-05:00  INFO 21888 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:22:14.150-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.752 seconds (process running for 3.008)
2025-11-24T21:22:14.154-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:22:14.154-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:22:14.154-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:22:14.154-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:22:14.154-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:22:14.154-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:22:14.172-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T21:22:14.173-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T21:22:14.174-05:00  INFO 21888 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:22:35.482-05:00  INFO 21888 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-24T21:22:35.482-05:00  INFO 21888 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-24T21:22:35.482-05:00  INFO 21888 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2025-11-24T21:25:07.600-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 2344 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:25:07.601-05:00 DEBUG 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:25:07.601-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:25:08.515-05:00  INFO 2344 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:25:08.526-05:00  INFO 2344 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:25:08.526-05:00  INFO 2344 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:25:08.575-05:00  INFO 2344 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:25:08.576-05:00  INFO 2344 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 935 ms
2025-11-24T21:25:08.623-05:00  INFO 2344 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:25:08.762-05:00  INFO 2344 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:25:08.772-05:00  INFO 2344 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:25:08.801-05:00  INFO 2344 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@596a7f44
2025-11-24T21:25:08.802-05:00  INFO 2344 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:25:08.802-05:00  INFO 2344 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:25:08.826-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:25:08.845-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:25:08.863-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:25:08.892-05:00  INFO 2344 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:25:08.899-05:00  INFO 2344 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:25:08.909-05:00  INFO 2344 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:25:08.911-05:00  INFO 2344 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:25:08.927-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:25:08.962-05:00  INFO 2344 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:25:09.196-05:00  INFO 2344 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:25:09.197-05:00  INFO 2344 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:25:09.197-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:25:09.197-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:25:09.203-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:25:09.206-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:25:09.206-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:25:09.208-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:25:09.208-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:25:09.209-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:25:09.210-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:25:09.211-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:25:09.211-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:25:09.222-05:00  INFO 2344 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:25:09.222-05:00  INFO 2344 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:25:09.235-05:00  INFO 2344 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@118dcbbd
2025-11-24T21:25:09.235-05:00  INFO 2344 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:25:09.306-05:00  INFO 2344 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:25:09.546-05:00  INFO 2344 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:25:09.552-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.341 seconds (process running for 2.605)
2025-11-24T21:25:09.555-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:25:09.556-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:25:09.556-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:25:09.556-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:25:09.556-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:25:09.556-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:25:09.573-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T21:25:09.574-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T21:25:09.576-05:00  INFO 2344 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:25:14.904-05:00  INFO 2344 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-24T21:25:14.905-05:00  INFO 2344 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-24T21:25:14.905-05:00  INFO 2344 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2025-11-24T21:25:29.093-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 17168 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:25:29.095-05:00 DEBUG 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:25:29.096-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:25:29.982-05:00  INFO 17168 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:25:29.991-05:00  INFO 17168 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:25:29.992-05:00  INFO 17168 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:25:30.039-05:00  INFO 17168 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:25:30.039-05:00  INFO 17168 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 903 ms
2025-11-24T21:25:30.097-05:00  INFO 17168 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-24T21:25:30.414-05:00  INFO 17168 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T21:25:30.423-05:00  INFO 17168 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:25:30.458-05:00  INFO 17168 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@4fa4f485
2025-11-24T21:25:30.460-05:00  INFO 17168 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:25:30.460-05:00  INFO 17168 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T21:25:30.485-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:25:30.505-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:25:30.535-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:25:30.571-05:00  INFO 17168 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:25:30.578-05:00  INFO 17168 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:25:30.596-05:00  INFO 17168 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-24T21:25:30.599-05:00  INFO 17168 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-24T21:25:30.622-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:25:30.678-05:00  INFO 17168 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:25:30.901-05:00  INFO 17168 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:25:30.901-05:00  INFO 17168 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:25:30.901-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-24T21:25:30.904-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-24T21:25:30.908-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:25:30.912-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:25:30.913-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:25:30.914-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:25:30.914-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:25:30.921-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=45f77ac4-2eb2-49b2-8558-7385f6b1c554; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-25 01:41:02.358329; fecha_fin=2025-11-25 01:41:04.808483; estado=CERRADA; 
2025-11-24T21:25:30.921-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:25:30.923-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=mysql1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:25:30.924-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-24T21:25:30.953-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-24T21:25:30.953-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:25:30.964-05:00  INFO 17168 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-24T21:25:30.965-05:00  INFO 17168 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:25:30.981-05:00  INFO 17168 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@7d42542
2025-11-24T21:25:30.982-05:00  INFO 17168 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:25:31.031-05:00  INFO 17168 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:25:31.283-05:00  INFO 17168 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:25:31.291-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.581 seconds (process running for 2.87)
2025-11-24T21:25:31.293-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:25:31.293-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:25:31.293-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:25:31.293-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:25:31.293-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:25:31.294-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:25:31.316-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T21:25:31.316-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T21:25:31.317-05:00  INFO 17168 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:25:36.528-05:00  INFO 17168 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-24T21:25:36.528-05:00  INFO 17168 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-24T21:25:36.529-05:00  INFO 17168 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-11-24T21:27:53.648-05:00  INFO 17168 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:64223
2025-11-24T21:27:53.653-05:00  INFO 17168 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:64223
2025-11-24T21:27:55.606-05:00  INFO 17168 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:64223
2025-11-24T21:27:55.606-05:00  INFO 17168 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:64223
2025-11-24T21:27:55.606-05:00  INFO 17168 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:64223
2025-11-24T21:27:55.612-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:64223 conectado y saludado.
2025-11-24T21:27:55.612-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-24T21:27:55.630-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-24T21:27:55.630-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /172.29.96.1:64223
2025-11-24T21:27:55.630-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /172.29.96.1:64223
2025-11-24T21:27:55.631-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-24T21:27:55.632-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-24T21:27:55.633-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T21:27:55.635-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T21:27:55.697-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=e5eb85d1-3f9c-4c3a-af68-1329e21a774f
2025-11-24T21:27:55.697-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T21:27:55.699-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T21:28:12.210-05:00  INFO 17168 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:64228
2025-11-24T21:28:12.212-05:00  INFO 17168 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:64228
2025-11-24T21:28:13.958-05:00  INFO 17168 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:64228
2025-11-24T21:28:13.959-05:00  INFO 17168 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:64228
2025-11-24T21:28:13.959-05:00  INFO 17168 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:64228
2025-11-24T21:28:13.961-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:64228 conectado y saludado.
2025-11-24T21:28:13.962-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|mysql2|1234'
2025-11-24T21:28:13.962-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T21:28:13.970-05:00  WARN 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T21:28:14.007-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql2' (id=2) registrado en DB
2025-11-24T21:28:14.007-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql2' (id=2) desde /172.29.96.1:64228
2025-11-24T21:28:14.007-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql2 (id=2) desde /172.29.96.1:64228
2025-11-24T21:28:14.009-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-24T21:28:14.010-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-24T21:28:21.640-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|mysql2|1234'
2025-11-24T21:28:21.643-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql2' id=2
2025-11-24T21:28:21.643-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql2' id=2 desde /172.29.96.1:64228
2025-11-24T21:28:21.643-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql2 (id=2) desde /172.29.96.1:64228
2025-11-24T21:28:21.643-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql2 (user-conns=1)
2025-11-24T21:28:21.643-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql2
2025-11-24T21:28:21.644-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T21:28:21.647-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T21:28:21.685-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql2 id=1588c4d1-26c5-47ed-b833-092147b98340
2025-11-24T21:28:21.686-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T21:28:21.687-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T21:28:29.178-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql1|hola a mysql1'
2025-11-24T21:28:29.179-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-24 21:28:29] Mensaje enviado por: mysql2 Para mysql1 Contenido: hola a mysql1
2025-11-24T21:28:29.181-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 21:28:29 Mensaje enviado por: mysql2 Para mysql1 Contenido: hola a mysql1 (desde /172.29.96.1:64228)
2025-11-24T21:28:29.181-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T21:28:29.201-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T21:28:29.202-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T21:28:29.213-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T21:28:29.214-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=1588c4d1-26c5-47ed-b833-092147b98340 contenido='hola a mysql1'
2025-11-24T21:28:29.214-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=1588c4d1-26c5-47ed-b833-092147b98340
2025-11-24T21:28:36.636-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql2|respuesta a mysql2'
2025-11-24T21:28:36.636-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-24 21:28:36] Mensaje enviado por: mysql1 Para mysql2 Contenido: respuesta a mysql2
2025-11-24T21:28:36.637-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 21:28:36 Mensaje enviado por: mysql1 Para mysql2 Contenido: respuesta a mysql2 (desde /172.29.96.1:64223)
2025-11-24T21:28:36.637-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-24T21:28:36.645-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-24T21:28:36.645-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql2' usando columna='nombre_usuario'
2025-11-24T21:28:36.647-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='mysql2'
2025-11-24T21:28:36.648-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=e5eb85d1-3f9c-4c3a-af68-1329e21a774f contenido='respuesta a mysql2'
2025-11-24T21:28:36.648-05:00 DEBUG 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=e5eb85d1-3f9c-4c3a-af68-1329e21a774f
2025-11-24T21:29:12.643-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql1' desconectado.
2025-11-24T21:29:12.644-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario mysql1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T21:29:12.645-05:00  INFO 17168 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql2
2025-11-24T21:29:15.961-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql2' desconectado.
2025-11-24T21:29:15.961-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario mysql2 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T21:29:15.962-05:00  INFO 17168 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T21:29:30.921-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 22260 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:29:30.923-05:00 DEBUG 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:29:30.923-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:29:31.790-05:00  INFO 22260 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:29:31.798-05:00  INFO 22260 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:29:31.798-05:00  INFO 22260 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:29:31.842-05:00  INFO 22260 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:29:31.843-05:00  INFO 22260 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 881 ms
2025-11-24T21:29:31.894-05:00  INFO 22260 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:29:32.020-05:00  INFO 22260 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:29:32.025-05:00  INFO 22260 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:29:32.072-05:00  INFO 22260 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@6de6faa6
2025-11-24T21:29:32.073-05:00  INFO 22260 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:29:32.074-05:00  INFO 22260 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:29:32.098-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:29:32.118-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:29:32.135-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:29:32.161-05:00  INFO 22260 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:29:32.167-05:00  INFO 22260 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:29:32.180-05:00  INFO 22260 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:29:32.182-05:00  INFO 22260 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:29:32.201-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:29:32.238-05:00  INFO 22260 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:29:32.471-05:00  INFO 22260 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:29:32.471-05:00  INFO 22260 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:29:32.472-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:29:32.472-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:29:32.478-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:29:32.480-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:29:32.481-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:29:32.483-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:29:32.483-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:29:32.484-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:29:32.485-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:29:32.486-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:29:32.486-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:29:32.496-05:00  INFO 22260 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:29:32.497-05:00  INFO 22260 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:29:32.510-05:00  INFO 22260 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@203d1d93
2025-11-24T21:29:32.511-05:00  INFO 22260 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:29:32.559-05:00  INFO 22260 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:29:32.829-05:00  INFO 22260 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:29:32.836-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.33 seconds (process running for 2.601)
2025-11-24T21:29:32.838-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:29:32.839-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:29:32.839-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:29:32.839-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:29:32.839-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:29:32.839-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:29:32.854-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 1
2025-11-24T21:29:32.855-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 1
2025-11-24T21:29:32.856-05:00  INFO 22260 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:29:47.465-05:00  INFO 22260 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-24T21:29:47.466-05:00  INFO 22260 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-24T21:29:47.467-05:00  INFO 22260 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-11-24T21:30:26.616-05:00  INFO 22260 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:59243
2025-11-24T21:30:26.619-05:00  INFO 22260 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:59243
2025-11-24T21:30:27.738-05:00  INFO 22260 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:59243
2025-11-24T21:30:27.738-05:00  INFO 22260 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:59243
2025-11-24T21:30:27.738-05:00  INFO 22260 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:59243
2025-11-24T21:30:27.743-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:59243 conectado y saludado.
2025-11-24T21:30:27.743-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-24T21:30:27.760-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-24T21:30:27.761-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /172.29.96.1:59243
2025-11-24T21:30:27.762-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /172.29.96.1:59243
2025-11-24T21:30:27.762-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-24T21:30:27.762-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-24T21:30:27.763-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T21:30:27.767-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T21:30:27.830-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=3169f861-fd95-4cf8-90ae-9dc5603255e2
2025-11-24T21:30:27.830-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T21:30:27.831-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T21:30:37.470-05:00  INFO 22260 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:59244
2025-11-24T21:30:37.473-05:00  INFO 22260 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:59244
2025-11-24T21:30:38.291-05:00  INFO 22260 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:59244
2025-11-24T21:30:38.291-05:00  INFO 22260 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:59244
2025-11-24T21:30:38.291-05:00  INFO 22260 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:59244
2025-11-24T21:30:38.293-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:59244 conectado y saludado.
2025-11-24T21:30:38.293-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 2|postgres2|1234'
2025-11-24T21:30:38.294-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T21:30:38.301-05:00  WARN 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres2' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T21:30:38.374-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres2' (id=2) registrado en DB
2025-11-24T21:30:38.374-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres2' (id=2) desde /172.29.96.1:59244
2025-11-24T21:30:38.374-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres2 (id=2) desde /172.29.96.1:59244
2025-11-24T21:30:38.376-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 2
2025-11-24T21:30:38.376-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 2
2025-11-24T21:30:43.992-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|postgres2|1234'
2025-11-24T21:30:43.995-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres2' id=2
2025-11-24T21:30:43.995-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres2' id=2 desde /172.29.96.1:59244
2025-11-24T21:30:43.996-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres2 (id=2) desde /172.29.96.1:59244
2025-11-24T21:30:43.996-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres2 (user-conns=1)
2025-11-24T21:30:43.996-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: postgres1,postgres2
2025-11-24T21:30:43.996-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T21:30:43.999-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T21:30:44.090-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres2 id=c4a30538-dbfa-4b45-a614-edb7e4f0e039
2025-11-24T21:30:44.091-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T21:30:44.092-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T21:30:51.649-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres1|mensaje a pgs 1'
2025-11-24T21:30:51.649-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-24 21:30:51] Mensaje enviado por: postgres2 Para postgres1 Contenido: mensaje a pgs 1
2025-11-24T21:30:51.651-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 21:30:51 Mensaje enviado por: postgres2 Para postgres1 Contenido: mensaje a pgs 1 (desde /172.29.96.1:59244)
2025-11-24T21:30:51.651-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T21:30:51.679-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T21:30:51.681-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T21:30:51.695-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T21:30:51.696-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=c4a30538-dbfa-4b45-a614-edb7e4f0e039 contenido='mensaje a pgs 1'
2025-11-24T21:30:51.697-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=c4a30538-dbfa-4b45-a614-edb7e4f0e039
2025-11-24T21:30:58.351-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres2|respuesta a psg 2'
2025-11-24T21:30:58.351-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-24 21:30:58] Mensaje enviado por: postgres1 Para postgres2 Contenido: respuesta a psg 2
2025-11-24T21:30:58.353-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-24 21:30:58 Mensaje enviado por: postgres1 Para postgres2 Contenido: respuesta a psg 2 (desde /172.29.96.1:59243)
2025-11-24T21:30:58.353-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-24T21:30:58.360-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-24T21:30:58.360-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-24T21:30:58.362-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-24T21:30:58.362-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=2 sesionId=3169f861-fd95-4cf8-90ae-9dc5603255e2 contenido='respuesta a psg 2'
2025-11-24T21:30:58.363-05:00 DEBUG 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=TEXTO, sesionId=3169f861-fd95-4cf8-90ae-9dc5603255e2
2025-11-24T21:31:12.427-05:00 ERROR 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /172.29.96.1:59243: java.net.SocketException: Connection reset
2025-11-24T21:31:12.427-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres1' desconectado.
2025-11-24T21:31:12.428-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres1 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T21:31:12.428-05:00  INFO 22260 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres2
2025-11-24T21:31:12.506-05:00 ERROR 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /172.29.96.1:59244: java.net.SocketException: Connection reset
2025-11-24T21:31:12.506-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres2' desconectado.
2025-11-24T21:31:12.507-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario postgres2 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T21:31:12.507-05:00  INFO 22260 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-24T21:32:07.244-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 18868 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:32:07.246-05:00 DEBUG 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:32:07.246-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:32:08.222-05:00  INFO 18868 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:32:08.232-05:00  INFO 18868 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:32:08.233-05:00  INFO 18868 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:32:08.275-05:00  INFO 18868 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:32:08.277-05:00  INFO 18868 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 983 ms
2025-11-24T21:32:08.329-05:00  INFO 18868 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:32:08.471-05:00  INFO 18868 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:32:08.478-05:00  INFO 18868 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:32:08.515-05:00  INFO 18868 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@36327cec
2025-11-24T21:32:08.522-05:00  INFO 18868 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:32:08.522-05:00  INFO 18868 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:32:08.545-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:32:08.564-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:32:08.581-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:32:08.611-05:00  INFO 18868 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:32:08.617-05:00  INFO 18868 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:32:08.629-05:00  INFO 18868 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:32:08.631-05:00  INFO 18868 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:32:08.648-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:32:08.685-05:00  INFO 18868 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:32:08.931-05:00  INFO 18868 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:32:08.931-05:00  INFO 18868 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:32:08.931-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:32:08.932-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:32:08.937-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:32:08.940-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:32:08.941-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:32:08.942-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensaje a pgs 1; archivo_id=null; sesion_id=c4a30538-dbfa-4b45-a614-edb7e4f0e039; creado_en=2025-11-24 21:30:51.698682; 
2025-11-24T21:32:08.943-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuesta a psg 2; archivo_id=null; sesion_id=3169f861-fd95-4cf8-90ae-9dc5603255e2; creado_en=2025-11-24 21:30:58.363679; 
2025-11-24T21:32:08.943-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:32:08.945-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:32:08.945-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3169f861-fd95-4cf8-90ae-9dc5603255e2; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 21:30:27.770222; fecha_fin=2025-11-24 21:31:12.428769; estado=CERRADA; 
2025-11-24T21:32:08.945-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=c4a30538-dbfa-4b45-a614-edb7e4f0e039; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 21:30:44.001227; fecha_fin=2025-11-24 21:31:12.507416; estado=CERRADA; 
2025-11-24T21:32:08.945-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:32:08.947-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:32:08.947-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:32:08.947-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:32:08.957-05:00  INFO 18868 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:32:08.957-05:00  INFO 18868 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:32:08.970-05:00  INFO 18868 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@3451f01d
2025-11-24T21:32:08.970-05:00  INFO 18868 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:32:09.025-05:00  INFO 18868 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:32:09.292-05:00  INFO 18868 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:32:09.299-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.46 seconds (process running for 2.786)
2025-11-24T21:32:09.305-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:32:09.309-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:32:09.309-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:32:09.309-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:32:09.309-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:32:09.309-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:32:09.333-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-24T21:32:09.335-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-24T21:32:09.339-05:00  INFO 18868 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:32:30.303-05:00  INFO 18868 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-24T21:32:30.303-05:00  INFO 18868 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-24T21:32:30.304-05:00  INFO 18868 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-11-24T21:41:29.981-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 24.0.2 with PID 22096 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo)
2025-11-24T21:41:29.982-05:00 DEBUG 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:41:29.983-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:41:30.817-05:00  INFO 22096 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:41:30.825-05:00  INFO 22096 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:41:30.825-05:00  INFO 22096 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:41:30.871-05:00  INFO 22096 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:41:30.871-05:00  INFO 22096 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 846 ms
2025-11-24T21:41:30.920-05:00  INFO 22096 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:41:31.041-05:00  INFO 22096 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:41:31.047-05:00  INFO 22096 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:41:31.088-05:00  INFO 22096 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@31dfc6f5
2025-11-24T21:41:31.089-05:00  INFO 22096 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:41:31.090-05:00  INFO 22096 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:41:31.109-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:41:31.124-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:41:31.143-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:41:31.181-05:00  INFO 22096 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:41:31.187-05:00  INFO 22096 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:41:31.206-05:00  INFO 22096 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:41:31.207-05:00  INFO 22096 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:41:31.248-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:41:31.386-05:00  INFO 22096 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:41:31.909-05:00  INFO 22096 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:41:31.909-05:00  INFO 22096 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:41:31.909-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:41:31.909-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:41:31.917-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:41:31.920-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:41:31.921-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:41:31.924-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensaje a pgs 1; archivo_id=null; sesion_id=c4a30538-dbfa-4b45-a614-edb7e4f0e039; creado_en=2025-11-24 21:30:51.698682; 
2025-11-24T21:41:31.924-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuesta a psg 2; archivo_id=null; sesion_id=3169f861-fd95-4cf8-90ae-9dc5603255e2; creado_en=2025-11-24 21:30:58.363679; 
2025-11-24T21:41:31.925-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:41:31.926-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:41:31.927-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3169f861-fd95-4cf8-90ae-9dc5603255e2; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 21:30:27.770222; fecha_fin=2025-11-24 21:31:12.428769; estado=CERRADA; 
2025-11-24T21:41:31.927-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=c4a30538-dbfa-4b45-a614-edb7e4f0e039; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 21:30:44.001227; fecha_fin=2025-11-24 21:31:12.507416; estado=CERRADA; 
2025-11-24T21:41:31.927-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:41:31.930-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:41:31.930-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:41:31.930-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:41:31.939-05:00  INFO 22096 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:41:31.940-05:00  INFO 22096 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:41:31.962-05:00  INFO 22096 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@7b81616b
2025-11-24T21:41:31.963-05:00  INFO 22096 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:41:32.009-05:00  INFO 22096 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:41:32.291-05:00  INFO 22096 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:41:32.296-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.672 seconds (process running for 2.931)
2025-11-24T21:41:32.299-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:41:32.299-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:41:32.299-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:41:32.299-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:41:32.299-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:41:32.299-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:41:32.315-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-24T21:41:32.315-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-24T21:41:32.317-05:00  INFO 22096 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:42:35.320-05:00  INFO 22096 --- [servidor] [tcpserver-shutdown-hook] com.proyecto.demo.server.TcpServer       : Shutting down TcpServer...
2025-11-24T21:42:35.320-05:00  INFO 22096 --- [servidor] [tcpserver-shutdown-hook] com.proyecto.demo.server.TcpServer       : TcpServer shutdown complete
2025-11-24T21:42:35.331-05:00  INFO 22096 --- [servidor] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Shutdown initiated...
2025-11-24T21:42:35.333-05:00  INFO 22096 --- [servidor] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Shutdown completed.
2025-11-24T21:42:35.335-05:00  INFO 22096 --- [servidor] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : app-ds - Shutdown initiated...
2025-11-24T21:42:35.340-05:00  INFO 22096 --- [servidor] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : app-ds - Shutdown completed.
2025-11-24T21:43:36.234-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 24.0.2 with PID 25808 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo)
2025-11-24T21:43:36.235-05:00 DEBUG 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:43:36.236-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:43:36.976-05:00  INFO 25808 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:43:36.984-05:00  INFO 25808 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:43:36.984-05:00  INFO 25808 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:43:37.022-05:00  INFO 25808 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:43:37.022-05:00  INFO 25808 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 749 ms
2025-11-24T21:43:37.066-05:00  INFO 25808 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:43:37.192-05:00  INFO 25808 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:43:37.201-05:00  INFO 25808 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:43:37.250-05:00  INFO 25808 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@7c847072
2025-11-24T21:43:37.251-05:00  INFO 25808 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:43:37.252-05:00  INFO 25808 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:43:37.271-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:43:37.284-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:43:37.303-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:43:37.343-05:00  INFO 25808 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-24T21:43:37.348-05:00  INFO 25808 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:43:37.368-05:00  INFO 25808 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:43:37.369-05:00  INFO 25808 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:43:37.392-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:43:37.423-05:00  INFO 25808 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:43:37.672-05:00  INFO 25808 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:43:37.672-05:00  INFO 25808 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:43:37.672-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:43:37.673-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:43:37.679-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:43:37.681-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:43:37.681-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:43:37.683-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensaje a pgs 1; archivo_id=null; sesion_id=c4a30538-dbfa-4b45-a614-edb7e4f0e039; creado_en=2025-11-24 21:30:51.698682; 
2025-11-24T21:43:37.684-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuesta a psg 2; archivo_id=null; sesion_id=3169f861-fd95-4cf8-90ae-9dc5603255e2; creado_en=2025-11-24 21:30:58.363679; 
2025-11-24T21:43:37.684-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:43:37.685-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:43:37.686-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3169f861-fd95-4cf8-90ae-9dc5603255e2; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 21:30:27.770222; fecha_fin=2025-11-24 21:31:12.428769; estado=CERRADA; 
2025-11-24T21:43:37.686-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=c4a30538-dbfa-4b45-a614-edb7e4f0e039; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 21:30:44.001227; fecha_fin=2025-11-24 21:31:12.507416; estado=CERRADA; 
2025-11-24T21:43:37.686-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:43:37.687-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:43:37.688-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:43:37.688-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:43:37.695-05:00  INFO 25808 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:43:37.696-05:00  INFO 25808 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:43:37.716-05:00  INFO 25808 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@521bb1a4
2025-11-24T21:43:37.716-05:00  INFO 25808 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:43:37.755-05:00  INFO 25808 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:43:38.001-05:00  INFO 25808 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-24T21:43:38.005-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 2.131 seconds (process running for 2.38)
2025-11-24T21:43:38.007-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-24T21:43:38.008-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-24T21:43:38.008-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-24T21:43:38.009-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-24T21:43:38.009-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-24T21:43:38.009-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-24T21:43:38.021-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-24T21:43:38.021-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-24T21:43:38.022-05:00  INFO 25808 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-24T21:43:58.684-05:00  INFO 25808 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-24T21:43:58.684-05:00  INFO 25808 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-24T21:43:58.685-05:00  INFO 25808 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2025-11-24T21:46:59.842-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.9 with PID 19180 (C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\OneDrive\Escritorio\mensajeProyecto\mensajeriaRedLocal)
2025-11-24T21:46:59.844-05:00 DEBUG 19180 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-24T21:46:59.844-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-24T21:47:01.141-05:00  INFO 19180 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-24T21:47:01.149-05:00  INFO 19180 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-24T21:47:01.150-05:00  INFO 19180 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-24T21:47:01.196-05:00  INFO 19180 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-24T21:47:01.197-05:00  INFO 19180 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1307 ms
2025-11-24T21:47:01.254-05:00  INFO 19180 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:47:01.387-05:00  INFO 19180 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:47:01.394-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-24T21:47:01.429-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@36327cec
2025-11-24T21:47:01.430-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-24T21:47:01.431-05:00  INFO 19180 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-24T21:47:01.451-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : ensureTable skipped for 'usuarios' - DDL is managed outside the application
2025-11-24T21:47:01.470-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-24T21:47:01.486-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-24T21:47:01.512-05:00 ERROR 19180 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Error en servidor TCP al iniciar: java.net.BindException: Address already in use: bind

java.net.BindException: Address already in use: bind
	at java.base/sun.nio.ch.Net.bind0(Native Method) ~[na:na]
	at java.base/sun.nio.ch.Net.bind(Unknown Source) ~[na:na]
	at java.base/sun.nio.ch.Net.bind(Unknown Source) ~[na:na]
	at java.base/sun.nio.ch.NioSocketImpl.bind(Unknown Source) ~[na:na]
	at java.base/java.net.ServerSocket.bind(Unknown Source) ~[na:na]
	at java.base/java.net.ServerSocket.bind(Unknown Source) ~[na:na]
	at com.proyecto.demo.server.TcpServer.run(TcpServer.java:87) ~[classes/:na]
	at java.base/java.lang.Thread.run(Unknown Source) ~[na:na]

2025-11-24T21:47:01.515-05:00  INFO 19180 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Shutting down TcpServer...
2025-11-24T21:47:01.516-05:00  INFO 19180 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : TcpServer shutdown complete
2025-11-24T21:47:01.517-05:00  INFO 19180 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-24T21:47:01.531-05:00  INFO 19180 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-24T21:47:01.533-05:00  INFO 19180 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-24T21:47:01.551-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-24T21:47:01.591-05:00  INFO 19180 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-24T21:47:01.836-05:00  INFO 19180 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-24T21:47:01.836-05:00  INFO 19180 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-24T21:47:01.837-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-24T21:47:01.837-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-24T21:47:01.844-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-24T21:47:01.846-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-24T21:47:01.847-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-24T21:47:01.849-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensaje a pgs 1; archivo_id=null; sesion_id=c4a30538-dbfa-4b45-a614-edb7e4f0e039; creado_en=2025-11-24 21:30:51.698682; 
2025-11-24T21:47:01.849-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuesta a psg 2; archivo_id=null; sesion_id=3169f861-fd95-4cf8-90ae-9dc5603255e2; creado_en=2025-11-24 21:30:58.363679; 
2025-11-24T21:47:01.849-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-24T21:47:01.851-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=37f675ce-dc30-4bb6-98b0-24de85a380a6; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 20:41:40.3804; fecha_fin=2025-11-24 20:41:46.266725; estado=CERRADA; 
2025-11-24T21:47:01.851-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3169f861-fd95-4cf8-90ae-9dc5603255e2; usuario_id=1; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 21:30:27.770222; fecha_fin=2025-11-24 21:31:12.428769; estado=CERRADA; 
2025-11-24T21:47:01.851-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=c4a30538-dbfa-4b45-a614-edb7e4f0e039; usuario_id=2; token=null; ip=172.29.96.1; fecha_inicio=2025-11-24 21:30:44.001227; fecha_fin=2025-11-24 21:31:12.507416; estado=CERRADA; 
2025-11-24T21:47:01.851-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-24T21:47:01.853-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:47:01.854-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-24T21:47:01.854-05:00  INFO 19180 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-24T21:47:01.862-05:00  INFO 19180 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-24T21:47:01.863-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-24T21:47:01.876-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@3451f01d
2025-11-24T21:47:01.876-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-24T21:47:01.933-05:00  INFO 19180 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-24T21:47:02.214-05:00  WARN 19180 --- [servidor] [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-11-24T21:47:02.227-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Shutdown initiated...
2025-11-24T21:47:02.231-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Shutdown completed.
2025-11-24T21:47:02.232-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Shutdown initiated...
2025-11-24T21:47:02.236-05:00  INFO 19180 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Shutdown completed.
2025-11-24T21:47:02.250-05:00  INFO 19180 --- [servidor] [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-11-24T21:47:02.269-05:00 ERROR 19180 --- [servidor] [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 9010 was already in use.

Action:

Identify and stop the process that's listening on port 9010 or configure this application to listen on another port.

2025-11-24T21:48:33.051-05:00  INFO 25808 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /172.29.96.1:52518
2025-11-24T21:48:33.052-05:00  INFO 25808 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /172.29.96.1:52518
2025-11-24T21:48:33.835-05:00  INFO 25808 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /172.29.96.1:52518
2025-11-24T21:48:33.836-05:00  INFO 25808 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /172.29.96.1:52518
2025-11-24T21:48:33.836-05:00  INFO 25808 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /172.29.96.1:52518
2025-11-24T21:48:33.840-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /172.29.96.1:52518 conectado y saludado.
2025-11-24T21:48:33.841-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 3|postgres3|1234'
2025-11-24T21:48:33.849-05:00 DEBUG 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-24T21:48:33.853-05:00  WARN 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres3' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-24T21:48:33.873-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres3' (id=3) registrado en DB
2025-11-24T21:48:33.874-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres3' (id=3) desde /172.29.96.1:52518
2025-11-24T21:48:33.875-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres3 (id=3) desde /172.29.96.1:52518
2025-11-24T21:48:33.877-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 3
2025-11-24T21:48:33.878-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 3
2025-11-24T21:48:40.354-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 3|postgres3|1234'
2025-11-24T21:48:40.357-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres3' id=3
2025-11-24T21:48:40.357-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres3' id=3 desde /172.29.96.1:52518
2025-11-24T21:48:40.357-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres3 (id=3) desde /172.29.96.1:52518
2025-11-24T21:48:40.357-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres3 (user-conns=1)
2025-11-24T21:48:40.358-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres3
2025-11-24T21:48:40.358-05:00 DEBUG 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-24T21:48:40.360-05:00 DEBUG 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='postgres3'
2025-11-24T21:48:40.476-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres3 id=0c72d7b0-1a06-4124-b507-d029e924af5c
2025-11-24T21:48:40.477-05:00 DEBUG 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-24T21:48:40.478-05:00 DEBUG 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='postgres3'
2025-11-24T21:49:07.806-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'postgres3' desconectado.
2025-11-24T21:49:07.806-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario postgres3 desconectado desde 172.29.96.1 (user-conns=0)
2025-11-24T21:49:07.806-05:00  INFO 25808 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 0 clients: 
2025-11-25T09:12:01.735-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 8876 (C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal)
2025-11-25T09:12:01.739-05:00 DEBUG 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-25T09:12:01.741-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-25T09:12:03.826-05:00  INFO 8876 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-25T09:12:03.843-05:00  INFO 8876 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-25T09:12:03.843-05:00  INFO 8876 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-25T09:12:03.957-05:00  INFO 8876 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-25T09:12:03.957-05:00  INFO 8876 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2139 ms
2025-11-25T09:12:04.082-05:00  INFO 8876 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-25T09:12:04.471-05:00  INFO 8876 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-25T09:12:04.484-05:00  INFO 8876 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-25T09:12:04.563-05:00  INFO 8876 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@869d87c
2025-11-25T09:12:04.568-05:00  INFO 8876 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-25T09:12:04.568-05:00  INFO 8876 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-25T09:12:04.623-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : evitar DDL
2025-11-25T09:12:04.674-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-25T09:12:04.780-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-25T09:12:04.815-05:00  INFO 8876 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-25T09:12:04.827-05:00  INFO 8876 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-25T09:12:04.858-05:00  INFO 8876 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-25T09:12:04.862-05:00  INFO 8876 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-25T09:12:04.914-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-25T09:12:05.038-05:00  INFO 8876 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-25T09:12:05.660-05:00  INFO 8876 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-25T09:12:05.663-05:00  INFO 8876 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-25T09:12:05.664-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-25T09:12:05.666-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-25T09:12:05.699-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-25T09:12:05.718-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-25T09:12:05.723-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-25T09:12:05.740-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-25T09:12:05.743-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-25T09:12:05.766-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=05bba297-23b3-4a75-aed7-9b3413e93504; usuario_id=1; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 17:05:42.382366; fecha_fin=2025-11-24 17:06:27.945269; estado=CERRADA; 
2025-11-25T09:12:05.768-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1532e17f-a649-440d-af79-ef42704d5bc1; usuario_id=1; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 17:06:31.007088; fecha_fin=2025-11-24 17:06:40.370939; estado=CERRADA; 
2025-11-25T09:12:05.775-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=d9830042-d3b5-4251-8dff-1b72d35228a9; usuario_id=2; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 17:06:07.717398; fecha_fin=2025-11-24 17:06:44.206152; estado=CERRADA; 
2025-11-25T09:12:05.778-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-25T09:12:05.797-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:12:05.798-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:12:05.799-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-25T09:12:05.843-05:00  INFO 8876 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-25T09:12:05.847-05:00  INFO 8876 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-25T09:12:05.939-05:00  INFO 8876 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@7d979d34
2025-11-25T09:12:05.942-05:00  INFO 8876 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-25T09:12:06.073-05:00  INFO 8876 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-25T09:12:06.753-05:00  INFO 8876 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-25T09:12:06.764-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.841 seconds (process running for 6.348)
2025-11-25T09:12:06.770-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-25T09:12:06.770-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-25T09:12:06.772-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-25T09:12:06.772-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-25T09:12:06.774-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-25T09:12:06.774-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-25T09:12:06.830-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-25T09:12:06.832-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-25T09:12:06.895-05:00  INFO 8876 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-25T09:12:45.865-05:00  INFO 8876 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:62170
2025-11-25T09:12:45.879-05:00  INFO 8876 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:62170
2025-11-25T09:12:48.016-05:00  INFO 8876 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:62170
2025-11-25T09:12:48.023-05:00  INFO 8876 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:62170
2025-11-25T09:12:48.046-05:00  INFO 8876 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:62170
2025-11-25T09:12:48.075-05:00  INFO 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:62170 conectado y saludado.
2025-11-25T09:12:48.081-05:00  INFO 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-25T09:12:48.162-05:00  INFO 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-25T09:12:48.166-05:00  INFO 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /10.236.197.200:62170
2025-11-25T09:12:48.172-05:00  INFO 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /10.236.197.200:62170
2025-11-25T09:12:48.186-05:00  INFO 8876 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-25T09:12:48.191-05:00  INFO 8876 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres1
2025-11-25T09:12:48.196-05:00 DEBUG 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-25T09:12:48.219-05:00 DEBUG 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-25T09:12:48.271-05:00  INFO 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=c96b254e-31c0-486d-87d4-557126cf7d27
2025-11-25T09:12:48.275-05:00 DEBUG 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-25T09:12:48.300-05:00 DEBUG 8876 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-25T09:13:54.657-05:00  INFO 8876 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-25T09:13:54.657-05:00  INFO 8876 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-25T09:13:54.663-05:00  INFO 8876 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2025-11-25T09:28:46.784-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 22980 (C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal)
2025-11-25T09:28:46.786-05:00 DEBUG 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-25T09:28:46.788-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-25T09:28:49.370-05:00  INFO 22980 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-25T09:28:49.405-05:00  INFO 22980 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-25T09:28:49.405-05:00  INFO 22980 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-25T09:28:49.546-05:00  INFO 22980 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-25T09:28:49.547-05:00  INFO 22980 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2681 ms
2025-11-25T09:28:49.639-05:00  INFO 22980 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-25T09:28:49.879-05:00  INFO 22980 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:postgresql://localhost:5433/mensajeria
2025-11-25T09:28:49.895-05:00  INFO 22980 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-25T09:28:49.987-05:00  INFO 22980 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection org.postgresql.jdbc.PgConnection@1921994e
2025-11-25T09:28:49.991-05:00  INFO 22980 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-25T09:28:49.992-05:00  INFO 22980 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:postgresql://localhost:5433/mensajeria
2025-11-25T09:28:50.048-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : evitar DDL
2025-11-25T09:28:50.103-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-25T09:28:50.148-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-25T09:28:50.215-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-25T09:28:50.238-05:00  INFO 22980 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='postgres' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-25T09:28:50.296-05:00  INFO 22980 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to Postgres via jdbc:postgresql://localhost:5433/mensajeria (user=postgres)
2025-11-25T09:28:50.303-05:00  INFO 22980 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: Postgres
2025-11-25T09:28:50.365-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-25T09:28:50.466-05:00  INFO 22980 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-25T09:28:50.880-05:00  INFO 22980 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-25T09:28:50.880-05:00  INFO 22980 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-25T09:28:50.882-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: Postgres
2025-11-25T09:28:50.882-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: PostgreSQL | URL=jdbc:postgresql://localhost:5433/mensajeria | user=postgres
2025-11-25T09:28:50.892-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-25T09:28:50.900-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-25T09:28:50.900-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-25T09:28:50.905-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-25T09:28:50.906-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-25T09:28:50.915-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=05bba297-23b3-4a75-aed7-9b3413e93504; usuario_id=1; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 17:05:42.382366; fecha_fin=2025-11-24 17:06:27.945269; estado=CERRADA; 
2025-11-25T09:28:50.916-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1532e17f-a649-440d-af79-ef42704d5bc1; usuario_id=1; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 17:06:31.007088; fecha_fin=2025-11-24 17:06:40.370939; estado=CERRADA; 
2025-11-25T09:28:50.917-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=d9830042-d3b5-4251-8dff-1b72d35228a9; usuario_id=2; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 17:06:07.717398; fecha_fin=2025-11-24 17:06:44.206152; estado=CERRADA; 
2025-11-25T09:28:50.919-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=c96b254e-31c0-486d-87d4-557126cf7d27; usuario_id=1; token=null; ip=10.236.197.200; fecha_inicio=2025-11-25 09:12:48.248811; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:28:50.920-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-25T09:28:50.925-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=postgres1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:28:50.926-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=postgres2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:28:50.927-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-25T09:28:50.948-05:00  INFO 22980 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:postgresql://localhost:5433/mensajeria' user='postgres' (app.db.type=postgres)
2025-11-25T09:28:50.949-05:00  INFO 22980 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-25T09:28:50.980-05:00  INFO 22980 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection org.postgresql.jdbc.PgConnection@6a9cd0f8
2025-11-25T09:28:50.981-05:00  INFO 22980 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-25T09:28:51.123-05:00  INFO 22980 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-25T09:28:51.668-05:00  INFO 22980 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-25T09:28:51.679-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.579 seconds (process running for 6.23)
2025-11-25T09:28:51.683-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-25T09:28:51.684-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-25T09:28:51.685-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-25T09:28:51.685-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-25T09:28:51.686-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-25T09:28:51.686-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-25T09:28:51.718-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-25T09:28:51.719-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-25T09:28:51.722-05:00  INFO 22980 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-25T09:30:15.078-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:60266
2025-11-25T09:30:15.088-05:00  INFO 22980 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:60266
2025-11-25T09:30:21.461-05:00  INFO 22980 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:60266
2025-11-25T09:30:21.461-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:60266
2025-11-25T09:30:21.461-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:60266
2025-11-25T09:30:21.479-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:60266 conectado y saludado.
2025-11-25T09:30:21.480-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 3|postgres3|1234'
2025-11-25T09:30:21.495-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-25T09:30:21.505-05:00  WARN 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='postgres3' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-25T09:30:21.519-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'postgres3' (id=3) registrado en DB
2025-11-25T09:30:21.520-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'postgres3' (id=3) desde /10.236.197.200:60266
2025-11-25T09:30:21.521-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: postgres3 (id=3) desde /10.236.197.200:60266
2025-11-25T09:30:21.525-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 3
2025-11-25T09:30:21.525-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 3
2025-11-25T09:30:35.970-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 3|postgres3|1234'
2025-11-25T09:30:35.978-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres3' id=3
2025-11-25T09:30:35.979-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres3' id=3 desde /10.236.197.200:60266
2025-11-25T09:30:35.980-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres3 (id=3) desde /10.236.197.200:60266
2025-11-25T09:30:35.981-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres3 (user-conns=1)
2025-11-25T09:30:35.982-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: postgres3
2025-11-25T09:30:35.983-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-25T09:30:35.989-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='postgres3'
2025-11-25T09:30:36.004-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres3 id=f04966b8-7d7d-4121-b5a4-86b6c86a1480
2025-11-25T09:30:36.005-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-25T09:30:36.010-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='postgres3'
2025-11-25T09:30:47.455-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:49734
2025-11-25T09:30:47.460-05:00  INFO 22980 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:49734
2025-11-25T09:30:50.665-05:00  INFO 22980 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:49734
2025-11-25T09:30:50.665-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:49734
2025-11-25T09:30:50.666-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:49734
2025-11-25T09:30:50.668-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:49734 conectado y saludado.
2025-11-25T09:30:50.670-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|postgres1|1234'
2025-11-25T09:30:50.677-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres1' id=1
2025-11-25T09:30:50.679-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres1' id=1 desde /10.236.197.200:49734
2025-11-25T09:30:50.680-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres1 (id=1) desde /10.236.197.200:49734
2025-11-25T09:30:50.681-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres1 (user-conns=1)
2025-11-25T09:30:50.682-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: postgres1,postgres3
2025-11-25T09:30:50.683-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-25T09:30:50.693-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-25T09:30:50.704-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres1 id=070675b4-6818-4243-99f0-0669c4400d54
2025-11-25T09:30:50.708-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-25T09:30:50.717-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-25T09:31:06.509-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:56403
2025-11-25T09:31:06.516-05:00  INFO 22980 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:56403
2025-11-25T09:31:09.836-05:00  INFO 22980 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:56403
2025-11-25T09:31:09.838-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:56403
2025-11-25T09:31:09.838-05:00  INFO 22980 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:56403
2025-11-25T09:31:09.841-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:56403 conectado y saludado.
2025-11-25T09:31:09.842-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 2|postgres2|1234'
2025-11-25T09:31:09.856-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='postgres2' id=2
2025-11-25T09:31:09.857-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='postgres2' id=2 desde /10.236.197.200:56403
2025-11-25T09:31:09.857-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: postgres2 (id=2) desde /10.236.197.200:56403
2025-11-25T09:31:09.858-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: postgres2 (user-conns=1)
2025-11-25T09:31:09.860-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 3 clients: postgres1,postgres2,postgres3
2025-11-25T09:31:09.861-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-25T09:31:09.872-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-25T09:31:09.897-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario postgres2 id=3cf72ee3-835e-4896-87ad-b979ec440d8f
2025-11-25T09:31:09.898-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-25T09:31:09.903-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-25T09:31:43.598-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres1|msj para pg2'
2025-11-25T09:31:43.603-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-25 09:31:43] Mensaje enviado por: postgres3 Para postgres1 Contenido: msj para pg2
2025-11-25T09:31:43.606-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-25 09:31:43 Mensaje enviado por: postgres3 Para postgres1 Contenido: msj para pg2 (desde /10.236.197.200:60266)
2025-11-25T09:31:43.611-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-25T09:31:43.626-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='postgres3'
2025-11-25T09:31:43.629-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-25T09:31:43.644-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-25T09:31:43.646-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=3 receptorId=1 sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480 contenido='msj para pg2'
2025-11-25T09:31:43.648-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=3, receptorId=1, tipo=TEXTO, sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480
2025-11-25T09:31:43.691-05:00 ERROR 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Error inserting message into DB (emisorId=3, receptorId=1, sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480)

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:112) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:116) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcMessageDao.insertMessage(JdbcMessageDao.java:108) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleMessage(ClientWorker.java:811) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:102) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.postgresql.util.PSQLException: ERROR: column "tipo" is of type mensaje_tipo but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 96
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-25T09:31:58.937-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres1|respuesta para pg1'
2025-11-25T09:31:58.940-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : [2025-11-25 09:31:58] Mensaje enviado por: postgres2 Para postgres1 Contenido: respuesta para pg1
2025-11-25T09:31:58.947-05:00  INFO 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-25 09:31:58 Mensaje enviado por: postgres2 Para postgres1 Contenido: respuesta para pg1 (desde /10.236.197.200:56403)
2025-11-25T09:31:58.948-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-25T09:31:58.970-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-25T09:31:58.983-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-25T09:31:58.995-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-25T09:31:59.008-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=2 receptorId=1 sesionId=3cf72ee3-835e-4896-87ad-b979ec440d8f contenido='respuesta para pg1'
2025-11-25T09:31:59.008-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=2, receptorId=1, tipo=TEXTO, sesionId=3cf72ee3-835e-4896-87ad-b979ec440d8f
2025-11-25T09:31:59.021-05:00 ERROR 22980 --- [servidor] [pool-2-thread-3] com.proyecto.demo.dao.JdbcMessageDao     : Error inserting message into DB (emisorId=2, receptorId=1, sesionId=3cf72ee3-835e-4896-87ad-b979ec440d8f)

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:112) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:116) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcMessageDao.insertMessage(JdbcMessageDao.java:108) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleMessage(ClientWorker.java:811) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:102) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.postgresql.util.PSQLException: ERROR: column "tipo" is of type mensaje_tipo but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 96
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-25T09:32:14.989-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres2|msj para pg2'
2025-11-25T09:32:14.992-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-25 09:32:14] Mensaje enviado por: postgres3 Para postgres2 Contenido: msj para pg2
2025-11-25T09:32:14.992-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-25 09:32:14 Mensaje enviado por: postgres3 Para postgres2 Contenido: msj para pg2 (desde /10.236.197.200:60266)
2025-11-25T09:32:14.994-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-25T09:32:15.015-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='postgres3'
2025-11-25T09:32:15.015-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-25T09:32:15.018-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-25T09:32:15.019-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=3 receptorId=2 sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480 contenido='msj para pg2'
2025-11-25T09:32:15.020-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=3, receptorId=2, tipo=TEXTO, sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480
2025-11-25T09:32:15.023-05:00 ERROR 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Error inserting message into DB (emisorId=3, receptorId=2, sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480)

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:112) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:116) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcMessageDao.insertMessage(JdbcMessageDao.java:108) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleMessage(ClientWorker.java:811) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:102) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.postgresql.util.PSQLException: ERROR: column "tipo" is of type mensaje_tipo but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 96
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-25T09:32:47.526-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR postgres2|Tipos de mensaje avanzadas.txt|2259'
2025-11-25T09:32:47.526-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='postgres2' filename='Tipos de mensaje avanzadas.txt' size='2259'
2025-11-25T09:32:47.531-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: Tipos de mensaje avanzadas.txt size=2259 desde /10.236.197.200:49734
2025-11-25T09:32:47.563-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA postgres2|Tipos de mensaje avanzadas.txt|Ly8vLy8vLy8NCkFwbGljYWNpw7NuIGNsaWVudGUgc2Vydmlkb3IgcGFyYSBlbCBpbnRlcmNhbWJpbyBkZSBpbmZvcm1hY2nDs24gZW50cmUgdXN1YXJpb3MuIHB1ZWRlbiBpbnRlcmNhbWJpYXIgaW5mb3JtYWNpw7NuIGJhc2FkYSBlbiBtZW5zYWplcyBkZSB0ZXh0byB5IGFyY2hpdm9zICggdGV4dG8gbyBiaW5hcmlvICkNCkVsIHNlcnZpZG9yIHBvZHLDoSByZWNpYmlyIHZhcmlhcyBjb25leGlvbmVzIHNpbXVsdGFuZWFzIHBhcmEgZWwgcHJvY2VzYW1pZW50byBkZSBtZW5zYWplcywgZGViZXLDoW4gYXBsaWNhciBlbCBjb25jZXB0byBkZSBwcm9ncmFtYWNpw7NuIGNvbmN1cnJlbnRlIGNvbiBoaWxvcyBwYXJhIGdlc3Rpb25hciBsYXMgY29uZXhpb25lcw0KVG9kYSBsYSBpbmZvcm1hY2nDs24gZGVsIHNlcnZpZG9yIGRlYmUgc2VyIGFsbWFjZW5hZGEgZW4gbGEgYmFzZSBkZSBkYXRvcyByZWxhY2lvbmFsOyBlajogc3FsLCBPcmFjbGUNCkxvcyB1c3VhcmlvcyBzZSBkZWJlbiBjcmVhciBkZXNkZSBsYSBhcHAgZGUgY2xpZW50ZSwgcGVybyBzZSBhY2VwdGFuIGRlc2RlIGVsIHNlcnZpZG9yLCBzb2xvIHB1ZWRlbiBjb25lY3RhcnNlIGx1ZWdvIGRlIHNlciBhY2VwdGFkb3MNClVuIHVzdWFyaW8gcHVlZGUgdGVuZXIgbWFzIGRlIDEgY29uZXhpw7NuIGRlc2RlIG1hcyBkZSAxIGRpc3Bvc2l0aXZvDQpFbCBzZXJ2aWRvciBkZWJlIG1vc3RyYXIgcG9yIGNvbnNvbGEgdG9kYXMgbGFzIGFjY2lvbmVzIHF1ZSBzZSBlc3TDoW4gZWplY3V0YW5kbw0KRWwgc2Vydmlkb3IgbGltaXRhIGxhIGNhbnRpZGFkIGRlIGNvbmV4aW9uZXMgcG9yIHVzdWFyaW8NCkxhIGNvbmV4acOzbiBlbnRyZSBzZXJ2aWRvciBjbGllbnRlcyBzZSBoYWNlIGEgdHJhdsOpcyBkZSBwcm90b2NvbG8gdGNwIGlwDQpMb3MgdXN1YXJpb3MgcHVlZGVuIGRlc2NhcmdhciBsb3MgYXJjaGl2b3MgZW52aWFkb3MNCkxhIGFwbGljYWNpw7NuIGNsaWVudGUgaW1wbGVtZW50YXJhIGZvcm11bGFyaW9zIG1hZXN0cm8tZGV0YWxsZSBwYXJhIG1vc3RyYXIgbGEgaW5mb3JtYWNpw7NuIGFzb2NpYWRhIGFsIHVzdWFyaW8NCg0KVW5hIGFwbGljYWNpw7NuIHdlYiBtdmMgbXXDqXN0cmFsbyBzaWd1aWVudGUNCkxpc3RhZG8gZGUgdXN1YXJpb3MgcmVnaXN0cmFkb3MNCk1lbnNhamVzIGRlIGxvcyB1c3VhcmlvcywgY2xhc2lmaWNhZG9zIHBvciBlbCB0aXBvIGRlIG1lbnNhamUuIFZlciBkZXRhbGxlIGRlIG1lbnNhamUsIGluY2x1eWUgZGVzY2FyZ2FyIGFyY2hpdm9zLg0KTW9zdHJhciBsb3Mgc2lndWllbnRlcyBpbmZvcm1lcw0KVXN1YXJpbyBjb24gbWFzIG1lbnNhamVzIGVudmlhZG9zOiBtb3N0cmFyIGNhbnRpZGFkDQpBcmNoaXZvcyBlbnZpYWRvcywgbGlzdGFyIHBvciB0YW1hw7FvIHkgbW9zdHJhciBwcm9waWV0YXJpbw0KTGlzdGEgZGUgdXN1YXJpb3MgY29uZWN0YWRvcyB5IGluZm9ybWFjacOzbjogSXAsIGhvcmEgZGUgY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQpMaXN0YSBkZSB1c3VhcmlvcyBkZXNjb25lY3RhZG9zIHkgaW5mb3JtYWNpw7NuOiBJcCwgaG9yYSBkZSBjb25leGnDs24sIGhvcmEgZGUgZGVzY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQoNCg0KaHR0cDovL2xvY2FsaG9zdDo5MzAwL3dlYi91c3Vhcmlvcw0KaHR0cDovL2xvY2FsaG9zdDo5MzAwL3dlYi8NCg0KDQpVbiBzZXJ2aWNpbyB3ZWIgZGUgYXBpIHJlc3QgcGFyYSBtb3N0cmFyIGxvIHNpZ3VpZW50ZToNCkluZm9ybWFjacOzbiBjb21wbGV0YSBkZSB1c3VhcmlvOiBOb21icmUsIGNhbnRpZGFkIGRlIG1lbnNhamVzIGVudmlhZG9zLCBjYW50aWRhZCBkZSBtZW5zYWplcyByZWNpYmlkb3MsIGZlY2hhIHkgaG9yYSBkZSB1bHRpbWEgY29uZXhpw7NuLCBlc3RhZG8gKGRlc2NvbmVjdGFkby9jb25lY3RhZG8pDQpMaXN0YSBkZSBtZW5zYWplcyBlbnZpYWRvcyAoSXAgdXN1YXJpbyxpcCB1c3VhcmlvIHJlbW90byxmZWNoYSxob3JhKQ0KTGlzdGEgZGUgbWVuc2FqZXMgcmVjaWJpZG9zIChJcCB1c3VhcmlvLGlwIHVzdWFyaW8gcmVtb3RvLGZlY2hhLGhvcmEpDQoNCmh0dHA6Ly9sb2NhbGhvc3Q6OTIwMC9hcGkvdXN1YXJpb3MvMQ0KaHR0cDovL2xvY2FsaG9zdDo5MjAwL2FwaS91c3Vhcmlvcy8xL21lbnNhamVzL3JlY2liaWRvcw0KaHR0cDovL2xvY2FsaG9zdDo5MjAwL2FwaS91c3Vhcmlvcy8xL21lbnNhamVzL2VudmlhZG9z'
2025-11-25T09:32:47.576-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: postgres1 -> postgres2 : Tipos de mensaje avanzadas.txt (2259 bytes)
2025-11-25T09:32:47.587-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1764081167577_postgres1_Tipos de mensaje avanzadas.txt
2025-11-25T09:32:47.589-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-25T09:32:47.598-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-25T09:32:47.616-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'Tipos de mensaje avanzadas.txt' using columns nombre / ruta, id=1
2025-11-25T09:32:47.617-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-25T09:32:47.621-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-25T09:32:47.621-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=1 receptorId=2 archivoId=1
2025-11-25T09:32:47.622-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=2, tipo=ARCHIVO, sesionId=null
2025-11-25T09:32:47.626-05:00 ERROR 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Error inserting message into DB (emisorId=1, receptorId=2, sesionId=null)

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:112) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:116) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcMessageDao.insertMessage(JdbcMessageDao.java:108) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleFileData(ClientWorker.java:482) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:117) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.postgresql.util.PSQLException: ERROR: column "tipo" is of type mensaje_tipo but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 96
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-25T09:32:47.628-05:00  WARN 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : insertMessage devolvió id no válido (-1) para mensaje archivo (archivoId=1)
2025-11-25T09:33:03.994-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR postgres3|mensaje_archivo_recibido_laura.txt|2038'
2025-11-25T09:33:03.995-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='postgres3' filename='mensaje_archivo_recibido_laura.txt' size='2038'
2025-11-25T09:33:03.996-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: mensaje_archivo_recibido_laura.txt size=2038 desde /10.236.197.200:49734
2025-11-25T09:33:04.029-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA postgres3|mensaje_archivo_recibido_laura.txt|Ly8vLy8vLy8NCkFwbGljYWNpw7NuIGNsaWVudGUgc2Vydmlkb3IgcGFyYSBlbCBpbnRlcmNhbWJpbyBkZSBpbmZvcm1hY2nDs24gZW50cmUgdXN1YXJpb3MuIHB1ZWRlbiBpbnRlcmNhbWJpYXIgaW5mb3JtYWNpw7NuIGJhc2FkYSBlbiBtZW5zYWplcyBkZSB0ZXh0byB5IGFyY2hpdm9zICggdGV4dG8gbyBiaW5hcmlvICkNCkVsIHNlcnZpZG9yIHBvZHLDoSByZWNpYmlyIHZhcmlhcyBjb25leGlvbmVzIHNpbXVsdGFuZWFzIHBhcmEgZWwgcHJvY2VzYW1pZW50byBkZSBtZW5zYWplcywgZGViZXLDoW4gYXBsaWNhciBlbCBjb25jZXB0byBkZSBwcm9ncmFtYWNpw7NuIGNvbmN1cnJlbnRlIGNvbiBoaWxvcyBwYXJhIGdlc3Rpb25hciBsYXMgY29uZXhpb25lcw0KVG9kYSBsYSBpbmZvcm1hY2nDs24gZGVsIHNlcnZpZG9yIGRlYmUgc2VyIGFsbWFjZW5hZGEgZW4gbGEgYmFzZSBkZSBkYXRvcyByZWxhY2lvbmFsOyBlajogc3FsLCBPcmFjbGUNCkxvcyB1c3VhcmlvcyBzZSBkZWJlbiBjcmVhciBkZXNkZSBsYSBhcHAgZGUgY2xpZW50ZSwgcGVybyBzZSBhY2VwdGFuIGRlc2RlIGVsIHNlcnZpZG9yLCBzb2xvIHB1ZWRlbiBjb25lY3RhcnNlIGx1ZWdvIGRlIHNlciBhY2VwdGFkb3MNClVuIHVzdWFyaW8gcHVlZGUgdGVuZXIgbWFzIGRlIDEgY29uZXhpw7NuIGRlc2RlIG1hcyBkZSAxIGRpc3Bvc2l0aXZvDQpFbCBzZXJ2aWRvciBkZWJlIG1vc3RyYXIgcG9yIGNvbnNvbGEgdG9kYXMgbGFzIGFjY2lvbmVzIHF1ZSBzZSBlc3TDoW4gZWplY3V0YW5kbw0KRWwgc2Vydmlkb3IgbGltaXRhIGxhIGNhbnRpZGFkIGRlIGNvbmV4aW9uZXMgcG9yIHVzdWFyaW8NCkxhIGNvbmV4acOzbiBlbnRyZSBzZXJ2aWRvciBjbGllbnRlcyBzZSBoYWNlIGEgdHJhdsOpcyBkZSBwcm90b2NvbG8gdGNwIGlwDQpMb3MgdXN1YXJpb3MgcHVlZGVuIGRlc2NhcmdhciBsb3MgYXJjaGl2b3MgZW52aWFkb3MNCkxhIGFwbGljYWNpw7NuIGNsaWVudGUgaW1wbGVtZW50YXJhIGZvcm11bGFyaW9zIG1hZXN0cm8tZGV0YWxsZSBwYXJhIG1vc3RyYXIgbGEgaW5mb3JtYWNpw7NuIGFzb2NpYWRhIGFsIHVzdWFyaW8NCg0KVW5hIGFwbGljYWNpw7NuIHdlYiBtdmMgbXXDqXN0cmFsbyBzaWd1aWVudGUNCkxpc3RhZG8gZGUgdXN1YXJpb3MgcmVnaXN0cmFkb3MNCk1lbnNhamVzIGRlIGxvcyB1c3VhcmlvcywgY2xhc2lmaWNhZG9zIHBvciBlbCB0aXBvIGRlIG1lbnNhamUuIFZlciBkZXRhbGxlIGRlIG1lbnNhamUsIGluY2x1eWUgZGVzY2FyZ2FyIGFyY2hpdm9zLg0KTW9zdHJhciBsb3Mgc2lndWllbnRlcyBpbmZvcm1lcw0KVXN1YXJpbyBjb24gbWFzIG1lbnNhamVzIGVudmlhZG9zOiBtb3N0cmFyIGNhbnRpZGFkDQpBcmNoaXZvcyBlbnZpYWRvcywgbGlzdGFyIHBvciB0YW1hw7FvIHkgbW9zdHJhciBwcm9waWV0YXJpbw0KTGlzdGEgZGUgdXN1YXJpb3MgY29uZWN0YWRvcyB5IGluZm9ybWFjacOzbjogSXAsIGhvcmEgZGUgY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQpMaXN0YSBkZSB1c3VhcmlvcyBkZXNjb25lY3RhZG9zIHkgaW5mb3JtYWNpw7NuOiBJcCwgaG9yYSBkZSBjb25leGnDs24sIGhvcmEgZGUgZGVzY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQoNCg0KVW4gc2VydmljaW8gd2ViIGRlIGFwaSByZXN0IHBhcmEgbW9zdHJhciBsbyBzaWd1aWVudGU6DQpJbmZvcm1hY2nDs24gY29tcGxldGEgZGUgdXN1YXJpbzogTm9tYnJlLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcywgY2FudGlkYWQgZGUgbWVuc2FqZXMgcmVjaWJpZG9zLCBmZWNoYSB5IGhvcmEgZGUgdWx0aW1hIGNvbmV4acOzbiwgZXN0YWRvIChkZXNjb25lY3RhZG8vY29uZWN0YWRvKQ0KTGlzdGEgZGUgbWVuc2FqZXMgZW52aWFkb3MgKElwIHVzdWFyaW8saXAgdXN1YXJpbyByZW1vdG8sZmVjaGEsaG9yYSkNCkxpc3RhIGRlIG1lbnNhamVzIHJlY2liaWRvcyAoSXAgdXN1YXJpbyxpcCB1c3VhcmlvIHJlbW90byxmZWNoYSxob3JhKQ=='
2025-11-25T09:33:04.032-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: postgres1 -> postgres3 : mensaje_archivo_recibido_laura.txt (2038 bytes)
2025-11-25T09:33:04.033-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1764081184032_postgres1_mensaje_archivo_recibido_laura.txt
2025-11-25T09:33:04.034-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-25T09:33:04.043-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-25T09:33:04.051-05:00  INFO 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'mensaje_archivo_recibido_laura.txt' using columns nombre / ruta, id=2
2025-11-25T09:33:04.052-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-25T09:33:04.056-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='postgres3'
2025-11-25T09:33:04.056-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=1 receptorId=3 archivoId=2
2025-11-25T09:33:04.057-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=3, tipo=ARCHIVO, sesionId=null
2025-11-25T09:33:04.060-05:00 ERROR 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Error inserting message into DB (emisorId=1, receptorId=3, sesionId=null)

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:112) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:116) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcMessageDao.insertMessage(JdbcMessageDao.java:108) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleFileData(ClientWorker.java:482) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:117) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.postgresql.util.PSQLException: ERROR: column "tipo" is of type mensaje_tipo but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 96
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-25T09:33:04.061-05:00  WARN 22980 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : insertMessage devolvió id no válido (-1) para mensaje archivo (archivoId=2)
2025-11-25T09:34:23.541-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres2|mensaje para pg2'
2025-11-25T09:34:23.541-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-25 09:34:23] Mensaje enviado por: postgres3 Para postgres2 Contenido: mensaje para pg2
2025-11-25T09:34:23.546-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-25 09:34:23 Mensaje enviado por: postgres3 Para postgres2 Contenido: mensaje para pg2 (desde /10.236.197.200:60266)
2025-11-25T09:34:23.546-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-25T09:34:23.556-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='postgres3'
2025-11-25T09:34:23.556-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres2' usando columna='nombre_usuario'
2025-11-25T09:34:23.560-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=2 usuario='postgres2'
2025-11-25T09:34:23.561-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=3 receptorId=2 sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480 contenido='mensaje para pg2'
2025-11-25T09:34:23.563-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=3, receptorId=2, tipo=TEXTO, sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480
2025-11-25T09:34:23.567-05:00 ERROR 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Error inserting message into DB (emisorId=3, receptorId=2, sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480)

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:112) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:116) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcMessageDao.insertMessage(JdbcMessageDao.java:108) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleMessage(ClientWorker.java:811) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:102) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.postgresql.util.PSQLException: ERROR: column "tipo" is of type mensaje_tipo but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 96
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-25T09:34:30.280-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG postgres1|mas mensajes para pg1'
2025-11-25T09:34:30.280-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-25 09:34:30] Mensaje enviado por: postgres3 Para postgres1 Contenido: mas mensajes para pg1
2025-11-25T09:34:30.280-05:00  INFO 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-25 09:34:30 Mensaje enviado por: postgres3 Para postgres1 Contenido: mas mensajes para pg1 (desde /10.236.197.200:60266)
2025-11-25T09:34:30.284-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres3' usando columna='nombre_usuario'
2025-11-25T09:34:30.296-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='postgres3'
2025-11-25T09:34:30.297-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='postgres1' usando columna='nombre_usuario'
2025-11-25T09:34:30.301-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='postgres1'
2025-11-25T09:34:30.301-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=3 receptorId=1 sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480 contenido='mas mensajes para pg1'
2025-11-25T09:34:30.301-05:00 DEBUG 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=3, receptorId=1, tipo=TEXTO, sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480
2025-11-25T09:34:30.306-05:00 ERROR 22980 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Error inserting message into DB (emisorId=3, receptorId=1, sesionId=f04966b8-7d7d-4121-b5a4-86b6c86a1480)

org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar []
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:112) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:107) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:116) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1548) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:677) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.update(JdbcTemplate.java:1001) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at com.proyecto.demo.dao.JdbcMessageDao.insertMessage(JdbcMessageDao.java:108) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.handleMessage(ClientWorker.java:811) ~[classes/:na]
	at com.proyecto.demo.server.ClientWorker.run(ClientWorker.java:102) ~[classes/:na]
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572) ~[na:na]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.postgresql.util.PSQLException: ERROR: column "tipo" is of type mensaje_tipo but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 96
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.springframework.jdbc.core.JdbcTemplate.lambda$update$3(JdbcTemplate.java:1002) ~[spring-jdbc-6.1.1.jar:6.1.1]
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:658) ~[spring-jdbc-6.1.1.jar:6.1.1]
	... 9 common frames omitted

2025-11-25T09:35:33.229-05:00  INFO 22980 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-25T09:35:33.231-05:00  INFO 22980 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-25T09:35:33.231-05:00  INFO 22980 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2025-11-25T09:38:35.039-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 9852 (C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal)
2025-11-25T09:38:35.039-05:00 DEBUG 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-25T09:38:35.047-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-25T09:38:37.212-05:00  INFO 9852 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-25T09:38:37.235-05:00  INFO 9852 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-25T09:38:37.236-05:00  INFO 9852 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-25T09:38:37.376-05:00  INFO 9852 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-25T09:38:37.376-05:00  INFO 9852 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2260 ms
2025-11-25T09:38:37.501-05:00  INFO 9852 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-25T09:38:38.051-05:00  INFO 9852 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:38:38.087-05:00  INFO 9852 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-25T09:38:38.165-05:00  INFO 9852 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@999b951
2025-11-25T09:38:38.169-05:00  INFO 9852 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-25T09:38:38.169-05:00  INFO 9852 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:38:38.235-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : evitar DDL
2025-11-25T09:38:38.283-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-25T09:38:38.396-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-25T09:38:38.450-05:00  INFO 9852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-25T09:38:38.465-05:00  INFO 9852 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-25T09:38:38.499-05:00  INFO 9852 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:38:38.502-05:00  INFO 9852 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-25T09:38:38.554-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-25T09:38:38.624-05:00  INFO 9852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-25T09:38:39.017-05:00  INFO 9852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-25T09:38:39.018-05:00  INFO 9852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-25T09:38:39.019-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-25T09:38:39.026-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-25T09:38:39.118-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-25T09:38:39.142-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   (sin filas)
2025-11-25T09:38:39.144-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-25T09:38:39.162-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensaje de testeo; archivo_id=null; sesion_id=c03752eb-522d-4e86-a144-14f0227b59e4; creado_en=2025-11-24 22:03:45.477770; 
2025-11-25T09:38:39.164-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuesta de testeo; archivo_id=null; sesion_id=623ae263-9828-4caa-a8ba-99539278f72b; creado_en=2025-11-24 22:03:53.104761; 
2025-11-25T09:38:39.165-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-25T09:38:39.179-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=623ae263-9828-4caa-a8ba-99539278f72b; usuario_id=1; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:03:19.342833; fecha_fin=2025-11-24 22:04:45.566031; estado=CERRADA; 
2025-11-25T09:38:39.182-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=b6a191e9-0ad2-498d-bd94-5e751dc0a3c3; usuario_id=2; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:51:01.732324; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:38:39.199-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=c03752eb-522d-4e86-a144-14f0227b59e4; usuario_id=2; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:03:38.055400; fecha_fin=2025-11-24 22:04:49.441709; estado=CERRADA; 
2025-11-25T09:38:39.209-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-25T09:38:39.227-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=mysql1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:38:39.229-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=mysql2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:38:39.234-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-25T09:38:39.303-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-25T09:38:39.311-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-25T09:38:39.365-05:00  INFO 9852 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-25T09:38:39.369-05:00  INFO 9852 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-25T09:38:39.458-05:00  INFO 9852 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@7d42542
2025-11-25T09:38:39.461-05:00  INFO 9852 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-25T09:38:39.590-05:00  INFO 9852 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-25T09:38:40.130-05:00  INFO 9852 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-25T09:38:40.145-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.822 seconds (process running for 6.446)
2025-11-25T09:38:40.150-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-25T09:38:40.151-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-25T09:38:40.153-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-25T09:38:40.153-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-25T09:38:40.153-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-25T09:38:40.154-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-25T09:38:40.197-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 2
2025-11-25T09:38:40.197-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 2
2025-11-25T09:38:40.197-05:00  INFO 9852 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-25T09:38:55.833-05:00  INFO 9852 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-25T09:38:55.839-05:00  INFO 9852 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-25T09:38:55.847-05:00  INFO 9852 --- [servidor] [http-nio-0.0.0.0-9010-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2025-11-25T09:39:26.171-05:00  INFO 9852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:59741
2025-11-25T09:39:26.183-05:00  INFO 9852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:59741
2025-11-25T09:39:27.536-05:00  INFO 9852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:59741
2025-11-25T09:39:27.536-05:00  INFO 9852 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:59741
2025-11-25T09:39:27.538-05:00  INFO 9852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:59741
2025-11-25T09:39:27.549-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:59741 conectado y saludado.
2025-11-25T09:39:27.550-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleRegister correctamente. Raw='REGISTER 3|mysql3|1234'
2025-11-25T09:39:27.566-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-25T09:39:27.598-05:00  WARN 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: fallo buscando usuario='mysql3' usando 'nombre_usuario' - Incorrect result size: expected 1, actual 0
2025-11-25T09:39:27.626-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Usuario 'mysql3' (id=3) registrado en DB
2025-11-25T09:39:27.627-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Registro exitoso de usuario 'mysql3' (id=3) desde /10.236.197.200:59741
2025-11-25T09:39:27.629-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Registro exitoso: mysql3 (id=3) desde /10.236.197.200:59741
2025-11-25T09:39:27.633-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Post-register DB check: usuarios count = 3
2025-11-25T09:39:27.633-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Post-register DB check: usuarios count = 3
2025-11-25T09:39:34.395-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 3|mysql3|1234'
2025-11-25T09:39:34.402-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql3' id=3
2025-11-25T09:39:34.403-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql3' id=3 desde /10.236.197.200:59741
2025-11-25T09:39:34.404-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql3 (id=3) desde /10.236.197.200:59741
2025-11-25T09:39:34.404-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql3 (user-conns=1)
2025-11-25T09:39:34.405-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql3
2025-11-25T09:39:34.406-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-25T09:39:34.412-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='mysql3'
2025-11-25T09:39:34.428-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql3 id=52bc7dad-fd74-4837-8936-be2d71661498
2025-11-25T09:39:34.428-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-25T09:39:34.434-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='mysql3'
2025-11-25T09:39:43.595-05:00  INFO 9852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:63005
2025-11-25T09:39:43.600-05:00  INFO 9852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:63005
2025-11-25T09:39:45.470-05:00  INFO 9852 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:63005
2025-11-25T09:39:45.471-05:00  INFO 9852 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:63005
2025-11-25T09:39:45.471-05:00  INFO 9852 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:63005
2025-11-25T09:39:45.474-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:63005 conectado y saludado.
2025-11-25T09:39:45.474-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-25T09:39:45.485-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-25T09:39:45.486-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /10.236.197.200:63005
2025-11-25T09:39:45.487-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /10.236.197.200:63005
2025-11-25T09:39:45.488-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-25T09:39:45.488-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 2 clients: mysql1,mysql3
2025-11-25T09:39:45.489-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:39:45.495-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:39:45.512-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=669b3c0d-dca1-4bf0-b463-1ee96127a40f
2025-11-25T09:39:45.513-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:39:45.519-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:39:45.525-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Enviando 2 mensajes históricos desde BD a mysql1
2025-11-25T09:39:45.531-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T17:04:45.566031 para evitar duplicados al usuario mysql1
2025-11-25T09:40:27.076-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql3|mensaje de text de 1 a 3'
2025-11-25T09:40:27.077-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : [2025-11-25 09:40:27] Mensaje enviado por: mysql1 Para mysql3 Contenido: mensaje de text de 1 a 3
2025-11-25T09:40:27.080-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-25 09:40:27 Mensaje enviado por: mysql1 Para mysql3 Contenido: mensaje de text de 1 a 3 (desde /10.236.197.200:63005)
2025-11-25T09:40:27.082-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:40:27.093-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:40:27.093-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-25T09:40:27.105-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='mysql3'
2025-11-25T09:40:27.109-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=1 receptorId=3 sesionId=669b3c0d-dca1-4bf0-b463-1ee96127a40f contenido='mensaje de text de 1 a 3'
2025-11-25T09:40:27.111-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=3, tipo=TEXTO, sesionId=669b3c0d-dca1-4bf0-b463-1ee96127a40f
2025-11-25T09:40:49.008-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleMessage correctamente. Raw='MSG mysql1|mensajes a 1 desde 3 mysql'
2025-11-25T09:40:49.013-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : [2025-11-25 09:40:49] Mensaje enviado por: mysql3 Para mysql1 Contenido: mensajes a 1 desde 3 mysql
2025-11-25T09:40:49.016-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : [MSG] 2025-11-25 09:40:49 Mensaje enviado por: mysql3 Para mysql1 Contenido: mensajes a 1 desde 3 mysql (desde /10.236.197.200:59741)
2025-11-25T09:40:49.016-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-25T09:40:49.033-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='mysql3'
2025-11-25T09:40:49.035-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:40:49.043-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:40:49.044-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje: emisorId=3 receptorId=1 sesionId=52bc7dad-fd74-4837-8936-be2d71661498 contenido='mensajes a 1 desde 3 mysql'
2025-11-25T09:40:49.049-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=3, receptorId=1, tipo=TEXTO, sesionId=52bc7dad-fd74-4837-8936-be2d71661498
2025-11-25T09:41:00.015-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR mysql1|Tipos de mensaje avanzadas.txt|2259'
2025-11-25T09:41:00.017-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='mysql1' filename='Tipos de mensaje avanzadas.txt' size='2259'
2025-11-25T09:41:00.020-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: Tipos de mensaje avanzadas.txt size=2259 desde /10.236.197.200:59741
2025-11-25T09:41:00.036-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA mysql1|Tipos de mensaje avanzadas.txt|Ly8vLy8vLy8NCkFwbGljYWNpw7NuIGNsaWVudGUgc2Vydmlkb3IgcGFyYSBlbCBpbnRlcmNhbWJpbyBkZSBpbmZvcm1hY2nDs24gZW50cmUgdXN1YXJpb3MuIHB1ZWRlbiBpbnRlcmNhbWJpYXIgaW5mb3JtYWNpw7NuIGJhc2FkYSBlbiBtZW5zYWplcyBkZSB0ZXh0byB5IGFyY2hpdm9zICggdGV4dG8gbyBiaW5hcmlvICkNCkVsIHNlcnZpZG9yIHBvZHLDoSByZWNpYmlyIHZhcmlhcyBjb25leGlvbmVzIHNpbXVsdGFuZWFzIHBhcmEgZWwgcHJvY2VzYW1pZW50byBkZSBtZW5zYWplcywgZGViZXLDoW4gYXBsaWNhciBlbCBjb25jZXB0byBkZSBwcm9ncmFtYWNpw7NuIGNvbmN1cnJlbnRlIGNvbiBoaWxvcyBwYXJhIGdlc3Rpb25hciBsYXMgY29uZXhpb25lcw0KVG9kYSBsYSBpbmZvcm1hY2nDs24gZGVsIHNlcnZpZG9yIGRlYmUgc2VyIGFsbWFjZW5hZGEgZW4gbGEgYmFzZSBkZSBkYXRvcyByZWxhY2lvbmFsOyBlajogc3FsLCBPcmFjbGUNCkxvcyB1c3VhcmlvcyBzZSBkZWJlbiBjcmVhciBkZXNkZSBsYSBhcHAgZGUgY2xpZW50ZSwgcGVybyBzZSBhY2VwdGFuIGRlc2RlIGVsIHNlcnZpZG9yLCBzb2xvIHB1ZWRlbiBjb25lY3RhcnNlIGx1ZWdvIGRlIHNlciBhY2VwdGFkb3MNClVuIHVzdWFyaW8gcHVlZGUgdGVuZXIgbWFzIGRlIDEgY29uZXhpw7NuIGRlc2RlIG1hcyBkZSAxIGRpc3Bvc2l0aXZvDQpFbCBzZXJ2aWRvciBkZWJlIG1vc3RyYXIgcG9yIGNvbnNvbGEgdG9kYXMgbGFzIGFjY2lvbmVzIHF1ZSBzZSBlc3TDoW4gZWplY3V0YW5kbw0KRWwgc2Vydmlkb3IgbGltaXRhIGxhIGNhbnRpZGFkIGRlIGNvbmV4aW9uZXMgcG9yIHVzdWFyaW8NCkxhIGNvbmV4acOzbiBlbnRyZSBzZXJ2aWRvciBjbGllbnRlcyBzZSBoYWNlIGEgdHJhdsOpcyBkZSBwcm90b2NvbG8gdGNwIGlwDQpMb3MgdXN1YXJpb3MgcHVlZGVuIGRlc2NhcmdhciBsb3MgYXJjaGl2b3MgZW52aWFkb3MNCkxhIGFwbGljYWNpw7NuIGNsaWVudGUgaW1wbGVtZW50YXJhIGZvcm11bGFyaW9zIG1hZXN0cm8tZGV0YWxsZSBwYXJhIG1vc3RyYXIgbGEgaW5mb3JtYWNpw7NuIGFzb2NpYWRhIGFsIHVzdWFyaW8NCg0KVW5hIGFwbGljYWNpw7NuIHdlYiBtdmMgbXXDqXN0cmFsbyBzaWd1aWVudGUNCkxpc3RhZG8gZGUgdXN1YXJpb3MgcmVnaXN0cmFkb3MNCk1lbnNhamVzIGRlIGxvcyB1c3VhcmlvcywgY2xhc2lmaWNhZG9zIHBvciBlbCB0aXBvIGRlIG1lbnNhamUuIFZlciBkZXRhbGxlIGRlIG1lbnNhamUsIGluY2x1eWUgZGVzY2FyZ2FyIGFyY2hpdm9zLg0KTW9zdHJhciBsb3Mgc2lndWllbnRlcyBpbmZvcm1lcw0KVXN1YXJpbyBjb24gbWFzIG1lbnNhamVzIGVudmlhZG9zOiBtb3N0cmFyIGNhbnRpZGFkDQpBcmNoaXZvcyBlbnZpYWRvcywgbGlzdGFyIHBvciB0YW1hw7FvIHkgbW9zdHJhciBwcm9waWV0YXJpbw0KTGlzdGEgZGUgdXN1YXJpb3MgY29uZWN0YWRvcyB5IGluZm9ybWFjacOzbjogSXAsIGhvcmEgZGUgY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQpMaXN0YSBkZSB1c3VhcmlvcyBkZXNjb25lY3RhZG9zIHkgaW5mb3JtYWNpw7NuOiBJcCwgaG9yYSBkZSBjb25leGnDs24sIGhvcmEgZGUgZGVzY29uZXhpw7NuLCBjYW50aWRhZCBkZSBtZW5zYWplcyBlbnZpYWRvcyBlbiBlc2UgaW5zdGFudGUpDQoNCg0KaHR0cDovL2xvY2FsaG9zdDo5MzAwL3dlYi91c3Vhcmlvcw0KaHR0cDovL2xvY2FsaG9zdDo5MzAwL3dlYi8NCg0KDQpVbiBzZXJ2aWNpbyB3ZWIgZGUgYXBpIHJlc3QgcGFyYSBtb3N0cmFyIGxvIHNpZ3VpZW50ZToNCkluZm9ybWFjacOzbiBjb21wbGV0YSBkZSB1c3VhcmlvOiBOb21icmUsIGNhbnRpZGFkIGRlIG1lbnNhamVzIGVudmlhZG9zLCBjYW50aWRhZCBkZSBtZW5zYWplcyByZWNpYmlkb3MsIGZlY2hhIHkgaG9yYSBkZSB1bHRpbWEgY29uZXhpw7NuLCBlc3RhZG8gKGRlc2NvbmVjdGFkby9jb25lY3RhZG8pDQpMaXN0YSBkZSBtZW5zYWplcyBlbnZpYWRvcyAoSXAgdXN1YXJpbyxpcCB1c3VhcmlvIHJlbW90byxmZWNoYSxob3JhKQ0KTGlzdGEgZGUgbWVuc2FqZXMgcmVjaWJpZG9zIChJcCB1c3VhcmlvLGlwIHVzdWFyaW8gcmVtb3RvLGZlY2hhLGhvcmEpDQoNCmh0dHA6Ly9sb2NhbGhvc3Q6OTIwMC9hcGkvdXN1YXJpb3MvMQ0KaHR0cDovL2xvY2FsaG9zdDo5MjAwL2FwaS91c3Vhcmlvcy8xL21lbnNhamVzL3JlY2liaWRvcw0KaHR0cDovL2xvY2FsaG9zdDo5MjAwL2FwaS91c3Vhcmlvcy8xL21lbnNhamVzL2VudmlhZG9z'
2025-11-25T09:41:00.060-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: mysql3 -> mysql1 : Tipos de mensaje avanzadas.txt (2259 bytes)
2025-11-25T09:41:00.072-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1764081660062_mysql3_Tipos de mensaje avanzadas.txt
2025-11-25T09:41:00.072-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-25T09:41:00.083-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='mysql3'
2025-11-25T09:41:00.103-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'Tipos de mensaje avanzadas.txt' using columns nombre / ruta, id=1
2025-11-25T09:41:00.103-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:41:00.107-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:41:00.108-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=3 receptorId=1 archivoId=1
2025-11-25T09:41:00.108-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=3, receptorId=1, tipo=ARCHIVO, sesionId=null
2025-11-25T09:41:34.444-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileHeader. Raw='FILE_HDR mysql3|conversar.txt|185'
2025-11-25T09:41:34.444-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : FILE_HDR parsed recipient='mysql3' filename='conversar.txt' size='185'
2025-11-25T09:41:34.444-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : HDR aceptado: conversar.txt size=185 desde /10.236.197.200:63005
2025-11-25T09:41:34.457-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleFileData. Raw='FILE_DATA mysql3|conversar.txt|Y29udmVyc2FyDQpwcmVzZW50YWNpb25lcw0KZ3VzdG9zDQpwYcOtcw0KZXh0cmFzDQoNCnRpZW5kYXMNCmN1YW50byB2YWxlLCBjdWFuZG8gcGFnbywgZWZlY3Rpdm8vdGFyamV0YQ0KcmVjb21lbmRhY2lvbmVzLCBkdWxjZSwgcHJvdGXDrW5hcywgDQpib2xzYXMsIHRhcmpldGFzIGRlIGFmaWxpYWRvDQoNCnNpdGlvcw0KDQo='
2025-11-25T09:41:34.457-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Archivo DATA recibido: mysql1 -> mysql3 : conversar.txt (185 bytes)
2025-11-25T09:41:34.457-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Archivo DATA recibido guardado en Archivos_enviados\1764081694457_mysql1_conversar.txt
2025-11-25T09:41:34.457-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:41:34.472-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:41:34.504-05:00  INFO 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcArchivoDao     : insertArchivo: inserted file 'conversar.txt' using columns nombre / ruta, id=2
2025-11-25T09:41:34.505-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql3' usando columna='nombre_usuario'
2025-11-25T09:41:34.509-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=3 usuario='mysql3'
2025-11-25T09:41:34.509-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Persistiendo mensaje archivo (DATA): emisorId=1 receptorId=3 archivoId=2
2025-11-25T09:41:34.510-05:00 DEBUG 9852 --- [servidor] [pool-2-thread-2] com.proyecto.demo.dao.JdbcMessageDao     : Executing SQL: INSERT INTO mensajes (emisor_id,receptor_id,tipo,contenido,archivo_id,sesion_id) VALUES (?,?,?,?,?,?) with emisorId=1, receptorId=3, tipo=ARCHIVO, sesionId=null
2025-11-25T09:42:41.308-05:00 ERROR 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /10.236.197.200:59741: java.net.SocketException: Connection reset
2025-11-25T09:42:41.310-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Usuario 'mysql3' desconectado.
2025-11-25T09:42:41.310-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario mysql3 desconectado desde 10.236.197.200 (user-conns=0)
2025-11-25T09:42:41.311-05:00  INFO 9852 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-25T09:43:48.123-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 18860 (C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal)
2025-11-25T09:43:48.126-05:00 DEBUG 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-25T09:43:48.128-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-25T09:43:50.318-05:00  INFO 18860 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-25T09:43:50.337-05:00  INFO 18860 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-25T09:43:50.337-05:00  INFO 18860 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-25T09:43:50.412-05:00  INFO 18860 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-25T09:43:50.412-05:00  INFO 18860 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2222 ms
2025-11-25T09:43:50.613-05:00  INFO 18860 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-25T09:43:51.228-05:00  INFO 18860 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:43:51.254-05:00  INFO 18860 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-25T09:43:51.326-05:00  INFO 18860 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@1d06f16f
2025-11-25T09:43:51.330-05:00  INFO 18860 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-25T09:43:51.330-05:00  INFO 18860 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:43:51.419-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : evitar DDL
2025-11-25T09:43:51.486-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-25T09:43:51.550-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-25T09:43:51.602-05:00  INFO 18860 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-25T09:43:51.624-05:00  INFO 18860 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-25T09:43:51.653-05:00  INFO 18860 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:43:51.657-05:00  INFO 18860 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-25T09:43:51.696-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-25T09:43:51.770-05:00  INFO 18860 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-25T09:43:52.068-05:00  INFO 18860 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-25T09:43:52.069-05:00  INFO 18860 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-25T09:43:52.071-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-25T09:43:52.081-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-25T09:43:52.112-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-25T09:43:52.128-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; propietario_id=3; nombre=Tipos de mensaje avanzadas.txt; ruta=Archivos_enviados\1764081660062_mysql3_Tipos de mensaje avanzadas.txt; tipo_mime=null; tamano=2259; creado_en=2025-11-25 14:41:00.089183; 
2025-11-25T09:43:52.130-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; propietario_id=1; nombre=conversar.txt; ruta=Archivos_enviados\1764081694457_mysql1_conversar.txt; tipo_mime=null; tamano=185; creado_en=2025-11-25 14:41:34.478316; 
2025-11-25T09:43:52.132-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-25T09:43:52.137-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensaje de testeo; archivo_id=null; sesion_id=c03752eb-522d-4e86-a144-14f0227b59e4; creado_en=2025-11-24 22:03:45.477770; 
2025-11-25T09:43:52.141-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuesta de testeo; archivo_id=null; sesion_id=623ae263-9828-4caa-a8ba-99539278f72b; creado_en=2025-11-24 22:03:53.104761; 
2025-11-25T09:43:52.143-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3; emisor_id=1; receptor_id=3; tipo=TEXTO; contenido=mensaje de text de 1 a 3; archivo_id=null; sesion_id=669b3c0d-dca1-4bf0-b463-1ee96127a40f; creado_en=2025-11-25 14:40:27.116345; 
2025-11-25T09:43:52.146-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=4; emisor_id=3; receptor_id=1; tipo=TEXTO; contenido=mensajes a 1 desde 3 mysql; archivo_id=null; sesion_id=52bc7dad-fd74-4837-8936-be2d71661498; creado_en=2025-11-25 14:40:49.054499; 
2025-11-25T09:43:52.147-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=5; emisor_id=3; receptor_id=1; tipo=ARCHIVO; contenido=Tipos de mensaje avanzadas.txt; archivo_id=1; sesion_id=null; creado_en=2025-11-25 14:41:00.110706; 
2025-11-25T09:43:52.148-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-25T09:43:52.154-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=52bc7dad-fd74-4837-8936-be2d71661498; usuario_id=3; token=null; ip=10.236.197.200; fecha_inicio=2025-11-25 14:39:34.417636; fecha_fin=2025-11-25 14:42:41.312689; estado=CERRADA; 
2025-11-25T09:43:52.156-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=623ae263-9828-4caa-a8ba-99539278f72b; usuario_id=1; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:03:19.342833; fecha_fin=2025-11-24 22:04:45.566031; estado=CERRADA; 
2025-11-25T09:43:52.158-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=669b3c0d-dca1-4bf0-b463-1ee96127a40f; usuario_id=1; token=null; ip=10.236.197.200; fecha_inicio=2025-11-25 14:39:45.501765; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:43:52.160-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=b6a191e9-0ad2-498d-bd94-5e751dc0a3c3; usuario_id=2; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:51:01.732324; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:43:52.162-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=c03752eb-522d-4e86-a144-14f0227b59e4; usuario_id=2; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:03:38.055400; fecha_fin=2025-11-24 22:04:49.441709; estado=CERRADA; 
2025-11-25T09:43:52.164-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-25T09:43:52.169-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=mysql1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:43:52.170-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=mysql2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:43:52.173-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3; nombre_usuario=mysql3; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:43:52.174-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-25T09:43:52.230-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-25T09:43:52.230-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-25T09:43:52.260-05:00  INFO 18860 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-25T09:43:52.262-05:00  INFO 18860 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-25T09:43:52.333-05:00  INFO 18860 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@6adc5b9c
2025-11-25T09:43:52.335-05:00  INFO 18860 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-25T09:43:52.465-05:00  INFO 18860 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-25T09:43:53.260-05:00  INFO 18860 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-25T09:43:53.271-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 5.84 seconds (process running for 6.378)
2025-11-25T09:43:53.277-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-25T09:43:53.278-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-25T09:43:53.279-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-25T09:43:53.280-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-25T09:43:53.281-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-25T09:43:53.281-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-25T09:43:53.310-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-25T09:43:53.310-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-25T09:43:53.314-05:00  INFO 18860 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-25T09:44:22.706-05:00  INFO 18860 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:63991
2025-11-25T09:44:22.712-05:00  INFO 18860 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:63991
2025-11-25T09:44:24.502-05:00  INFO 18860 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:63991
2025-11-25T09:44:24.503-05:00  INFO 18860 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:63991
2025-11-25T09:44:24.503-05:00  INFO 18860 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:63991
2025-11-25T09:44:24.514-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:63991 conectado y saludado.
2025-11-25T09:44:24.517-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-25T09:44:24.551-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-25T09:44:24.552-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /10.236.197.200:63991
2025-11-25T09:44:24.553-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /10.236.197.200:63991
2025-11-25T09:44:24.553-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-25T09:44:24.554-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-25T09:44:24.556-05:00 DEBUG 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:44:24.563-05:00 DEBUG 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:44:24.580-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=4c74091d-f6dd-41a0-b5d2-f39b44eab105
2025-11-25T09:44:24.581-05:00 DEBUG 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:44:24.586-05:00 DEBUG 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:44:24.592-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a mysql1
2025-11-25T09:44:24.600-05:00  INFO 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T17:04:45.566031 para evitar duplicados al usuario mysql1
2025-11-25T09:44:24.650-05:00 DEBUG 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-25T09:44:24.681-05:00 DEBUG 18860 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-25T09:44:34.319-05:00  INFO 18860 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:61075
2025-11-25T09:44:34.325-05:00  INFO 18860 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:61075
2025-11-25T09:44:36.515-05:00  INFO 18860 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:61075
2025-11-25T09:44:36.516-05:00  INFO 18860 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:61075
2025-11-25T09:44:36.516-05:00  INFO 18860 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:61075
2025-11-25T09:44:36.519-05:00  INFO 18860 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:61075 conectado y saludado.
2025-11-25T09:44:36.520-05:00  INFO 18860 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-25T09:44:36.533-05:00  INFO 18860 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-25T09:44:36.534-05:00  INFO 18860 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /10.236.197.200:61075
2025-11-25T09:44:36.535-05:00  INFO 18860 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /10.236.197.200:61075
2025-11-25T09:44:36.535-05:00  INFO 18860 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'mysql1' desde la misma IP 10.236.197.200 (ya conectado)
2025-11-25T09:44:36.536-05:00  WARN 18860 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'mysql1' desde 10.236.197.200 motivo=Error: Limite de ips excedido, no puede ingresar en este equipo
2025-11-25T09:45:32.306-05:00 ERROR 18860 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /10.236.197.200:61075: java.net.SocketException: Connection reset
2025-11-25T09:45:32.306-05:00  INFO 18860 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:61075 desconectado sin autenticarse.
2025-11-25T09:45:50.930-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 19332 (C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal)
2025-11-25T09:45:50.934-05:00 DEBUG 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-25T09:45:50.936-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-25T09:45:53.092-05:00  INFO 19332 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-25T09:45:53.108-05:00  INFO 19332 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-25T09:45:53.109-05:00  INFO 19332 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-25T09:45:53.206-05:00  INFO 19332 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-25T09:45:53.206-05:00  INFO 19332 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2150 ms
2025-11-25T09:45:53.393-05:00  INFO 19332 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-25T09:45:54.023-05:00  INFO 19332 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:45:54.050-05:00  INFO 19332 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-25T09:45:54.116-05:00  INFO 19332 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@4fa4f485
2025-11-25T09:45:54.116-05:00  INFO 19332 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-25T09:45:54.116-05:00  INFO 19332 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:45:54.163-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : evitar DDL
2025-11-25T09:45:54.199-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-25T09:45:54.272-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-25T09:45:54.321-05:00  INFO 19332 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-25T09:45:54.338-05:00  INFO 19332 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-25T09:45:54.381-05:00  INFO 19332 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:45:54.387-05:00  INFO 19332 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-25T09:45:54.434-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-25T09:45:54.504-05:00  INFO 19332 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-25T09:45:54.808-05:00  INFO 19332 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-25T09:45:54.808-05:00  INFO 19332 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-25T09:45:54.809-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-25T09:45:54.816-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-25T09:45:54.828-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-25T09:45:54.841-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; propietario_id=3; nombre=Tipos de mensaje avanzadas.txt; ruta=Archivos_enviados\1764081660062_mysql3_Tipos de mensaje avanzadas.txt; tipo_mime=null; tamano=2259; creado_en=2025-11-25 14:41:00.089183; 
2025-11-25T09:45:54.843-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; propietario_id=1; nombre=conversar.txt; ruta=Archivos_enviados\1764081694457_mysql1_conversar.txt; tipo_mime=null; tamano=185; creado_en=2025-11-25 14:41:34.478316; 
2025-11-25T09:45:54.846-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-25T09:45:54.854-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensaje de testeo; archivo_id=null; sesion_id=c03752eb-522d-4e86-a144-14f0227b59e4; creado_en=2025-11-24 22:03:45.477770; 
2025-11-25T09:45:54.855-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuesta de testeo; archivo_id=null; sesion_id=623ae263-9828-4caa-a8ba-99539278f72b; creado_en=2025-11-24 22:03:53.104761; 
2025-11-25T09:45:54.857-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3; emisor_id=1; receptor_id=3; tipo=TEXTO; contenido=mensaje de text de 1 a 3; archivo_id=null; sesion_id=669b3c0d-dca1-4bf0-b463-1ee96127a40f; creado_en=2025-11-25 14:40:27.116345; 
2025-11-25T09:45:54.858-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=4; emisor_id=3; receptor_id=1; tipo=TEXTO; contenido=mensajes a 1 desde 3 mysql; archivo_id=null; sesion_id=52bc7dad-fd74-4837-8936-be2d71661498; creado_en=2025-11-25 14:40:49.054499; 
2025-11-25T09:45:54.860-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=5; emisor_id=3; receptor_id=1; tipo=ARCHIVO; contenido=Tipos de mensaje avanzadas.txt; archivo_id=1; sesion_id=null; creado_en=2025-11-25 14:41:00.110706; 
2025-11-25T09:45:54.861-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-25T09:45:54.867-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=4c74091d-f6dd-41a0-b5d2-f39b44eab105; usuario_id=1; token=null; ip=10.236.197.200; fecha_inicio=2025-11-25 14:44:24.569887; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:45:54.871-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=52bc7dad-fd74-4837-8936-be2d71661498; usuario_id=3; token=null; ip=10.236.197.200; fecha_inicio=2025-11-25 14:39:34.417636; fecha_fin=2025-11-25 14:42:41.312689; estado=CERRADA; 
2025-11-25T09:45:54.872-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=623ae263-9828-4caa-a8ba-99539278f72b; usuario_id=1; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:03:19.342833; fecha_fin=2025-11-24 22:04:45.566031; estado=CERRADA; 
2025-11-25T09:45:54.873-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=669b3c0d-dca1-4bf0-b463-1ee96127a40f; usuario_id=1; token=null; ip=10.236.197.200; fecha_inicio=2025-11-25 14:39:45.501765; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:45:54.874-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=b6a191e9-0ad2-498d-bd94-5e751dc0a3c3; usuario_id=2; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:51:01.732324; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:45:54.875-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-25T09:45:54.880-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=mysql1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:45:54.881-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=mysql2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:45:54.882-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3; nombre_usuario=mysql3; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:45:54.884-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-25T09:45:54.935-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-25T09:45:54.935-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-25T09:45:54.957-05:00  INFO 19332 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-25T09:45:54.957-05:00  INFO 19332 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-25T09:45:55.018-05:00  INFO 19332 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@19c1820d
2025-11-25T09:45:55.019-05:00  INFO 19332 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-25T09:45:55.186-05:00  INFO 19332 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-25T09:45:56.237-05:00  INFO 19332 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-25T09:45:56.287-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 6.055 seconds (process running for 6.638)
2025-11-25T09:45:56.291-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-25T09:45:56.292-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-25T09:45:56.293-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-25T09:45:56.294-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-25T09:45:56.297-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-25T09:45:56.298-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-25T09:45:56.343-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-25T09:45:56.348-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-25T09:45:56.377-05:00  INFO 19332 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-25T09:46:08.251-05:00  INFO 19332 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:62608
2025-11-25T09:46:08.257-05:00  INFO 19332 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:62608
2025-11-25T09:46:09.613-05:00  INFO 19332 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:62608
2025-11-25T09:46:09.616-05:00  INFO 19332 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:62608
2025-11-25T09:46:09.618-05:00  INFO 19332 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:62608
2025-11-25T09:46:09.639-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:62608 conectado y saludado.
2025-11-25T09:46:09.642-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-25T09:46:09.697-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-25T09:46:09.699-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /10.236.197.200:62608
2025-11-25T09:46:09.701-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /10.236.197.200:62608
2025-11-25T09:46:09.701-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Usuario registrado para broadcast: mysql1 (user-conns=1)
2025-11-25T09:46:09.703-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] c.proyecto.demo.server.ConnectedClients  : Broadcasting USERS list to 1 clients: mysql1
2025-11-25T09:46:09.706-05:00 DEBUG 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:46:09.722-05:00 DEBUG 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:46:09.760-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Sesion creada para usuario mysql1 id=bd22bf3f-7549-41f2-bd13-3330c84ca7a9
2025-11-25T09:46:09.762-05:00 DEBUG 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: buscando usuario='mysql1' usando columna='nombre_usuario'
2025-11-25T09:46:09.771-05:00 DEBUG 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.auth.JdbcUserDao       : JdbcUserDao.findByUsername: encontrado id=1 usuario='mysql1'
2025-11-25T09:46:09.782-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Enviando 6 mensajes históricos desde BD a mysql1
2025-11-25T09:46:09.791-05:00  INFO 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.server.ClientWorker    : Se omitirá historial creado hasta 2025-11-24T17:04:45.566031 para evitar duplicados al usuario mysql1
2025-11-25T09:46:09.855-05:00 DEBUG 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-25T09:46:09.880-05:00 DEBUG 19332 --- [servidor] [pool-2-thread-1] com.proyecto.demo.dao.JdbcArchivoDao     : findById: select failed with SQL [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]: PreparedStatementCallback; bad SQL grammar [SELECT id, nombre as filename, ruta as path, tamano as size, COALESCE(creado_en, subido_en) AS creado_en FROM archivos WHERE id = ?]
2025-11-25T09:46:21.114-05:00  INFO 19332 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Nueva conexión entrante desde /10.236.197.200:57080
2025-11-25T09:46:21.120-05:00  INFO 19332 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Solicitud de conexión desde /10.236.197.200:57080
2025-11-25T09:46:22.519-05:00  INFO 19332 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Decisión: APROBADA para /10.236.197.200:57080
2025-11-25T09:46:22.520-05:00  INFO 19332 --- [servidor] [servidor] com.proyecto.demo.ui.UiServerWindow      : Conexión aprobada desde /10.236.197.200:57080
2025-11-25T09:46:22.521-05:00  INFO 19332 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Conexión aprobada desde /10.236.197.200:57080
2025-11-25T09:46:22.523-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:57080 conectado y saludado.
2025-11-25T09:46:22.524-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-25T09:46:22.540-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-25T09:46:22.541-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /10.236.197.200:57080
2025-11-25T09:46:22.543-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /10.236.197.200:57080
2025-11-25T09:46:22.543-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'mysql1' desde la misma IP 10.236.197.200 (ya conectado)
2025-11-25T09:46:22.543-05:00  WARN 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'mysql1' desde 10.236.197.200 motivo=Error: Limite de ips excedido, no puede ingresar en este equipo
2025-11-25T09:46:38.542-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : mensaje llega a funcion de ClientWorker.handleLogin correctamente. Raw='LOGIN 1|mysql1|1234'
2025-11-25T09:46:38.547-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.auth.AuthDbService     : Login exitoso para usuario='mysql1' id=1
2025-11-25T09:46:38.548-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Login exitoso: usuario='mysql1' id=1 desde /10.236.197.200:57080
2025-11-25T09:46:38.549-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.ui.UiServerWindow      : Login exitoso: mysql1 (id=1) desde /10.236.197.200:57080
2025-11-25T09:46:38.550-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] c.proyecto.demo.server.ConnectedClients  : Rechazando registro para usuario 'mysql1' desde la misma IP 10.236.197.200 (ya conectado)
2025-11-25T09:46:38.550-05:00  WARN 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Registro rechazado para usuario 'mysql1' desde 10.236.197.200 motivo=Error: Limite de ips excedido, no puede ingresar en este equipo
2025-11-25T09:47:11.610-05:00 ERROR 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Error en worker para cliente /10.236.197.200:57080: java.net.SocketException: Connection reset
2025-11-25T09:47:11.611-05:00  INFO 19332 --- [servidor] [pool-2-thread-2] com.proyecto.demo.server.ClientWorker    : Cliente /10.236.197.200:57080 desconectado sin autenticarse.
2025-11-25T09:52:31.629-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Starting DemoApplication using Java 21.0.8 with PID 22020 (C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\target\classes started by josem in C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal)
2025-11-25T09:52:31.636-05:00 DEBUG 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Running with Spring Boot v3.2.0, Spring v6.1.1
2025-11-25T09:52:31.642-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : No active profile set, falling back to 1 default profile: "default"
2025-11-25T09:52:33.900-05:00  INFO 22020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 9010 (http)
2025-11-25T09:52:33.927-05:00  INFO 22020 --- [servidor] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-25T09:52:33.929-05:00  INFO 22020 --- [servidor] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.16]
2025-11-25T09:52:34.024-05:00  INFO 22020 --- [servidor] [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-25T09:52:34.024-05:00  INFO 22020 --- [servidor] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2251 ms
2025-11-25T09:52:34.151-05:00  INFO 22020 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Attempting JDBC connect test to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC (user=root)
2025-11-25T09:52:34.771-05:00  INFO 22020 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Connection test succeeded to jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:52:34.787-05:00  INFO 22020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Starting...
2025-11-25T09:52:34.855-05:00  INFO 22020 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-ds - Added connection com.mysql.cj.jdbc.ConnectionImpl@3af58f76
2025-11-25T09:52:34.859-05:00  INFO 22020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-ds - Start completed.
2025-11-25T09:52:34.860-05:00  INFO 22020 --- [servidor] [main] c.proyecto.demo.config.DataSourceConfig  : Providing DataSource for URL jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:52:34.903-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.auth.JdbcUserDao       : evitar DDL
2025-11-25T09:52:34.956-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.dao.JdbcMessageDao     : ensureTables skipped for messaging-related tables - DDL is managed outside the application
2025-11-25T09:52:35.045-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.dao.JdbcArchivoDao     : ensureTable skipped for 'archivos' - DDL is managed outside the application
2025-11-25T09:52:35.087-05:00  INFO 22020 --- [servidor] [servidor] com.proyecto.demo.server.TcpServer       : Servidor TCP escuchando en 0.0.0.0:9001
2025-11-25T09:52:35.103-05:00  INFO 22020 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : DB selector preferType='mysql' configuredUrl='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC'
2025-11-25T09:52:35.153-05:00  INFO 22020 --- [servidor] [main] c.p.demo.db.DatabaseSelectorService      : Connected to MySQL via jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
2025-11-25T09:52:35.157-05:00  INFO 22020 --- [servidor] [main] c.proyecto.demo.db.DatabaseInitRunner    : Using database adapter: MySQL
2025-11-25T09:52:35.225-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : java.awt.headless=false | GraphicsEnvironment.isHeadless=false
2025-11-25T09:52:35.312-05:00  INFO 22020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Creando ventana UI del servidor...
2025-11-25T09:52:35.660-05:00  INFO 22020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Panel iniciado
2025-11-25T09:52:35.660-05:00  INFO 22020 --- [servidor] [AWT-EventQueue-0] com.proyecto.demo.ui.UiServerWindow      : Ventana UI visible
2025-11-25T09:52:35.661-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Using database adapter: MySQL
2025-11-25T09:52:35.682-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Conectado a BD: MySQL | URL=jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC | user=root@172.18.0.1
2025-11-25T09:52:35.699-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: archivos
2025-11-25T09:52:35.727-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; propietario_id=3; nombre=Tipos de mensaje avanzadas.txt; ruta=Archivos_enviados\1764081660062_mysql3_Tipos de mensaje avanzadas.txt; tipo_mime=null; tamano=2259; creado_en=2025-11-25 14:41:00.089183; 
2025-11-25T09:52:35.729-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; propietario_id=1; nombre=conversar.txt; ruta=Archivos_enviados\1764081694457_mysql1_conversar.txt; tipo_mime=null; tamano=185; creado_en=2025-11-25 14:41:34.478316; 
2025-11-25T09:52:35.730-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: mensajes
2025-11-25T09:52:35.742-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; emisor_id=2; receptor_id=1; tipo=TEXTO; contenido=mensaje de testeo; archivo_id=null; sesion_id=c03752eb-522d-4e86-a144-14f0227b59e4; creado_en=2025-11-24 22:03:45.477770; 
2025-11-25T09:52:35.743-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; emisor_id=1; receptor_id=2; tipo=TEXTO; contenido=respuesta de testeo; archivo_id=null; sesion_id=623ae263-9828-4caa-a8ba-99539278f72b; creado_en=2025-11-24 22:03:53.104761; 
2025-11-25T09:52:35.746-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3; emisor_id=1; receptor_id=3; tipo=TEXTO; contenido=mensaje de text de 1 a 3; archivo_id=null; sesion_id=669b3c0d-dca1-4bf0-b463-1ee96127a40f; creado_en=2025-11-25 14:40:27.116345; 
2025-11-25T09:52:35.748-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=4; emisor_id=3; receptor_id=1; tipo=TEXTO; contenido=mensajes a 1 desde 3 mysql; archivo_id=null; sesion_id=52bc7dad-fd74-4837-8936-be2d71661498; creado_en=2025-11-25 14:40:49.054499; 
2025-11-25T09:52:35.756-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=5; emisor_id=3; receptor_id=1; tipo=ARCHIVO; contenido=Tipos de mensaje avanzadas.txt; archivo_id=1; sesion_id=null; creado_en=2025-11-25 14:41:00.110706; 
2025-11-25T09:52:35.761-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sesiones
2025-11-25T09:52:35.768-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=4c74091d-f6dd-41a0-b5d2-f39b44eab105; usuario_id=1; token=null; ip=10.236.197.200; fecha_inicio=2025-11-25 14:44:24.569887; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:52:35.771-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=52bc7dad-fd74-4837-8936-be2d71661498; usuario_id=3; token=null; ip=10.236.197.200; fecha_inicio=2025-11-25 14:39:34.417636; fecha_fin=2025-11-25 14:42:41.312689; estado=CERRADA; 
2025-11-25T09:52:35.779-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=623ae263-9828-4caa-a8ba-99539278f72b; usuario_id=1; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:03:19.342833; fecha_fin=2025-11-24 22:04:45.566031; estado=CERRADA; 
2025-11-25T09:52:35.781-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=669b3c0d-dca1-4bf0-b463-1ee96127a40f; usuario_id=1; token=null; ip=10.236.197.200; fecha_inicio=2025-11-25 14:39:45.501765; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:52:35.785-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=b6a191e9-0ad2-498d-bd94-5e751dc0a3c3; usuario_id=2; token=null; ip=192.168.40.12; fecha_inicio=2025-11-24 22:51:01.732324; fecha_fin=null; estado=ACTIVA; 
2025-11-25T09:52:35.788-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: usuarios
2025-11-25T09:52:35.795-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=1; nombre_usuario=mysql1; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:52:35.796-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=2; nombre_usuario=mysql2; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:52:35.797-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   id=3; nombre_usuario=mysql3; contrasena_hash=03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4; 
2025-11-25T09:52:35.799-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : Tabla: sys_config
2025-11-25T09:52:35.888-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      :   Error leyendo tabla sys_config: Table 'mensajeria.sys_config' doesn't exist
2025-11-25T09:52:35.895-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : app.db.initOnStartup=false -> no se ejecuta initDatabase() (previene borrado de tablas)
2025-11-25T09:52:35.937-05:00  INFO 22020 --- [servidor] [main] c.proyecto.demo.config.DatabaseConfig    : Creating primary DataSource: url='jdbc:mysql://localhost:3307/mensajeria?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC' user='root' (app.db.type=mysql)
2025-11-25T09:52:35.941-05:00  INFO 22020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Starting...
2025-11-25T09:52:36.017-05:00  INFO 22020 --- [servidor] [main] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Added connection com.mysql.cj.jdbc.ConnectionImpl@76ff68c5
2025-11-25T09:52:36.019-05:00  INFO 22020 --- [servidor] [main] com.zaxxer.hikari.HikariDataSource       : app-hikari-pool - Start completed.
2025-11-25T09:52:36.177-05:00  INFO 22020 --- [servidor] [main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-11-25T09:52:36.875-05:00  INFO 22020 --- [servidor] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 9010 (http) with context path ''
2025-11-25T09:52:36.891-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Started DemoApplication in 6.135 seconds (process running for 6.842)
2025-11-25T09:52:36.898-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Aplicación 'servidor' iniciada. Server address=0.0.0.0, port=9010
2025-11-25T09:52:36.899-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UI enabled property = true; intentando inicializar UI
2025-11-25T09:52:36.909-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : UI inicializada correctamente (initialize)
2025-11-25T09:52:36.912-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : UiServerWindow.initialize() invocado desde DemoApplication.run
2025-11-25T09:52:36.914-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Componente TcpServer activo
2025-11-25T09:52:36.938-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : Servicio de autenticación activo
2025-11-25T09:52:36.989-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.DemoApplication        : DB check OK - usuarios count = 3
2025-11-25T09:52:36.989-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.ui.UiServerWindow      : DB check OK - usuarios count = 3
2025-11-25T09:52:36.997-05:00  INFO 22020 --- [servidor] [main] com.proyecto.demo.web.LogStartup         : LogStartup initialized. includePast=true, startPosition=0, path=C:\Users\josem\Desktop\proyectoavanzadas2025\mensajeriaRedLocal\servidor\demo\servidor\server_logs.txt
2025-11-25T10:22:42.998-05:00  WARN 22020 --- [servidor] [app-ds housekeeper] com.zaxxer.hikari.pool.HikariPool        : app-ds - Thread starvation or clock leap detected (housekeeper delta=21m7s918ms956µs300ns).
2025-11-25T10:22:44.179-05:00  WARN 22020 --- [servidor] [app-hikari-pool housekeeper] com.zaxxer.hikari.pool.HikariPool        : app-hikari-pool - Thread starvation or clock leap detected (housekeeper delta=21m7s912ms50µs900ns).
